<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.555">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


    <title>Author response to Reviewers comments</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
     
      <meta name="citation_title" content="Author response to Reviewers comments">
<meta name="citation_publication_date" content="2025">
<meta name="citation_cover_date" content="2025">
<meta name="citation_year" content="2025">
<meta name="citation_fulltext_html_url" content="https://indiraputeri-phd.github.io/CAR_simcomp/">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Manuscript in Submission">
<meta name="citation_reference" content="citation_title=Localized spatiotemporal effects in the determinants of property prices: A case study of seoul;,citation_abstract=This research investigates both spatial and temporal elements of the apartment pricing process in Seoul, South Korea by modeling the determinants of apartment prices over a ten-year period from 2006 to 2015 with a hedonic price model containing a spatio-temporal lag model calibrated by geographically weighted regression (GWR). The results yield information on both spatial and temporal variations in the processes affecting apartment prices and demonstrate the use of GWR for generating local spatial dependency measures which are conditioned on various covariates rather than being simple descriptions of pattern. The study utilizes a combined approach to account for both spatial dependency in housing prices and spatial heterogeneity in the processes generating those prices. The results suggest that there are spatial variations in the determinants of apartment prices and that these spatial variations are fairly consistent over time. The effect of the spatial lag on house prices exhibits strong spatial variation which again is reasonably consistent over time.;,citation_author=A Stewart Fotheringham;,citation_author=Bumsub Park;,citation_publication_date=2018-08;,citation_cover_date=2018-08;,citation_year=2018;,citation_doi=10.1007/s12061-017-9232-8;,citation_issn=18744621;,citation_volume=11;,citation_journal_title=Applied Spatial Analysis and Policy;">
<meta name="citation_reference" content="citation_title=Does bus accessibility affect property prices?;,citation_abstract=Existing studies have yet reached consistent conclusions on accessibility benefits of buses. Most existing studies have been conducted in the context of the West, where bus patronage is generally low. In this study, we used a database of 22,586 secondhand residential properties in 358 residential estates in Xiamen, China to develop four non-spatial hedonic pricing models (one standard and three Box-Cox transformed) and two spatial econometric models to quantify the effects of bus accessibility on property prices and analyze how the introduction of spatial econometric models would influence estimates of such benefits. Our findings are as follows. (1) Access to bus stops is positively correlated with property prices. This outcome is in contrast with findings of mainstream research (or conventional wisdom). For every bus stop within 500 m, the price of a property is 0.5;,citation_author=Linchuan Yang;,citation_author=Jiangping Zhou;,citation_author=Oliver F Shyr;,citation_author=others;,citation_publication_date=2019-01;,citation_cover_date=2019-01;,citation_year=2019;,citation_doi=10.1016/j.cities.2018.07.005;,citation_issn=0264-2751;,citation_volume=84;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=Spatial analysis of housing prices and market activity with the geographically weighted regression;,citation_abstract=The main part of the study will be to demonstrate that models taking into account spatial heterogeneity (Geographically Weighted Regression and Mixed Geographically Weighted Regression) which reproduce housing market determinants better reflect market relationships than conventional regression models. The spatial heterogeneity of the housing market determinants results in the spatial diversity of the market activity, as well as of real estate prices and values. The main aim of the study was to analyse an effect of these socio-demographic and environmental factors on average housing property prices and on the number of transactions in a spatial approach. In previous research conducted on a national scale, usually all variables were treated in a similar way, i.e., as global or local variables. During the research, an attempt was also made to answer the question of which of the variables adopted for analysis have a local impact on prices and market activity, and which are global. The study was conducted in Poland and used data from the year 2018 on 380 counties (Local Administrative Units). The study showed that determinants both for average prices and for the housing market activity show spatial autocorrelation with high–high and low–low cluster groups. Owing to these models, it was possible to draw specific conclusions on local determinants of flat prices and the market activity in Poland. The study findings have confirmed that they are an extremely effective tool for spatial data analysis.;,citation_author=Radosław Cellmer;,citation_author=Aneta Cichulska;,citation_author=Mirosław Bełej;,citation_publication_date=2020-06;,citation_cover_date=2020-06;,citation_year=2020;,citation_issue=6;,citation_doi=10.3390/ijgi9060380;,citation_issn=2220-9964;,citation_volume=9;,citation_journal_title=ISPRS International Journal of Geo-Information;">
<meta name="citation_reference" content="citation_title=Geospatial health data: Modeling and visualization with r-INLA and shiny;,citation_abstract=Geospatial Health Data: Modeling and Visualization with R-INLA and Shiny describes spatial and spatio-temporal statistical methods and visualization techniques to analyze georeferenced health data in R. After a detailed introduction of geospatial data, the book shows how to develop Bayesian hierarchical models for disease mapping and apply computational approaches such as the integrated nested Laplace approximation (INLA) and the stochastic partial differential equation (SPDE) to analyze areal and geostatistical data. These approaches allow to quantify disease burden, understand geographic patterns and changes over time, identify risk factors, and measure inequalities between populations. The book also shows how to create interactive and static visualizations such as disease maps and time plots, and describes several R packages that can be used to easily turn analyses into visually informative and interactive reports, dashboards, and Shiny web applications that facilitate the communication of insights to collaborators and policymakers.;,citation_author=Paula Moraga;,citation_publication_date=2019-11;,citation_cover_date=2019-11;,citation_year=2019;,citation_isbn=9780367357955;">
<meta name="citation_reference" content="citation_title=Estimation of disease rates in small areas: A new mixed model for spatial dependence;,citation_author=Brian G Leroux;,citation_author=Xingye Lei;,citation_author=Norman Breslow;,citation_publication_date=2000;,citation_cover_date=2000;,citation_year=2000;,citation_conference_title=Statistical models in epidemiology, the environment, and clinical trials;">
<meta name="citation_reference" content="citation_title=Spatial interaction and the statistical analysis of lattice systems;,citation_abstract=The formulation of conditional probability models for finite systems of spatially interacting random variables is examined. A simple alternative proof of the Hammersley-Clifford theorem is presented and the theorem is then used to construct specific spatial schemes on and off the lattice. Particular emphasis is placed upon practical applications of the models in plant ecology when the variates are binary or Gaussian. Some aspects of infinite lattice Gaussian processes are discussed. Methods of statistical analysis for lattice schemes are proposed, including a very flexible coding technique. The methods are illustrated by two numerical examples. It is maintained throughout that the conditional probability approach to the specification and analysis of spatial interaction is more attractive than the alternative joint probability approach.;,citation_author=Julian Besag;,citation_publication_date=1974-01;,citation_cover_date=1974-01;,citation_year=1974;,citation_issue=2;,citation_doi=10.1111/j.2517-6161.1974.tb00999.x;,citation_issn=0964-1998;,citation_volume=36;,citation_journal_title=Journal of the Royal Statistical Society: Series B (Methodological);">
<meta name="citation_reference" content="citation_title=Bayesian image restoration, with two applications in spatial statistics;,citation_abstract=There has been much recent interest in Bayesian image analysis, including such topics as removal of blur and noise, detection of object boundaries, classification of textures, and reconstruction of two- or three-dimensional scenes from noisy lower-dimensional views. Perhaps the most straightforward task is that of image restoration, though it is often suggested that this is an area of relatively minor practical importance. The present paper argues the contrary, since many problems in the analysis of spatial data can be interpreted as problems of image restoration. Furthermore, the amounts of data involved allow routine use of computer intensive methods, such as the Gibbs sampler, that are not yet practicable for conventional images. Two examples are given, one in archeology, the other in epidemiology. These are preceded by a partial review of pixel-based Bayesian image analysis.;,citation_author=Julian Besag;,citation_author=Jeremy York;,citation_author=Annie Mollié;,citation_publication_date=1991-03;,citation_cover_date=1991-03;,citation_year=1991;,citation_doi=10.1007/BF00116466;,citation_issn=1572-9052;,citation_volume=43;,citation_journal_title=Annals of the institute of statistical mathematics;">
<meta name="citation_reference" content="citation_title=CARBayes: An r package for bayesian spatial modeling with conditional autoregressive priors;,citation_abstract=Conditional autoregressive models are commonly used to represent spatial autocorrelation in data relating to a set of non-overlapping areal units, which arise in a wide variety of applications including agriculture, education, epidemiology and image analysis. Such models are typically specified in a hierarchical Bayesian framework, with inference based on Markov chain Monte Carlo (MCMC) simulation. The most widely used software to fit such models is WinBUGS or OpenBUGS, but in this paper we introduce the R package CARBayes. The main advantage of CARBayes compared with the BUGS software is its ease of use, because: (1) the spatial adjacency information is easy to specify as a binary neighbourhood matrix; and (2) given the neighbourhood matrix the models can be implemented by a single function call in R. This paper outlines the general class of Bayesian hierarchical models that can be implemented in the CARBayes software, describes their implementation via MCMC simulation techniques, and illustrates their use with two worked examples in the fields of house price analysis and disease mapping.;,citation_author=Duncan Lee;,citation_publication_date=2013-11;,citation_cover_date=2013-11;,citation_year=2013;,citation_issue=13;,citation_doi=10.18637/jss.v055.i13;,citation_issn=1548-7660;,citation_volume=55;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=A modelling approach with geographically weighted regression methods for determining geographic variation and influencing factors in housing price: A case in istanbul;,citation_abstract=Determining real estate market dynamics has become an important issue in the city economy for achieving sustainable urban land management and investment planning. This study aims to determine the potential influencing factors of housing prices through applying global regression models including Ordinary Least Squares (OLS), Spatial Lag Model (SLM), and Spatial Error Model (SEM) and to examine their geographic variation by local regression approaches such as Geographically Weighted Regression (GWR) and Multiscale Geographically Weighted Regression (MGWR). Pendik district of Istanbul (Turkey) was selected as study area. For these purposes, a case geodatabase was created with twenty-eight attributes: structural, geographic, and neighbourhood variables. Initially, nine significant variables used as input in the other models were selected with a stepwise OLS approach. The modelling results suggested that local models achieve better performance in comparison to global models. Furthermore, local model factor coefficients and local R2 values were mapped for nine variables. Geographic variations of these variables with regards to housing price were analysed for GWR and MGWR models. This study provides a comprehensive methodology for the real estate market and city authorities to understand the geographic variations of factors affecting the real estate market in urban geography.;,citation_author=Suleyman Sisman;,citation_author=Arif Cagdas Aydinoglu;,citation_publication_date=2022-08;,citation_cover_date=2022-08;,citation_year=2022;,citation_doi=10.1016/j.landusepol.2022.106183;,citation_issn=02648377;,citation_volume=119;,citation_journal_title=Land Use Policy;">
<meta name="citation_reference" content="citation_title=Housing price variations using spatio-temporal data mining techniques;,citation_abstract=The issue of property evaluation and appraisal has been of high interest for private and public agents involved in the housing industry for the purposes of trade, insurance and tax. This paper aims to investigate how different factors related to the location of a property affect its price over time. The predictive models applied in this research are driven by real estate transactions data of Tehran Metropolitan Area, captured from open data available to the public. The parameters of the functions that describe the behavior of the housing market are estimated through applying different types of statistical models, including ordinary least squares (OLS), geographically weighted regression (GWR) and geographically and temporally weighted regression (GTWR). This suite of models has been run in order to compare their efficiency and accuracy in predicting the variations in housing price. The GTWR model showed significantly better performance than OLS and GWR models, as the goodness of fit index (adjusted R2) improved by 22 percent. Therefore, spatio-temporal non-stationary modelling is significant in the explanation of the variations in housing value and the GTWR coefficients were found more reliable. Three internal factors (size of building; building age; building quality), and eight external factors (topography; land-use mix; population density; distance to city center; distance to subway station; distance to regional parks; distance to highway; distance to airport) influence the property price, either positively or negatively. Moreover, using significant variables that extracted from regression models, the optimum number of housing value clusters is generated using the spatial ‘k’luster analysis by tree edge removal (SKATER) method. Five clusters of housing patterns were recognized. The policy implication of this paper is grouping of Metropolitan Tehran housing value data into five clusters with different characteristics. The varying factors influencing housing value in each cluster are different, making this data analysis technique useful for policy-makers in the housing sector.;,citation_author=Ali Soltani;,citation_author=Christopher James Pettit;,citation_author=Mohammad Heydari;,citation_author=Fatemeh Aghaei;,citation_publication_date=2021-01;,citation_cover_date=2021-01;,citation_year=2021;,citation_issue=3;,citation_doi=10.1007/s10901-020-09811-y;,citation_issn=15737772;,citation_volume=36;,citation_journal_title=Journal of Housing and the Built Environment;">
<meta name="citation_reference" content="citation_title=Estimation of housing price variations using spatio-temporal data;,citation_author=Jorge Chica-Olmo;,citation_author=Rafael Cano-Guervos;,citation_author=Mario Chica-Rivas;,citation_publication_date=2019-03;,citation_cover_date=2019-03;,citation_year=2019;,citation_issue=6;,citation_doi=10.3390/su11061551;,citation_issn=20711050;,citation_volume=11;,citation_journal_title=Sustainability;">
<meta name="citation_reference" content="citation_title=Hierarchical modeling and analysis for spatial data;,citation_author=Sudipto Banerjee;,citation_author=Bradley P Carlin;,citation_author=Alan E Gelfand;,citation_publication_date=2014-07;,citation_cover_date=2014-07;,citation_year=2014;,citation_isbn=978-1-4398-1918-0;">
<meta name="citation_reference" content="citation_title=Statistics for spatial data;,citation_author=Noel Cressie;,citation_publication_date=2015-12;,citation_cover_date=2015-12;,citation_year=2015;,citation_isbn=0-471-00255-0;">
<meta name="citation_reference" content="citation_title=School district, education quality, and housing price: Evidence from a natural experiment in hangzhou, china;,citation_abstract=The capitalization effect of the education quality on housing prices has been widely studied by scholars. This study considers Hangzhou, China as an example, and uses the housing data of 660 communities to establish hedonic price and spatial econometric models. Based on the idea of natural experiment, our study quantitatively assesses the influence of the quality of urban compulsory education on housing prices, and tests whether the related educational policies significantly affect the capitalization effect of education. Results show that the quality of basic educational resources has been capitalized in the surrounding housing prices and primary and secondary schools have significant school district effects. Moreover, “zero school choice” policy strengthens the effect of the school district and exacerbates the behavior of selecting a school by buying a house. Therefore, the simplistic educational policies pursuing equity, such as the “nearby enrollment” policy and “zero school choice” policy, cannot result in actual justice, but may exacerbate the division of residential areas in accordance with income and inequality of educational opportunities.;,citation_author=Haizhen Wen;,citation_author=Yue Xiao;,citation_author=Ling Zhang;,citation_publication_date=2017-06;,citation_cover_date=2017-06;,citation_year=2017;,citation_doi=10.1016/j.cities.2017.03.008;,citation_issn=0264-2751;,citation_volume=66;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=House prices and relative location;,citation_abstract=Location is known to be a main determinant in people’s efforts to estimate the value of a house. However, the type of location, and subsequently how the value of that location is estimated, has not been investigated to the same degree. In hedonic price modelling, a well-used method of estimating housing as a composite good, locational proxies such as postcodes or census tracts are often used to control for location. This notion of location is what geographers refer to as absolute location, a fixed position in space, as opposed to relative location, a position in space relative to other positions. In this paper, we look at the difference in explanatory power of absolute versus relative location in a hedonic model for apartment sales, using the city of Oslo as our case. The main finding is that the added explanatory power of postcode dummies significantly diminishes when introducing relative location explanatory variables such as walking distance to key places like the metro and parks. As house prices correlate with consumer preferences, these findings will have implications for urban planning insofar as different neighborhood designs vary with respect to their ability to harvest relative location potentials.;,citation_author=Axel Viktor Heyman;,citation_author=Dag Einar Sommervoll;,citation_publication_date=2019-12;,citation_cover_date=2019-12;,citation_year=2019;,citation_doi=10.1016/j.cities.2019.06.004;,citation_issn=0264-2751;,citation_volume=95;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=Using machine learning algorithms for housing price prediction: The case of fairfax county, virginia housing data;,citation_abstract=House sales are determined based on the Standard &amp;amp;amp; Poor’s Case-Shiller home price indices and the housing price index of the Office of Federal Housing Enterprise Oversight (OFHEO). These reflect the trends of the US housing market. In addition to these housing price indices, the development of a housing price prediction model can greatly assist in the prediction of future housing prices and the establishment of real estate policies. This study uses machine learning algorithms as a research methodology to develop a housing price prediction model. To improve the accuracy of housing price prediction, this paper analyzes the housing data of 5359 townhouses in Fairfax County, Virginia, gathered by the Multiple Listing Service (MLS) of the Metropolitan Regional Information Systems (MRIS). We develop a housing price prediction model based on machine learning algorithms such as C4.5, RIPPER, Naïve Bayesian, and AdaBoost and compare their classification accuracy performance. We then propose an improved housing price prediction model to assist a house seller or a real estate agent make better informed decisions based on house price valuation. The experiments demonstrate that the RIPPER algorithm, based on accuracy, consistently outperforms the other models in the performance of housing price prediction.;,citation_author=Byeonghwa Park;,citation_author=Jae Kwon Bae;,citation_publication_date=2015-04;,citation_cover_date=2015-04;,citation_year=2015;,citation_issue=6;,citation_doi=10.1016/j.eswa.2014.11.040;,citation_issn=0957-4174;,citation_volume=42;,citation_journal_title=Expert systems with applications;">
<meta name="citation_reference" content="citation_title=Factors affecting spatial autocorrelation in residential property prices;,citation_abstract=Within housing literature, the presence of spatial autocorrelation (S.A.) in housing prices is typically examined horizontally in a two-dimensional setting. However, in the context of apartment buildings, there is also a vertical component of S.A. for housing units located on different floor levels. This paper therefore explores the determinants of both horizontal and vertical S.A. within residential property prices. First, we posit that S.A. in housing prices is a consequence of the price discovery process of real estate, in which property traders acquire price information from recent market transactions (i.e., comparables) to value a subject property. Furthermore, we contend that the extent to which property traders rely on comparables to determine housing prices is governed by the liquidity and volatility conditions of the market, which in turn affects the magnitude of the S.A. By developing and testing several spatial autoregressive hedonic models using open market transaction data for the Hong Kong residential property market, we find that market liquidity tends to increase both vertical and horizontal S.A., whilst market volatility is more prone to increase vertical S.A. but depress horizontal S.A.;,citation_author=Daniel Lo;,citation_author=Kwong Wing Chau;,citation_author=Siu Kei Wong;,citation_author=Michael McCord;,citation_author=Martin Haran;,citation_publication_date=2022-06;,citation_cover_date=2022-06;,citation_year=2022;,citation_issue=6;,citation_doi=10.3390/land11060931;,citation_issn= 2073-445X;,citation_volume=11;,citation_journal_title=Land;">
<meta name="citation_reference" content="citation_title=Inference for extremes in disease mapping;,citation_author=Hal Stern;,citation_author=Noel A Cressie;,citation_publication_date=1999;,citation_cover_date=1999;,citation_year=1999;,citation_volume=11;,citation_journal_title=John Wiley and Sons;">
<meta name="citation_reference" content="citation_title=Bayesian hierarchical spatial models: Implementing the besag york mollié model in stan;,citation_abstract=This report presents a new implementation of the Besag-York-Mollié (BYM) model in Stan, a probabilistic programming platform which does full Bayesian inference using Hamiltonian Monte Carlo (HMC). We review the spatial auto-correlation models used for areal data and disease risk mapping, and describe the corresponding Stan implementations. We also present a case study using Stan to fit a BYM model for motor vehicle crashes injuring school-age pedestrians in New York City from 2005 to 2014 localized to census tracts. Stan efficiently fit our multivariable BYM model having a large number of observations (n=2095 census tracts) with small outcome counts &amp;amp;amp;lt; 10 in the majority of tracts. Our findings reinforced that neighborhood income and social fragmentation are significant correlates of school-age pedestrian injuries. We also observed that nationally-available census tract estimates of commuting methods may serve as a useful indicator of underlying pedestrian densities.;,citation_author=Mitzi Morris;,citation_author=Katherine Wheeler-Martin;,citation_author=Dan Simpson;,citation_author=Stephen J Mooney;,citation_author=Andrew Gelman;,citation_author=Charles DiMaggio;,citation_publication_date=2019-11;,citation_cover_date=2019-11;,citation_year=2019;,citation_doi=10.1016/j.sste.2019.100301;,citation_issn=1877-5845;,citation_volume=31;,citation_journal_title=Spatial and spatio-temporal epidemiology;">
<meta name="citation_reference" content="citation_title=Building spatial conditional autoregressive (CAR) models in the stan programming language;,citation_author=Connor Donegan;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_publisher=OSF Preprints;">
<meta name="citation_reference" content="citation_title=Basis-function models in spatial statistics;,citation_author=Noel Cressie;,citation_author=Matthew Sainsbury-Dale;,citation_author=Andrew Zammit-Mangion;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=9;,citation_journal_title=Annual Review of Statistics and Its Application;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Geographically weighted regression: A method for exploring spatial nonstationarity;,citation_author=Chris Brunsdon;,citation_author=A Stewart Fotheringham;,citation_author=Martin E Charlton;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_issue=4;,citation_volume=28;,citation_journal_title=Geographical analysis;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Gaussian markov random fields: Theory and applications;,citation_author=Havard Rue;,citation_author=Leonhard Held;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;">
<meta name="citation_reference" content="citation_title=Spatial econometrics: Methods and models;,citation_author=Luc Anselin;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=4;">
<meta name="citation_reference" content="citation_title=Do spatial effecfs really matter in regression analysis?;,citation_author=Luc Anselin;,citation_author=Daniel A Griffith;,citation_publication_date=1988;,citation_cover_date=1988;,citation_year=1988;,citation_issue=1;,citation_volume=65;,citation_journal_title=Papers in Regional Science;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=On model specification and parameter space definitions in higher order spatial econometric models;,citation_author=J Paul Elhorst;,citation_author=Donald J Lacombe;,citation_author=Gianfranco Piras;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_issue=1-2;,citation_volume=42;,citation_journal_title=Regional Science and Urban Economics;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Spatial econometrics: From cross-sectional data to spatial panels;,citation_author=J Paul Elhorst;,citation_author=others;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_volume=479;">
<meta name="citation_reference" content="citation_title=Modeling owner-occupied single-family house values in the city of milwaukee: A geographically weighted regression approach;,citation_author=Danlin Yu;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_issue=3;,citation_volume=44;,citation_journal_title=GIScience &amp;amp;amp; Remote Sensing;,citation_publisher=Taylor &amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Geographically weighted regression using a non-euclidean distance metric with a study on london house price data;,citation_author=Binbin Lu;,citation_author=Martin Charlton;,citation_author=A Stewart Fotheringham;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_volume=7;,citation_journal_title=Procedia Environmental Sciences;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=A geographically weighted regression approach to investigating local built-environment effects on home prices in the housing downturn, recovery, and subsequent increases;,citation_author=Chih-Hao Wang;,citation_author=Na Chen;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=35;,citation_journal_title=Journal of Housing and the Built Environment;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Analysis of the influence of groundwater on land subsidence in beijing based on the geographical weighted regression (GWR) model;,citation_author=Hairuo Yu;,citation_author=Huili Gong;,citation_author=Beibei Chen;,citation_author=Kaisi Liu;,citation_author=Mingliang Gao;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=738;,citation_journal_title=Science of the Total Environment;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Inference in multiscale geographically weighted regression;,citation_author=Hanchen Yu;,citation_author=A Stewart Fotheringham;,citation_author=Ziqi Li;,citation_author=Taylor Oshan;,citation_author=Wei Kang;,citation_author=Levi John Wolf;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_issue=1;,citation_volume=52;,citation_journal_title=Geographical Analysis;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Simultaneous autoregressive models for spatial extremes;,citation_author=Miranda J Fix;,citation_author=Daniel S Cooley;,citation_author=Emeric Thibaud;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=2;,citation_volume=32;,citation_journal_title=Environmetrics;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Localized speed prediction with the use of spatial simultaneous autoregressive models;,citation_author=Georgios Sarlas;,citation_author=Kay W Axhausen;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_conference_title=TRB 94th annual meeting compendium of papers;,citation_conference=National Academy of Sciences;">
<meta name="citation_reference" content="citation_title=A comparison of simultaneous autoregressive and generalized least squares models for dealing with spatial autocorrelation;,citation_author=Santiago Beguería;,citation_author=Yolanda Pueyo;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_issue=3;,citation_volume=18;,citation_journal_title=Global Ecology and Biogeography;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Spatial and time effect of subway on property prices;,citation_abstract=The paper analyzes both spatial and time effects of subway availability on apartment prices in Warsaw, the only city in Poland with rapid urban transit system. The research is based on a data set of 34,274 geo-coded apartment transactions for the years 2008–2015 in Warsaw. For data analysis the hedonic method was used in OLS, SAR, SEM and SGM models. Additionally we used DiD approach to address potential endogeneity. We found strong evidence that the new subway line (M2) in Warsaw influenced apartment prices even before it was completed. We observed a steady price premium adjustment process related to the new subway line. The findings confirm our hypothesis and are in line with previous research carried out in other parts of the world.;,citation_author=Radoslaw Trojanek;,citation_author=Michal Gluszak;,citation_publication_date=2018-10;,citation_cover_date=2018-10;,citation_year=2018;,citation_doi=10.1007/s10901-017-9569-y;,citation_issn=1573-7772;,citation_volume=33;,citation_journal_title=Journal of Housing and the Built Environment;">
<meta name="citation_reference" content="citation_title=A close look at the spatial structure implied by the CAR and SAR models;,citation_author=Melanie M Wall;,citation_publication_date=2004;,citation_cover_date=2004;,citation_year=2004;,citation_issue=2;,citation_volume=121;,citation_journal_title=Journal of statistical planning and inference;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Buildings energy performance and real estate market value: An application of the spatial auto regressive (SAR) model;,citation_author=Marta Bottero;,citation_author=Marina Bravi;,citation_author=Giulio Mondini;,citation_author=Antonio Talarico;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Appraisal: From Theory to Practice: Results of SIEV 2015;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Application of hierarchical spatial autoregressive models to develop land value maps in urbanized areas;,citation_author=Radosław Cellmer;,citation_author=Katarzyna Kobylińska;,citation_author=Mirosław Bełej;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=4;,citation_volume=8;,citation_journal_title=ISPRS International Journal of Geo-Information;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Real estate appraisal: A review of valuation methods;,citation_author=Elli Pagourtzi;,citation_author=Vassilis Assimakopoulos;,citation_author=Thomas Hatzichristos;,citation_author=Nick French;,citation_publication_date=2003;,citation_cover_date=2003;,citation_year=2003;,citation_issue=4;,citation_volume=21;,citation_journal_title=Journal of property investment &amp;amp;amp; finance;,citation_publisher=MCB UP Ltd;">
<meta name="citation_reference" content="citation_title=A comprehensive overview regarding the impact of GIS on property valuation;,citation_author=Gabriela Droj;,citation_author=Anita Kwartnik-Pruc;,citation_author=Laurențiu Droj;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_issue=6;,citation_volume=13;,citation_journal_title=ISPRS International Journal of Geo-Information;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Understanding rental prices in the UK: A comparative application of spatial modelling approaches;,citation_author=Michael McCord;,citation_author=Peadar T Davis;,citation_author=Martin Haran;,citation_author=David McIlhatton;,citation_author=John McCord;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=1;,citation_volume=7;,citation_journal_title=International Journal of Housing Markets and Analysis;,citation_publisher=Emerald Group Publishing Limited;">
<meta name="citation_reference" content="citation_title=Spatial autoregressive models for statistical inference from ecological data;,citation_author=Jay M Ver Hoef;,citation_author=Erin E Peterson;,citation_author=Mevin B Hooten;,citation_author=Ephraim M Hanks;,citation_author=Marie-Josèe Fortin;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=88;,citation_journal_title=Ecological Monographs;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=How to interpret the coefficients of spatial models: Spillovers, direct and indirect effects;,citation_author=André Braz Golgher;,citation_author=Paul R Voss;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=4;,citation_journal_title=Spatial Demography;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Interpreting spatial econometric models;,citation_abstract=Past applications of spatial regression models have frequently interpreted the parameter estimates of models that include spatial lags of the dependent variable incorrectly. A discussion of issues surrounding proper interpretation of the estimates from a variety of spatial regression models is undertaken. We rely on scalar summary measures proposed by LeSage and Pace (Introduction to spatial econometrics. Taylor Francis/CRC Press, Boca Raton, 2009) who motivate that these reflect a proper interpretation of the marginal effects for the nonlinear models involving spatial lags of the dependent variable. These nonlinear spatial models are contrasted with linear spatial models, where interpretation is more straightforward. One of the major advantages of spatial regression models is their ability to quantify spatial spillovers. These can be defined as situations where nonzero cross-partial derivatives exist that reflect impacts on outcomes in region i arising from changes in characteristics of region j. Of course, these cross-partial derivatives can be interpreted as impacts of changes in an own region characteristic on other regions or changes in another regions’ characteristic on the own region. The ability to produce empirical estimates along with measures of dispersion that can be used for inference regarding the statistical significance, magnitude, and spatial extent of spillovers provides a major motivation for using spatial regression models.;,citation_author=James P. LeSage;,citation_author=R. Kelley Pace;,citation_editor=Manfred M. Fischer;,citation_editor=Peter Nijkamp;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-642-23430-9_91;,citation_doi=10.1007/978-3-642-23430-9_91;,citation_isbn=978-3-642-23430-9;,citation_inbook_title=Handbook of regional science;">
<meta name="citation_reference" content="citation_title=Bayesian analysis of conditional autoregressive models;,citation_author=Victor De Oliveira;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_volume=64;,citation_journal_title=Annals of the Institute of Statistical Mathematics;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Mice: Multivariate imputation by chained equations in r;,citation_author=Stef Van Buuren;,citation_author=Karin Groothuis-Oudshoorn;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_volume=45;,citation_journal_title=Journal of statistical software;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Author response to Reviewers comments</h6>

            <a href="./response.qmd" class="btn btn-primary quarto-download-embed" download="response.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Author response to Reviewers comments</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
        
        <div class="quarto-title-meta">

                
          
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>



    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

     <ol type="1">
<li>The choice of W (whether binary adjacency or row-standardized) is critical. Have the authors explored alternative spatial weight matrices, and how do they impact model performance?</li>
</ol>
<!-- 2.  While the CAR model shows lower bias and RMSE in the artificial study, does this advantage persist in real-world scenarios, particularly where data sparsity or boundary effects exist? -->
<!-- 3.  The estimated value of $\rho$ (spatial dependence strength) varies widely (e.g., 0.48 for the multilevel CAR model). Have the authors examined how sensitive the model results are to changes in $\rho$? -->
<!-- 4.  The study discusses the spatial effects $\phi$ as a key advantage of the CAR model, but how can these effects be meaningfully interpreted for house price determinants? Would spatial effect maps or additional diagnostic tools enhance this understanding? -->
<!-- 5.  Among the various spatial regression models, Geographically Weighted Regression (GWR) is particularly prominent in property price research (page 2). Before reaching this conclusion, did you compare GWR to other spatial regression models? -->
<!-- 6.  The scope of properties analysed includes residential houses and commercial real estate (page 16). How do the authors reconcile this with the abstract, which mentions only house price data? -->
<!-- 7.  After data cleaning, the final dataset included 598 entries representing multiple observations per sub-district (page 16). Why does the distribution of these data not appear on the map (Figure 6)? -->
<!-- 8.  The authors have applied point-level data using three different models (GLMM, GWR, and multilevel CAR) (page 17). How was this approach implemented, given that there is no explanation of how each observation was georeferenced? -->
<!-- 9.  Why is Table 5 not referred to in the text? -->
<!-- 10. The authors have argued that point-level models like GWR are limited when precise location data are unavailable (page 18). However, for the Lombok House Price Data, the authors have used point-level models. How do you reconcile this contradiction? -->
<!-- 11. In the Lombok house price analysis, no sensitivity analysis was conducted to test how different definitions of adjacency (W matrix) influence the results. Would the findings remain consistent if a different spatial weights structure was used? -->
<!-- 12. The study primarily evaluates CAR models within the Lombok context, but how well does it generalize to larger, high-density urban areas (e.g., Jakarta)? Would additional testing in a more complex metropolitan setting strengthen the validity of the conclusions? -->
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content --> 
  
</body></html>