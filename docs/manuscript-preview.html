<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
    <meta charset="utf-8">
    <meta name="generator" content="quarto-1.4.555">

    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

    <meta name="author" content="Indira Puteri Kinasih">
    <meta name="author" content="Haziq Jamil">
    <meta name="author" content="Elvynna Leong">
    <meta name="keywords" content="Conditional auto-regressive, simultaneous auto-regressive, geograpichally weighted regression, Property prices, Neighbourhood structure">

    <title>Conditionally Autoregressive Models for House Price Data: Insights From a Comparative Simulation Study</title>
    <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      div.columns{display: flex; gap: min(4vw, 1.5em);}
      div.column{flex: auto; overflow-x: auto;}
      div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
      ul.task-list{list-style: none;}
      ul.task-list li input[type="checkbox"] {
        width: 0.8em;
        margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
        vertical-align: middle;
      }
      /* CSS for syntax highlighting */
      pre > code.sourceCode { white-space: pre; position: relative; }
      pre > code.sourceCode > span { line-height: 1.25; }
      pre > code.sourceCode > span:empty { height: 1.2em; }
      .sourceCode { overflow: visible; }
      code.sourceCode > span { color: inherit; text-decoration: inherit; }
      div.sourceCode { margin: 1em 0; }
      pre.sourceCode { margin: 0; }
      @media screen {
      div.sourceCode { overflow: auto; }
      }
      @media print {
      pre > code.sourceCode { white-space: pre-wrap; }
      pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
      }
      pre.numberSource code
        { counter-reset: source-line 0; }
      pre.numberSource code > span
        { position: relative; left: -4em; counter-increment: source-line; }
      pre.numberSource code > span > a:first-child::before
        { content: counter(source-line);
          position: relative; left: -1em; text-align: right; vertical-align: baseline;
          border: none; display: inline-block;
          -webkit-touch-callout: none; -webkit-user-select: none;
          -khtml-user-select: none; -moz-user-select: none;
          -ms-user-select: none; user-select: none;
          padding: 0 4px; width: 4em;
        }
      pre.numberSource { margin-left: 3em;  padding-left: 4px; }
      div.sourceCode
        {   }
      @media screen {
      pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
      }
      /* CSS for citations */
      div.csl-bib-body { }
      div.csl-entry {
        clear: both;
        margin-bottom: 0em;
      }
      .hanging-indent div.csl-entry {
        margin-left:2em;
        text-indent:-2em;
      }
      div.csl-left-margin {
        min-width:2em;
        float:left;
      }
      div.csl-right-inline {
        margin-left:2em;
        padding-left:1em;
      }
      div.csl-indent {
        margin-left: 2em;
      }    </style>

    <style>
      body.hypothesis-enabled #quarto-embed-header {
        padding-right: 36px;
      }

      #quarto-embed-header {
        height: 3em;
        width: 100%;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: solid 1px;
      }

      #quarto-embed-header h6 {
        font-size: 1.1em;
        padding-top: 0.6em;
        margin-left: 1em;
        margin-right: 1em;
        font-weight: 400;
      }

      #quarto-embed-header a.quarto-back-link,
      #quarto-embed-header a.quarto-download-embed {
        font-size: 0.8em;
        margin-top: 1em;
        margin-bottom: 1em;
        margin-left: 1em;
        margin-right: 1em;
      }

      .quarto-back-container {
        padding-left: 0.5em;
        display: flex;
      }

      .headroom {
          will-change: transform;
          transition: transform 200ms linear;
      }

      .headroom--pinned {
          transform: translateY(0%);
      }

      .headroom--unpinned {
          transform: translateY(-100%);
      }      
    </style>

    <script>
    window.document.addEventListener("DOMContentLoaded", function () {

      var header = window.document.querySelector("#quarto-embed-header");
      const titleBannerEl = window.document.querySelector("body > #title-block-header");
      if (titleBannerEl) {
        titleBannerEl.style.paddingTop = header.clientHeight + "px";
      }
      const contentEl = window.document.getElementById('quarto-content');
      for (const child of contentEl.children) {
        child.style.paddingTop = header.clientHeight + "px";
        child.style.marginTop = "1em";
      }

      // Use the article root if the `back` call doesn't work. This isn't perfect
      // but should typically work
      window.quartoBackToArticle = () => {
        var currentUrl = window.location.href;
        window.history.back();
        setTimeout(() => {
            // if location was not changed in 100 ms, then there is no history back
            if(currentUrl === window.location.href){              
                // redirect to site root
                window.location.href = "index.html";
            }
        }, 100);
      }

      const headroom = new window.Headroom(header, {
        tolerance: 5,
        onPin: function () {
        },
        onUnpin: function () {
        },
      });
      headroom.init();
    });
    </script>

    
<script src="site_libs/manuscript-notebook/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
     <script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">   <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script> 
      <meta name="citation_title" content="Conditionally Autoregressive Models for House Price Data: Insights From a Comparative Simulation Study">
<meta name="citation_abstract" content="The modelling of property prices has been extensively studied in econometrics, with widely used approaches including generalised linear regression and geo- graphically weighted regression. These models commonly address local spatial correlations observed in property price data. However, despite its potential to capture spatial effects, the Conditional Autoregressive (CAR) model remains underutilised for this purpose. This study examines the robustness and predictive power of the CAR model, comparing it with established spatial models across three different datasets generation. An illustrative case study on Lombok house price data is also included. Simulation results showed that the CAR model demon- strates a distinct advantage, achieving lower bias and variability compared to other spatial regression models, effectively capturing neighbourhood-based spa- tial relationships, and exhibiting strong predictive power across various scenarios. In the Lombok case study, the CAR model outperformed other models, providing more precise estimates for property-related factors such as land size and built- up area. The results confirm that CAR’s spatial framework enables a nuanced analysis of property values across regions, enhancing accuracy in predictive mod- els. This study also reveals the distinct strengths and limitations of each model, offering insights into their predictive accuracy and applicability across diverse real estate contexts.
">
<meta name="citation_keywords" content="Conditional auto-regressive,simultaneous auto-regressive,geograpichally weighted regression,Property prices,Neighbourhood structure">
<meta name="citation_author" content="Indira Puteri Kinasih">
<meta name="citation_author" content="Haziq Jamil">
<meta name="citation_author" content="Elvynna Leong">
<meta name="citation_publication_date" content="2025">
<meta name="citation_cover_date" content="2025">
<meta name="citation_year" content="2025">
<meta name="citation_fulltext_html_url" content="https://indiraputeri-phd.github.io/CAR_simcomp/">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="Manuscript in Submission">
<meta name="citation_reference" content="citation_title=Localized spatiotemporal effects in the determinants of property prices: A case study of seoul;,citation_abstract=This research investigates both spatial and temporal elements of the apartment pricing process in Seoul, South Korea by modeling the determinants of apartment prices over a ten-year period from 2006 to 2015 with a hedonic price model containing a spatio-temporal lag model calibrated by geographically weighted regression (GWR). The results yield information on both spatial and temporal variations in the processes affecting apartment prices and demonstrate the use of GWR for generating local spatial dependency measures which are conditioned on various covariates rather than being simple descriptions of pattern. The study utilizes a combined approach to account for both spatial dependency in housing prices and spatial heterogeneity in the processes generating those prices. The results suggest that there are spatial variations in the determinants of apartment prices and that these spatial variations are fairly consistent over time. The effect of the spatial lag on house prices exhibits strong spatial variation which again is reasonably consistent over time.;,citation_author=A Stewart Fotheringham;,citation_author=Bumsub Park;,citation_publication_date=2018-08;,citation_cover_date=2018-08;,citation_year=2018;,citation_doi=10.1007/s12061-017-9232-8;,citation_issn=18744621;,citation_volume=11;,citation_journal_title=Applied Spatial Analysis and Policy;">
<meta name="citation_reference" content="citation_title=Does bus accessibility affect property prices?;,citation_abstract=Existing studies have yet reached consistent conclusions on accessibility benefits of buses. Most existing studies have been conducted in the context of the West, where bus patronage is generally low. In this study, we used a database of 22,586 secondhand residential properties in 358 residential estates in Xiamen, China to develop four non-spatial hedonic pricing models (one standard and three Box-Cox transformed) and two spatial econometric models to quantify the effects of bus accessibility on property prices and analyze how the introduction of spatial econometric models would influence estimates of such benefits. Our findings are as follows. (1) Access to bus stops is positively correlated with property prices. This outcome is in contrast with findings of mainstream research (or conventional wisdom). For every bus stop within 500 m, the price of a property is 0.5;,citation_author=Linchuan Yang;,citation_author=Jiangping Zhou;,citation_author=Oliver F Shyr;,citation_author=others;,citation_publication_date=2019-01;,citation_cover_date=2019-01;,citation_year=2019;,citation_doi=10.1016/j.cities.2018.07.005;,citation_issn=0264-2751;,citation_volume=84;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=Spatial analysis of housing prices and market activity with the geographically weighted regression;,citation_abstract=The main part of the study will be to demonstrate that models taking into account spatial heterogeneity (Geographically Weighted Regression and Mixed Geographically Weighted Regression) which reproduce housing market determinants better reflect market relationships than conventional regression models. The spatial heterogeneity of the housing market determinants results in the spatial diversity of the market activity, as well as of real estate prices and values. The main aim of the study was to analyse an effect of these socio-demographic and environmental factors on average housing property prices and on the number of transactions in a spatial approach. In previous research conducted on a national scale, usually all variables were treated in a similar way, i.e., as global or local variables. During the research, an attempt was also made to answer the question of which of the variables adopted for analysis have a local impact on prices and market activity, and which are global. The study was conducted in Poland and used data from the year 2018 on 380 counties (Local Administrative Units). The study showed that determinants both for average prices and for the housing market activity show spatial autocorrelation with high–high and low–low cluster groups. Owing to these models, it was possible to draw specific conclusions on local determinants of flat prices and the market activity in Poland. The study findings have confirmed that they are an extremely effective tool for spatial data analysis.;,citation_author=Radosław Cellmer;,citation_author=Aneta Cichulska;,citation_author=Mirosław Bełej;,citation_publication_date=2020-06;,citation_cover_date=2020-06;,citation_year=2020;,citation_issue=6;,citation_doi=10.3390/ijgi9060380;,citation_issn=2220-9964;,citation_volume=9;,citation_journal_title=ISPRS International Journal of Geo-Information;">
<meta name="citation_reference" content="citation_title=Geospatial health data: Modeling and visualization with r-INLA and shiny;,citation_abstract=Geospatial Health Data: Modeling and Visualization with R-INLA and Shiny describes spatial and spatio-temporal statistical methods and visualization techniques to analyze georeferenced health data in R. After a detailed introduction of geospatial data, the book shows how to develop Bayesian hierarchical models for disease mapping and apply computational approaches such as the integrated nested Laplace approximation (INLA) and the stochastic partial differential equation (SPDE) to analyze areal and geostatistical data. These approaches allow to quantify disease burden, understand geographic patterns and changes over time, identify risk factors, and measure inequalities between populations. The book also shows how to create interactive and static visualizations such as disease maps and time plots, and describes several R packages that can be used to easily turn analyses into visually informative and interactive reports, dashboards, and Shiny web applications that facilitate the communication of insights to collaborators and policymakers.;,citation_author=Paula Moraga;,citation_publication_date=2019-11;,citation_cover_date=2019-11;,citation_year=2019;,citation_isbn=9780367357955;">
<meta name="citation_reference" content="citation_title=Estimation of disease rates in small areas: A new mixed model for spatial dependence;,citation_author=Brian G Leroux;,citation_author=Xingye Lei;,citation_author=Norman Breslow;,citation_publication_date=2000;,citation_cover_date=2000;,citation_year=2000;,citation_conference_title=Statistical models in epidemiology, the environment, and clinical trials;">
<meta name="citation_reference" content="citation_title=Spatial interaction and the statistical analysis of lattice systems;,citation_abstract=The formulation of conditional probability models for finite systems of spatially interacting random variables is examined. A simple alternative proof of the Hammersley-Clifford theorem is presented and the theorem is then used to construct specific spatial schemes on and off the lattice. Particular emphasis is placed upon practical applications of the models in plant ecology when the variates are binary or Gaussian. Some aspects of infinite lattice Gaussian processes are discussed. Methods of statistical analysis for lattice schemes are proposed, including a very flexible coding technique. The methods are illustrated by two numerical examples. It is maintained throughout that the conditional probability approach to the specification and analysis of spatial interaction is more attractive than the alternative joint probability approach.;,citation_author=Julian Besag;,citation_publication_date=1974-01;,citation_cover_date=1974-01;,citation_year=1974;,citation_issue=2;,citation_doi=10.1111/j.2517-6161.1974.tb00999.x;,citation_issn=0964-1998;,citation_volume=36;,citation_journal_title=Journal of the Royal Statistical Society: Series B (Methodological);">
<meta name="citation_reference" content="citation_title=Bayesian image restoration, with two applications in spatial statistics;,citation_abstract=There has been much recent interest in Bayesian image analysis, including such topics as removal of blur and noise, detection of object boundaries, classification of textures, and reconstruction of two- or three-dimensional scenes from noisy lower-dimensional views. Perhaps the most straightforward task is that of image restoration, though it is often suggested that this is an area of relatively minor practical importance. The present paper argues the contrary, since many problems in the analysis of spatial data can be interpreted as problems of image restoration. Furthermore, the amounts of data involved allow routine use of computer intensive methods, such as the Gibbs sampler, that are not yet practicable for conventional images. Two examples are given, one in archeology, the other in epidemiology. These are preceded by a partial review of pixel-based Bayesian image analysis.;,citation_author=Julian Besag;,citation_author=Jeremy York;,citation_author=Annie Mollié;,citation_publication_date=1991-03;,citation_cover_date=1991-03;,citation_year=1991;,citation_doi=10.1007/BF00116466;,citation_issn=1572-9052;,citation_volume=43;,citation_journal_title=Annals of the institute of statistical mathematics;">
<meta name="citation_reference" content="citation_title=CARBayes: An r package for bayesian spatial modeling with conditional autoregressive priors;,citation_abstract=Conditional autoregressive models are commonly used to represent spatial autocorrelation in data relating to a set of non-overlapping areal units, which arise in a wide variety of applications including agriculture, education, epidemiology and image analysis. Such models are typically specified in a hierarchical Bayesian framework, with inference based on Markov chain Monte Carlo (MCMC) simulation. The most widely used software to fit such models is WinBUGS or OpenBUGS, but in this paper we introduce the R package CARBayes. The main advantage of CARBayes compared with the BUGS software is its ease of use, because: (1) the spatial adjacency information is easy to specify as a binary neighbourhood matrix; and (2) given the neighbourhood matrix the models can be implemented by a single function call in R. This paper outlines the general class of Bayesian hierarchical models that can be implemented in the CARBayes software, describes their implementation via MCMC simulation techniques, and illustrates their use with two worked examples in the fields of house price analysis and disease mapping.;,citation_author=Duncan Lee;,citation_publication_date=2013-11;,citation_cover_date=2013-11;,citation_year=2013;,citation_issue=13;,citation_doi=10.18637/jss.v055.i13;,citation_issn=1548-7660;,citation_volume=55;,citation_journal_title=Journal of Statistical Software;">
<meta name="citation_reference" content="citation_title=A modelling approach with geographically weighted regression methods for determining geographic variation and influencing factors in housing price: A case in istanbul;,citation_abstract=Determining real estate market dynamics has become an important issue in the city economy for achieving sustainable urban land management and investment planning. This study aims to determine the potential influencing factors of housing prices through applying global regression models including Ordinary Least Squares (OLS), Spatial Lag Model (SLM), and Spatial Error Model (SEM) and to examine their geographic variation by local regression approaches such as Geographically Weighted Regression (GWR) and Multiscale Geographically Weighted Regression (MGWR). Pendik district of Istanbul (Turkey) was selected as study area. For these purposes, a case geodatabase was created with twenty-eight attributes: structural, geographic, and neighbourhood variables. Initially, nine significant variables used as input in the other models were selected with a stepwise OLS approach. The modelling results suggested that local models achieve better performance in comparison to global models. Furthermore, local model factor coefficients and local R2 values were mapped for nine variables. Geographic variations of these variables with regards to housing price were analysed for GWR and MGWR models. This study provides a comprehensive methodology for the real estate market and city authorities to understand the geographic variations of factors affecting the real estate market in urban geography.;,citation_author=Suleyman Sisman;,citation_author=Arif Cagdas Aydinoglu;,citation_publication_date=2022-08;,citation_cover_date=2022-08;,citation_year=2022;,citation_doi=10.1016/j.landusepol.2022.106183;,citation_issn=02648377;,citation_volume=119;,citation_journal_title=Land Use Policy;">
<meta name="citation_reference" content="citation_title=Housing price variations using spatio-temporal data mining techniques;,citation_abstract=The issue of property evaluation and appraisal has been of high interest for private and public agents involved in the housing industry for the purposes of trade, insurance and tax. This paper aims to investigate how different factors related to the location of a property affect its price over time. The predictive models applied in this research are driven by real estate transactions data of Tehran Metropolitan Area, captured from open data available to the public. The parameters of the functions that describe the behavior of the housing market are estimated through applying different types of statistical models, including ordinary least squares (OLS), geographically weighted regression (GWR) and geographically and temporally weighted regression (GTWR). This suite of models has been run in order to compare their efficiency and accuracy in predicting the variations in housing price. The GTWR model showed significantly better performance than OLS and GWR models, as the goodness of fit index (adjusted R2) improved by 22 percent. Therefore, spatio-temporal non-stationary modelling is significant in the explanation of the variations in housing value and the GTWR coefficients were found more reliable. Three internal factors (size of building; building age; building quality), and eight external factors (topography; land-use mix; population density; distance to city center; distance to subway station; distance to regional parks; distance to highway; distance to airport) influence the property price, either positively or negatively. Moreover, using significant variables that extracted from regression models, the optimum number of housing value clusters is generated using the spatial ‘k’luster analysis by tree edge removal (SKATER) method. Five clusters of housing patterns were recognized. The policy implication of this paper is grouping of Metropolitan Tehran housing value data into five clusters with different characteristics. The varying factors influencing housing value in each cluster are different, making this data analysis technique useful for policy-makers in the housing sector.;,citation_author=Ali Soltani;,citation_author=Christopher James Pettit;,citation_author=Mohammad Heydari;,citation_author=Fatemeh Aghaei;,citation_publication_date=2021-01;,citation_cover_date=2021-01;,citation_year=2021;,citation_issue=3;,citation_doi=10.1007/s10901-020-09811-y;,citation_issn=15737772;,citation_volume=36;,citation_journal_title=Journal of Housing and the Built Environment;">
<meta name="citation_reference" content="citation_title=Estimation of housing price variations using spatio-temporal data;,citation_author=Jorge Chica-Olmo;,citation_author=Rafael Cano-Guervos;,citation_author=Mario Chica-Rivas;,citation_publication_date=2019-03;,citation_cover_date=2019-03;,citation_year=2019;,citation_issue=6;,citation_doi=10.3390/su11061551;,citation_issn=20711050;,citation_volume=11;,citation_journal_title=Sustainability;">
<meta name="citation_reference" content="citation_title=Hierarchical modeling and analysis for spatial data;,citation_author=Sudipto Banerjee;,citation_author=Bradley P Carlin;,citation_author=Alan E Gelfand;,citation_publication_date=2014-07;,citation_cover_date=2014-07;,citation_year=2014;,citation_isbn=978-1-4398-1918-0;">
<meta name="citation_reference" content="citation_title=Statistics for spatial data;,citation_author=Noel Cressie;,citation_publication_date=2015-12;,citation_cover_date=2015-12;,citation_year=2015;,citation_isbn=0-471-00255-0;">
<meta name="citation_reference" content="citation_title=School district, education quality, and housing price: Evidence from a natural experiment in hangzhou, china;,citation_abstract=The capitalization effect of the education quality on housing prices has been widely studied by scholars. This study considers Hangzhou, China as an example, and uses the housing data of 660 communities to establish hedonic price and spatial econometric models. Based on the idea of natural experiment, our study quantitatively assesses the influence of the quality of urban compulsory education on housing prices, and tests whether the related educational policies significantly affect the capitalization effect of education. Results show that the quality of basic educational resources has been capitalized in the surrounding housing prices and primary and secondary schools have significant school district effects. Moreover, “zero school choice” policy strengthens the effect of the school district and exacerbates the behavior of selecting a school by buying a house. Therefore, the simplistic educational policies pursuing equity, such as the “nearby enrollment” policy and “zero school choice” policy, cannot result in actual justice, but may exacerbate the division of residential areas in accordance with income and inequality of educational opportunities.;,citation_author=Haizhen Wen;,citation_author=Yue Xiao;,citation_author=Ling Zhang;,citation_publication_date=2017-06;,citation_cover_date=2017-06;,citation_year=2017;,citation_doi=10.1016/j.cities.2017.03.008;,citation_issn=0264-2751;,citation_volume=66;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=House prices and relative location;,citation_abstract=Location is known to be a main determinant in people’s efforts to estimate the value of a house. However, the type of location, and subsequently how the value of that location is estimated, has not been investigated to the same degree. In hedonic price modelling, a well-used method of estimating housing as a composite good, locational proxies such as postcodes or census tracts are often used to control for location. This notion of location is what geographers refer to as absolute location, a fixed position in space, as opposed to relative location, a position in space relative to other positions. In this paper, we look at the difference in explanatory power of absolute versus relative location in a hedonic model for apartment sales, using the city of Oslo as our case. The main finding is that the added explanatory power of postcode dummies significantly diminishes when introducing relative location explanatory variables such as walking distance to key places like the metro and parks. As house prices correlate with consumer preferences, these findings will have implications for urban planning insofar as different neighborhood designs vary with respect to their ability to harvest relative location potentials.;,citation_author=Axel Viktor Heyman;,citation_author=Dag Einar Sommervoll;,citation_publication_date=2019-12;,citation_cover_date=2019-12;,citation_year=2019;,citation_doi=10.1016/j.cities.2019.06.004;,citation_issn=0264-2751;,citation_volume=95;,citation_journal_title=Cities;">
<meta name="citation_reference" content="citation_title=Using machine learning algorithms for housing price prediction: The case of fairfax county, virginia housing data;,citation_abstract=House sales are determined based on the Standard &amp;amp;amp; Poor’s Case-Shiller home price indices and the housing price index of the Office of Federal Housing Enterprise Oversight (OFHEO). These reflect the trends of the US housing market. In addition to these housing price indices, the development of a housing price prediction model can greatly assist in the prediction of future housing prices and the establishment of real estate policies. This study uses machine learning algorithms as a research methodology to develop a housing price prediction model. To improve the accuracy of housing price prediction, this paper analyzes the housing data of 5359 townhouses in Fairfax County, Virginia, gathered by the Multiple Listing Service (MLS) of the Metropolitan Regional Information Systems (MRIS). We develop a housing price prediction model based on machine learning algorithms such as C4.5, RIPPER, Naïve Bayesian, and AdaBoost and compare their classification accuracy performance. We then propose an improved housing price prediction model to assist a house seller or a real estate agent make better informed decisions based on house price valuation. The experiments demonstrate that the RIPPER algorithm, based on accuracy, consistently outperforms the other models in the performance of housing price prediction.;,citation_author=Byeonghwa Park;,citation_author=Jae Kwon Bae;,citation_publication_date=2015-04;,citation_cover_date=2015-04;,citation_year=2015;,citation_issue=6;,citation_doi=10.1016/j.eswa.2014.11.040;,citation_issn=0957-4174;,citation_volume=42;,citation_journal_title=Expert systems with applications;">
<meta name="citation_reference" content="citation_title=Factors affecting spatial autocorrelation in residential property prices;,citation_abstract=Within housing literature, the presence of spatial autocorrelation (S.A.) in housing prices is typically examined horizontally in a two-dimensional setting. However, in the context of apartment buildings, there is also a vertical component of S.A. for housing units located on different floor levels. This paper therefore explores the determinants of both horizontal and vertical S.A. within residential property prices. First, we posit that S.A. in housing prices is a consequence of the price discovery process of real estate, in which property traders acquire price information from recent market transactions (i.e., comparables) to value a subject property. Furthermore, we contend that the extent to which property traders rely on comparables to determine housing prices is governed by the liquidity and volatility conditions of the market, which in turn affects the magnitude of the S.A. By developing and testing several spatial autoregressive hedonic models using open market transaction data for the Hong Kong residential property market, we find that market liquidity tends to increase both vertical and horizontal S.A., whilst market volatility is more prone to increase vertical S.A. but depress horizontal S.A.;,citation_author=Daniel Lo;,citation_author=Kwong Wing Chau;,citation_author=Siu Kei Wong;,citation_author=Michael McCord;,citation_author=Martin Haran;,citation_publication_date=2022-06;,citation_cover_date=2022-06;,citation_year=2022;,citation_issue=6;,citation_doi=10.3390/land11060931;,citation_issn= 2073-445X;,citation_volume=11;,citation_journal_title=Land;">
<meta name="citation_reference" content="citation_title=Inference for extremes in disease mapping;,citation_author=Hal Stern;,citation_author=Noel A Cressie;,citation_publication_date=1999;,citation_cover_date=1999;,citation_year=1999;,citation_volume=11;,citation_journal_title=John Wiley and Sons;">
<meta name="citation_reference" content="citation_title=Bayesian hierarchical spatial models: Implementing the besag york mollié model in stan;,citation_abstract=This report presents a new implementation of the Besag-York-Mollié (BYM) model in Stan, a probabilistic programming platform which does full Bayesian inference using Hamiltonian Monte Carlo (HMC). We review the spatial auto-correlation models used for areal data and disease risk mapping, and describe the corresponding Stan implementations. We also present a case study using Stan to fit a BYM model for motor vehicle crashes injuring school-age pedestrians in New York City from 2005 to 2014 localized to census tracts. Stan efficiently fit our multivariable BYM model having a large number of observations (n=2095 census tracts) with small outcome counts &amp;amp;amp;lt; 10 in the majority of tracts. Our findings reinforced that neighborhood income and social fragmentation are significant correlates of school-age pedestrian injuries. We also observed that nationally-available census tract estimates of commuting methods may serve as a useful indicator of underlying pedestrian densities.;,citation_author=Mitzi Morris;,citation_author=Katherine Wheeler-Martin;,citation_author=Dan Simpson;,citation_author=Stephen J Mooney;,citation_author=Andrew Gelman;,citation_author=Charles DiMaggio;,citation_publication_date=2019-11;,citation_cover_date=2019-11;,citation_year=2019;,citation_doi=10.1016/j.sste.2019.100301;,citation_issn=1877-5845;,citation_volume=31;,citation_journal_title=Spatial and spatio-temporal epidemiology;">
<meta name="citation_reference" content="citation_title=Building spatial conditional autoregressive (CAR) models in the stan programming language;,citation_author=Connor Donegan;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_publisher=OSF Preprints;">
<meta name="citation_reference" content="citation_title=Basis-function models in spatial statistics;,citation_author=Noel Cressie;,citation_author=Matthew Sainsbury-Dale;,citation_author=Andrew Zammit-Mangion;,citation_publication_date=2022;,citation_cover_date=2022;,citation_year=2022;,citation_volume=9;,citation_journal_title=Annual Review of Statistics and Its Application;,citation_publisher=Annual Reviews;">
<meta name="citation_reference" content="citation_title=Geographically weighted regression: A method for exploring spatial nonstationarity;,citation_author=Chris Brunsdon;,citation_author=A Stewart Fotheringham;,citation_author=Martin E Charlton;,citation_publication_date=1996;,citation_cover_date=1996;,citation_year=1996;,citation_issue=4;,citation_volume=28;,citation_journal_title=Geographical analysis;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Gaussian markov random fields: Theory and applications;,citation_author=Havard Rue;,citation_author=Leonhard Held;,citation_publication_date=2005;,citation_cover_date=2005;,citation_year=2005;">
<meta name="citation_reference" content="citation_title=Spatial econometrics: Methods and models;,citation_author=Luc Anselin;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_volume=4;">
<meta name="citation_reference" content="citation_title=Do spatial effecfs really matter in regression analysis?;,citation_author=Luc Anselin;,citation_author=Daniel A Griffith;,citation_publication_date=1988;,citation_cover_date=1988;,citation_year=1988;,citation_issue=1;,citation_volume=65;,citation_journal_title=Papers in Regional Science;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=On model specification and parameter space definitions in higher order spatial econometric models;,citation_author=J Paul Elhorst;,citation_author=Donald J Lacombe;,citation_author=Gianfranco Piras;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_issue=1-2;,citation_volume=42;,citation_journal_title=Regional Science and Urban Economics;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Spatial econometrics: From cross-sectional data to spatial panels;,citation_author=J Paul Elhorst;,citation_author=others;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_volume=479;">
<meta name="citation_reference" content="citation_title=Modeling owner-occupied single-family house values in the city of milwaukee: A geographically weighted regression approach;,citation_author=Danlin Yu;,citation_publication_date=2007;,citation_cover_date=2007;,citation_year=2007;,citation_issue=3;,citation_volume=44;,citation_journal_title=GIScience &amp;amp;amp; Remote Sensing;,citation_publisher=Taylor &amp;amp; Francis;">
<meta name="citation_reference" content="citation_title=Geographically weighted regression using a non-euclidean distance metric with a study on london house price data;,citation_author=Binbin Lu;,citation_author=Martin Charlton;,citation_author=A Stewart Fotheringham;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_volume=7;,citation_journal_title=Procedia Environmental Sciences;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=A geographically weighted regression approach to investigating local built-environment effects on home prices in the housing downturn, recovery, and subsequent increases;,citation_author=Chih-Hao Wang;,citation_author=Na Chen;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=35;,citation_journal_title=Journal of Housing and the Built Environment;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Analysis of the influence of groundwater on land subsidence in beijing based on the geographical weighted regression (GWR) model;,citation_author=Hairuo Yu;,citation_author=Huili Gong;,citation_author=Beibei Chen;,citation_author=Kaisi Liu;,citation_author=Mingliang Gao;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_volume=738;,citation_journal_title=Science of the Total Environment;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Inference in multiscale geographically weighted regression;,citation_author=Hanchen Yu;,citation_author=A Stewart Fotheringham;,citation_author=Ziqi Li;,citation_author=Taylor Oshan;,citation_author=Wei Kang;,citation_author=Levi John Wolf;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_issue=1;,citation_volume=52;,citation_journal_title=Geographical Analysis;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Simultaneous autoregressive models for spatial extremes;,citation_author=Miranda J Fix;,citation_author=Daniel S Cooley;,citation_author=Emeric Thibaud;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_issue=2;,citation_volume=32;,citation_journal_title=Environmetrics;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Localized speed prediction with the use of spatial simultaneous autoregressive models;,citation_author=Georgios Sarlas;,citation_author=Kay W Axhausen;,citation_publication_date=2015;,citation_cover_date=2015;,citation_year=2015;,citation_conference_title=TRB 94th annual meeting compendium of papers;,citation_conference=National Academy of Sciences;">
<meta name="citation_reference" content="citation_title=A comparison of simultaneous autoregressive and generalized least squares models for dealing with spatial autocorrelation;,citation_author=Santiago Beguería;,citation_author=Yolanda Pueyo;,citation_publication_date=2009;,citation_cover_date=2009;,citation_year=2009;,citation_issue=3;,citation_volume=18;,citation_journal_title=Global Ecology and Biogeography;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=Spatial and time effect of subway on property prices;,citation_abstract=The paper analyzes both spatial and time effects of subway availability on apartment prices in Warsaw, the only city in Poland with rapid urban transit system. The research is based on a data set of 34,274 geo-coded apartment transactions for the years 2008–2015 in Warsaw. For data analysis the hedonic method was used in OLS, SAR, SEM and SGM models. Additionally we used DiD approach to address potential endogeneity. We found strong evidence that the new subway line (M2) in Warsaw influenced apartment prices even before it was completed. We observed a steady price premium adjustment process related to the new subway line. The findings confirm our hypothesis and are in line with previous research carried out in other parts of the world.;,citation_author=Radoslaw Trojanek;,citation_author=Michal Gluszak;,citation_publication_date=2018-10;,citation_cover_date=2018-10;,citation_year=2018;,citation_doi=10.1007/s10901-017-9569-y;,citation_issn=1573-7772;,citation_volume=33;,citation_journal_title=Journal of Housing and the Built Environment;">
<meta name="citation_reference" content="citation_title=A close look at the spatial structure implied by the CAR and SAR models;,citation_author=Melanie M Wall;,citation_publication_date=2004;,citation_cover_date=2004;,citation_year=2004;,citation_issue=2;,citation_volume=121;,citation_journal_title=Journal of statistical planning and inference;,citation_publisher=Elsevier;">
<meta name="citation_reference" content="citation_title=Buildings energy performance and real estate market value: An application of the spatial auto regressive (SAR) model;,citation_author=Marta Bottero;,citation_author=Marina Bravi;,citation_author=Giulio Mondini;,citation_author=Antonio Talarico;,citation_publication_date=2017;,citation_cover_date=2017;,citation_year=2017;,citation_journal_title=Appraisal: From Theory to Practice: Results of SIEV 2015;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Application of hierarchical spatial autoregressive models to develop land value maps in urbanized areas;,citation_author=Radosław Cellmer;,citation_author=Katarzyna Kobylińska;,citation_author=Mirosław Bełej;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_issue=4;,citation_volume=8;,citation_journal_title=ISPRS International Journal of Geo-Information;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Real estate appraisal: A review of valuation methods;,citation_author=Elli Pagourtzi;,citation_author=Vassilis Assimakopoulos;,citation_author=Thomas Hatzichristos;,citation_author=Nick French;,citation_publication_date=2003;,citation_cover_date=2003;,citation_year=2003;,citation_issue=4;,citation_volume=21;,citation_journal_title=Journal of property investment &amp;amp;amp; finance;,citation_publisher=MCB UP Ltd;">
<meta name="citation_reference" content="citation_title=A comprehensive overview regarding the impact of GIS on property valuation;,citation_author=Gabriela Droj;,citation_author=Anita Kwartnik-Pruc;,citation_author=Laurențiu Droj;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_issue=6;,citation_volume=13;,citation_journal_title=ISPRS International Journal of Geo-Information;,citation_publisher=MDPI;">
<meta name="citation_reference" content="citation_title=Understanding rental prices in the UK: A comparative application of spatial modelling approaches;,citation_author=Michael McCord;,citation_author=Peadar T Davis;,citation_author=Martin Haran;,citation_author=David McIlhatton;,citation_author=John McCord;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_issue=1;,citation_volume=7;,citation_journal_title=International Journal of Housing Markets and Analysis;,citation_publisher=Emerald Group Publishing Limited;">
<meta name="citation_reference" content="citation_title=Spatial autoregressive models for statistical inference from ecological data;,citation_author=Jay M Ver Hoef;,citation_author=Erin E Peterson;,citation_author=Mevin B Hooten;,citation_author=Ephraim M Hanks;,citation_author=Marie-Josèe Fortin;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_issue=1;,citation_volume=88;,citation_journal_title=Ecological Monographs;,citation_publisher=Wiley Online Library;">
<meta name="citation_reference" content="citation_title=How to interpret the coefficients of spatial models: Spillovers, direct and indirect effects;,citation_author=André Braz Golgher;,citation_author=Paul R Voss;,citation_publication_date=2016;,citation_cover_date=2016;,citation_year=2016;,citation_volume=4;,citation_journal_title=Spatial Demography;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Interpreting spatial econometric models;,citation_abstract=Past applications of spatial regression models have frequently interpreted the parameter estimates of models that include spatial lags of the dependent variable incorrectly. A discussion of issues surrounding proper interpretation of the estimates from a variety of spatial regression models is undertaken. We rely on scalar summary measures proposed by LeSage and Pace (Introduction to spatial econometrics. Taylor Francis/CRC Press, Boca Raton, 2009) who motivate that these reflect a proper interpretation of the marginal effects for the nonlinear models involving spatial lags of the dependent variable. These nonlinear spatial models are contrasted with linear spatial models, where interpretation is more straightforward. One of the major advantages of spatial regression models is their ability to quantify spatial spillovers. These can be defined as situations where nonzero cross-partial derivatives exist that reflect impacts on outcomes in region i arising from changes in characteristics of region j. Of course, these cross-partial derivatives can be interpreted as impacts of changes in an own region characteristic on other regions or changes in another regions’ characteristic on the own region. The ability to produce empirical estimates along with measures of dispersion that can be used for inference regarding the statistical significance, magnitude, and spatial extent of spillovers provides a major motivation for using spatial regression models.;,citation_author=James P. LeSage;,citation_author=R. Kelley Pace;,citation_editor=Manfred M. Fischer;,citation_editor=Peter Nijkamp;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_fulltext_html_url=https://doi.org/10.1007/978-3-642-23430-9_91;,citation_doi=10.1007/978-3-642-23430-9_91;,citation_isbn=978-3-642-23430-9;,citation_inbook_title=Handbook of regional science;">
<meta name="citation_reference" content="citation_title=Bayesian analysis of conditional autoregressive models;,citation_author=Victor De Oliveira;,citation_publication_date=2012;,citation_cover_date=2012;,citation_year=2012;,citation_volume=64;,citation_journal_title=Annals of the Institute of Statistical Mathematics;,citation_publisher=Springer;">
<meta name="citation_reference" content="citation_title=Mice: Multivariate imputation by chained equations in r;,citation_author=Stef Van Buuren;,citation_author=Karin Groothuis-Oudshoorn;,citation_publication_date=2011;,citation_cover_date=2011;,citation_year=2011;,citation_volume=45;,citation_journal_title=Journal of statistical software;">
<meta name="citation_reference" content="citation_title=Sample size for the evaluation of presence-absence models;,citation_author=A. Jimenez Valverde;,citation_publication_date=2020;,citation_cover_date=2020;,citation_year=2020;,citation_doi=10.1016/j.ecolind.2020.106289;,citation_volume=114;,citation_journal_title=Ecological Indicators;">
<meta name="citation_reference" content="citation_title=A poisson-lognormal conditional-autoregressive model for multivariate spatial analysis of pedestrian crash counts across neighborhoods.;,citation_author=Yiyi Wang;,citation_author=K. Kockelman;,citation_publication_date=2013;,citation_cover_date=2013;,citation_year=2013;,citation_doi=10.1016/j.aap.2013.07.030;,citation_volume=60;,citation_journal_title=Accident; analysis and prevention;">
<meta name="citation_reference" content="citation_title=Application of local conditional autoregressive models for development of zonal crash prediction models and identification of crash risk boundaries;,citation_author=Emad Soroori;,citation_author=Abolfazl Mohammadzadeh Moghaddam;,citation_author=M. Salehi;,citation_publication_date=2019;,citation_cover_date=2019;,citation_year=2019;,citation_doi=10.1080/23249935.2018.1564801;,citation_volume=15;,citation_journal_title=Transportmetrica A: Transport Science;">
<meta name="citation_reference" content="citation_title=Bayesian spatial joint modeling of traffic crashes on an urban road network.;,citation_author=Q. Zeng;,citation_author=Helai Huang;,citation_publication_date=2014;,citation_cover_date=2014;,citation_year=2014;,citation_doi=10.1016/j.aap.2014.02.018;,citation_volume=67;,citation_journal_title=Accident; analysis and prevention;">
<meta name="citation_reference" content="citation_title=Effects of spatial autocorrelation and imperfect detection on species distribution models;,citation_author=J. Guelat;,citation_author=M. Kéry;,citation_publication_date=2018;,citation_cover_date=2018;,citation_year=2018;,citation_doi=10.1111/2041-210X.12983;,citation_volume=9;,citation_journal_title=Methods in Ecology and Evolution;">
<meta name="citation_reference" content="citation_title=Multilevel and related models for longitudinal data;,citation_author=Anders Skrondal;,citation_author=Sophia Rabe-Hesketh;,citation_publication_date=2008;,citation_cover_date=2008;,citation_year=2008;,citation_inbook_title=Handbook of multilevel analysis;">
</head>

  <body class="quarto-notebook">
    <div id="quarto-embed-header" class="headroom fixed-top bg-primary">
      
      <a onclick="window.quartoBackToArticle(); return false;" class="btn btn-primary quarto-back-link" href=""><i class="bi bi-caret-left"></i> Back to Article</a>
      <h6><i class="bi bi-journal-code"></i> Article Notebook</h6>

            <a href="./manuscript.qmd" class="btn btn-primary quarto-download-embed" download="manuscript.qmd">Download Source</a>
          </div>

     <header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Conditionally Autoregressive Models for House Price Data: Insights From a Comparative Simulation Study</h1>
          </div>

    
    <div class="quarto-title-meta-container">
      <div class="quarto-title-meta-column-start">
            <div class="quarto-title-meta-author">
          <div class="quarto-title-meta-heading">Authors</div>
          <div class="quarto-title-meta-heading">Affiliations</div>
          
                <div class="quarto-title-meta-contents">
            <p class="author">Indira Puteri Kinasih <a href="mailto:indiraputeri@uinmataram.ac.id" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0009-6959-6723" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Universiti Brunei Darussalam
                      </p>
                    <p class="affiliation">
                        Universitas Islam Negeri Mataram
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author"><a href="https://haziqj.ml">Haziq Jamil</a> <a href="mailto:haziq.jamil@ubd.edu.bn" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-3298-1010" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Universiti Brunei Darussalam
                      </p>
                  </div>
                      <div class="quarto-title-meta-contents">
            <p class="author">Elvynna Leong <a href="mailto:elvynna.leong@ubd.edu.bn" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0000-0003-3298-1010" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
          </div>
                <div class="quarto-title-meta-contents">
                    <p class="affiliation">
                        Universiti Brunei Darussalam
                      </p>
                  </div>
                    </div>
        
        <div class="quarto-title-meta">

                      
          
                <div>
            <div class="quarto-title-meta-heading">Modified</div>
            <div class="quarto-title-meta-contents">
              <p class="date-modified">May 6, 2025</p>
            </div>
          </div>
                
              </div>
      </div>
      <div class="quarto-title-meta-column-end quarto-other-formats-target">
      </div>
    </div>

    <div>
      <div class="abstract">
        <div class="block-title">Abstract</div>
        <p>The modelling of property prices has been extensively studied in econometrics, with widely used approaches including generalised linear regression and geo- graphically weighted regression. These models commonly address local spatial correlations observed in property price data. However, despite its potential to capture spatial effects, the Conditional Autoregressive (CAR) model remains underutilised for this purpose. This study examines the robustness and predictive power of the CAR model, comparing it with established spatial models across three different datasets generation. An illustrative case study on Lombok house price data is also included. Simulation results showed that the CAR model demon- strates a distinct advantage, achieving lower bias and variability compared to other spatial regression models, effectively capturing neighbourhood-based spa- tial relationships, and exhibiting strong predictive power across various scenarios. In the Lombok case study, the CAR model outperformed other models, providing more precise estimates for property-related factors such as land size and built- up area. The results confirm that CAR’s spatial framework enables a nuanced analysis of property values across regions, enhancing accuracy in predictive mod- els. This study also reveals the distinct strengths and limitations of each model, offering insights into their predictive accuracy and applicability across diverse real estate contexts.</p>
      </div>
    </div>

    <div>
      <div class="keywords">
        <div class="block-title">Keywords</div>
        <p>Conditional auto-regressive, simultaneous auto-regressive, geograpichally weighted regression, Property prices, Neighbourhood structure</p>
      </div>
    </div>

    <div class="quarto-other-links-text-target">
    </div>  </div>
</header><div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#related-works" id="toc-related-works" class="nav-link" data-scroll-target="#related-works">Related works</a></li>
  <li><a href="#study-region" id="toc-study-region" class="nav-link" data-scroll-target="#study-region">Study region</a></li>
  <li><a href="#spatial-regression-model" id="toc-spatial-regression-model" class="nav-link" data-scroll-target="#spatial-regression-model">Spatial regression model</a>
  <ul class="collapse">
  <li><a href="#geographically-weighted-regression-gwr" id="toc-geographically-weighted-regression-gwr" class="nav-link" data-scroll-target="#geographically-weighted-regression-gwr">Geographically Weighted Regression (GWR)</a></li>
  <li><a href="#simultaneously-autoregressive-sar-models" id="toc-simultaneously-autoregressive-sar-models" class="nav-link" data-scroll-target="#simultaneously-autoregressive-sar-models">Simultaneously Autoregressive (SAR) Models</a></li>
  <li><a href="#conditional-autoregressive-car-models" id="toc-conditional-autoregressive-car-models" class="nav-link" data-scroll-target="#conditional-autoregressive-car-models">Conditional Autoregressive (CAR) Models</a></li>
  </ul></li>
  <li><a href="#comparative-analysis-of-glm-sar-and-car" id="toc-comparative-analysis-of-glm-sar-and-car" class="nav-link" data-scroll-target="#comparative-analysis-of-glm-sar-and-car">Comparative Analysis of GLM, SAR, and CAR</a>
  <ul class="collapse">
  <li><a href="#the-experiment-design" id="toc-the-experiment-design" class="nav-link" data-scroll-target="#the-experiment-design">The experiment design</a></li>
  <li><a href="#robustness-and-power-prediction-analysis" id="toc-robustness-and-power-prediction-analysis" class="nav-link" data-scroll-target="#robustness-and-power-prediction-analysis">Robustness and power prediction analysis</a></li>
  </ul></li>
  <li><a href="#applications-in-lombok-house-prices-dataset" id="toc-applications-in-lombok-house-prices-dataset" class="nav-link" data-scroll-target="#applications-in-lombok-house-prices-dataset">Applications in Lombok house prices dataset</a>
  <ul class="collapse">
  <li><a href="#data-collection" id="toc-data-collection" class="nav-link" data-scroll-target="#data-collection">Data Collection</a></li>
  <li><a href="#model-implementation-analysis" id="toc-model-implementation-analysis" class="nav-link" data-scroll-target="#model-implementation-analysis">Model Implementation &amp; Analysis</a></li>
  </ul></li>
  <li><a href="#results-and-discussion" id="toc-results-and-discussion" class="nav-link" data-scroll-target="#results-and-discussion">Results and Discussion</a></li>
  <li><a href="#supplementary-information" id="toc-supplementary-information" class="nav-link" data-scroll-target="#supplementary-information">Supplementary information</a></li>
  <li><a href="#acknowledgments" id="toc-acknowledgments" class="nav-link" data-scroll-target="#acknowledgments">Acknowledgments</a></li>
  <li><a href="#declarations" id="toc-declarations" class="nav-link" data-scroll-target="#declarations">Declarations</a></li>
  <li><a href="#appendix" id="toc-appendix" class="nav-link" data-scroll-target="#appendix">Appendix</a>
  <ul class="collapse">
  <li><a href="#bias-values-for-area-level-data" id="toc-bias-values-for-area-level-data" class="nav-link" data-scroll-target="#bias-values-for-area-level-data">Bias values for Area-level Data</a></li>
  <li><a href="#model-comparison-for-area-level-data" id="toc-model-comparison-for-area-level-data" class="nav-link" data-scroll-target="#model-comparison-for-area-level-data">Model Comparison for area-level data</a></li>
  <li><a href="#example-of-beta-values-in-gwr-model" id="toc-example-of-beta-values-in-gwr-model" class="nav-link" data-scroll-target="#example-of-beta-values-in-gwr-model">Example of beta-values in GWR model</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content quarto-banner-title-block" id="quarto-document-content">      

       <div class="cell-container"><div class="cell-decorator"><pre>In [1]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Linking to GEOS 3.11.0, GDAL 3.5.3, PROJ 9.1.0; sf_use_s2() is TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'kableExtra'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    group_rows</code></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(spdep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: spData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>To access larger datasets in this package, install the spDataLarge
package with: `install.packages('spDataLarge',
repos='https://nowosad.github.io/drat/', type='source')`</code></pre>
</div>
</div></div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Real estate valuation represents a complex challenge, requiring a nuanced understanding of spatial dynamics and interdependencies within property markets. Traditional valuation methods often overlook these spatial dimensions, resulting in incomplete predictions and less effective policy interventions (<span class="citation" data-cites="pagourtzi2003real">Pagourtzi et al. (<a href="#ref-pagourtzi2003real" role="doc-biblioref">2003</a>)</span>, <span class="citation" data-cites="droj2024comprehensive">Droj, Kwartnik-Pruc, and Droj (<a href="#ref-droj2024comprehensive" role="doc-biblioref">2024</a>)</span>, <span class="citation" data-cites="mccord2014understanding">McCord et al. (<a href="#ref-mccord2014understanding" role="doc-biblioref">2014</a>)</span>). In response, spatial regression models have emerged as powerful tools to address these shortcomings by explicitly incorporating spatial relationships into the analysis of property prices (<span class="citation" data-cites="stewart2018localized">Stewart Fotheringham and Park (<a href="#ref-stewart2018localized" role="doc-biblioref">2018</a>)</span>, <span class="citation" data-cites="yang2019does">Yang et al. (<a href="#ref-yang2019does" role="doc-biblioref">2019</a>)</span>, <span class="citation" data-cites="soltani2021housing">Soltani et al. (<a href="#ref-soltani2021housing" role="doc-biblioref">2021</a>)</span>).</p>
<p>Among the various spatial regression models, Geographically Weighted Regression (GWR) is particularly prominent in property price research. Known for its capacity to capture local variations in property prices, GWR addresses spatial heterogeneity by allowing coefficients to vary across different locations. Significant studies, such as those by <span class="citation" data-cites="sisman2022modelling">Sisman and Aydinoglu (<a href="#ref-sisman2022modelling" role="doc-biblioref">2022</a>)</span>, <span class="citation" data-cites="soltani2021housing">Soltani et al. (<a href="#ref-soltani2021housing" role="doc-biblioref">2021</a>)</span>, <span class="citation" data-cites="brunsdon1996geographically">Brunsdon, Fotheringham, and Charlton (<a href="#ref-brunsdon1996geographically" role="doc-biblioref">1996</a>)</span>, <span class="citation" data-cites="yu2007modeling">Yu (<a href="#ref-yu2007modeling" role="doc-biblioref">2007</a>)</span>, and <span class="citation" data-cites="lu2011geographically">Lu, Charlton, and Fotheringham (<a href="#ref-lu2011geographically" role="doc-biblioref">2011</a>)</span>, have highlighted its effectiveness in revealing spatially varying relationships between property values and various explanatory factors, including structural and neighbourhood characteristics, locational attributes, and socio-economic variables.</p>
<p>Spatial Autoregressive (SAR) models account for spatial dependence in the dependent variable by including a spatial lag parameter (<span class="math inline">\(\rho\)</span>), which measures the influence of neighboring values. This makes SAR well-suited for data where values are directly impacted by nearby areas or points, such as house prices influenced by surrounding properties. However, SAR relies on a global spatial structure, which can limit its ability to capture localised patterns. Additionally, according to <span class="citation" data-cites="golgher2016interpret">Golgher and Voss (<a href="#ref-golgher2016interpret" role="doc-biblioref">2016</a>)</span> and <span class="citation" data-cites="LeSage2014">LeSage and Pace (<a href="#ref-LeSage2014" role="doc-biblioref">2014</a>)</span> the interdependence created by the spatial lag term introduces feedback effects, where values influence each other in a looping manner, making the interpretation of coefficients more complex.</p>
<p>Conditional autoregressive (CAR) models, in contrast, are designed to handle more localised spatial dependencies effectively, compare to SAR. They assume values at a location are conditionally dependent on neighboring areas, defined through an adjacency matrix <span class="math inline">\(\mathbf{W}\)</span>. This approach models spatial dependence via a spatial random effect, <span class="math inline">\(\phi\)</span>, which captures the influence of neighboring areas on the value at a specific location (<span class="citation" data-cites="banerjee2014hierarchical">Banerjee, Carlin, and Gelfand (<a href="#ref-banerjee2014hierarchical" role="doc-biblioref">2014</a>)</span>). CAR models are particularly suited for areal data, such as aggregated district-level statistics, where spatial autocorrelation is prominent. Unlike GWR, CAR does not require exact point coordinates and provides better handling of spatial heterogeneity than SAR. Its ability to model finer localised effects through <span class="math inline">\(\phi\)</span> makes CAR a preferred choice for applications like district-level property price analysis, public health studies, or crime mapping (<span class="citation" data-cites="de2012bayesian">De Oliveira (<a href="#ref-de2012bayesian" role="doc-biblioref">2012</a>)</span>).</p>
<p>This study is motivated by the need to address the spatial intricacies that characterise real estate markets. Properties located near each other often share similar price trends, influenced by common amenities, and neighbourhood attributes. Incorporating spatial dependencies into property valuation allows spatial regression models to provide a deeper insight into market dynamics than traditional methods. It explores the theoretical basis, methodological structures, and practical uses of the GWR, SAR, and CAR models within house price modelling. Through a comparative analysis of these models, we aim to clarify their respective advantages, limitations, and appropriateness for enhancing the accuracy and detail of property market assessments, with a particular focus on the distinct context of Lombok, Indonesia.</p>
<p>The paper begins with a literature review on spatial regression techniques for modeling property prices. Section 3 outlines the theoretical foundations of spatial autoregressive models, including GLM, GWR, SAR, CAR, and their multilevel variants. Section 4 provides a comparative analysis of these models across three artificial study regions, evaluating their predictive accuracy and robustness. Section 5 applies these models to Lombok house price data, demonstrating their efficacy in capturing spatial patterns and improving real estate market insights.</p>
</section>
<section id="related-works" class="level1">
<h1>Related works</h1>
<p>Recent studies have leveraged GWR to investigate the spatial heterogeneity of housing market determinants. For example, <span class="citation" data-cites="wang2020geographically">C.-H. Wang and Chen (<a href="#ref-wang2020geographically" role="doc-biblioref">2020</a>)</span> applied GWR to examine the impact of local built-environment factors on home prices across different phases of the housing market cycle. Their findings highlighted significant spatial variations, underscoring the critical role of local context in influencing home prices. Similarly, <span class="citation" data-cites="lu2011geographically">Lu, Charlton, and Fotheringham (<a href="#ref-lu2011geographically" role="doc-biblioref">2011</a>)</span> employed GWR with a non-Euclidean distance metric to analyze London house price data. By incorporating this alternative metric, they better captured the spatially varying relationships between house prices and their determinants, emphasizing the importance of considering different distance metrics in spatial analyses. In their 2018 study, <span class="citation" data-cites="stewart2018localized">Stewart Fotheringham and Park (<a href="#ref-stewart2018localized" role="doc-biblioref">2018</a>)</span> explored spatial and temporal variations in the determinants of apartment prices in Seoul, South Korea, over a decade. Utilizing a hedonic price model with a spatio-temporal lag, calibrated through GWR, they revealed consistent spatial variations and strong spatial lag effects on house prices over time. Additionally, <span class="citation" data-cites="cellmer2020spatial">Cellmer, Cichulska, and Bełej (<a href="#ref-cellmer2020spatial" role="doc-biblioref">2020</a>)</span> applied GWR to assess the spatial variations in determinants of the housing market in Poland. The study identified spatial patterns of autocorrelation in average housing prices and market activity, illustrating the value of GWR in examining localized effects of socio-demographic and environmental factors on the housing market. Collectively, these studies demonstrate the efficacy of GWR and its extensions in capturing the nuanced spatial and temporal variations in housing market data, providing valuable insights for urban planning and policy-making.</p>
<p>In parallel, numerous studies have demonstrated the versatility and applicability of SAR models across various fields. For instance, <span class="citation" data-cites="fix2021simultaneous">Fix, Cooley, and Thibaud (<a href="#ref-fix2021simultaneous" role="doc-biblioref">2021</a>)</span> explored the use of SAR models for analyzing spatial extremes, highlighting their ability to capture spatial dependence structures in extreme values. <span class="citation" data-cites="sarlas2015localized">Sarlas and Axhausen (<a href="#ref-sarlas2015localized" role="doc-biblioref">2015</a>)</span> showcased the effectiveness of SAR models in transportation research by predicting localized speed variations, illustrating their utility in improving traffic flow predictions. <span class="citation" data-cites="begueria2009comparison">Beguería and Pueyo (<a href="#ref-begueria2009comparison" role="doc-biblioref">2009</a>)</span> emphasized the advantages of SAR models in addressing spatial autocorrelation by comparing them with generalized least squares models, providing more accurate predictions in ecological and biogeographical studies.</p>
<p>In the realm of real estate, SAR models have been particularly valuable. <span class="citation" data-cites="trojanek2018spatial">Trojanek and Gluszak (<a href="#ref-trojanek2018spatial" role="doc-biblioref">2018</a>)</span> used SAR models to analyze the spatial and temporal effects of subway availability on property prices in Warsaw. Their study revealed significant price premiums for properties located near subway stations, underscoring the importance of transportation infrastructure on real estate values. <span class="citation" data-cites="bottero2017buildings">Bottero et al. (<a href="#ref-bottero2017buildings" role="doc-biblioref">2017</a>)</span> applied SAR models to investigate the relationship between buildings’ energy performance and real estate market value. Their findings illustrated the model’s utility in linking environmental attributes to economic outcomes in the property market. Furthermore, <span class="citation" data-cites="cellmer2019application">Cellmer, Kobylińska, and Bełej (<a href="#ref-cellmer2019application" role="doc-biblioref">2019</a>)</span> demonstrated the practical relevance of SAR models in urban planning and property valuation by employing hierarchical SAR models to develop detailed land value maps in urban areas, underscoring the model’s effectiveness in capturing the complexities of urban land valuation.</p>
<p>Despite their limited use in property price modelling, CAR models offer a promising approach for addressing spatial autocorrelation and generating reliable estimates, making them well-suited for future studies in house price analysis. <span class="citation" data-cites="lee2013carbayes">Lee (<a href="#ref-lee2013carbayes" role="doc-biblioref">2013</a>)</span> introduced the R package CARBayes, which supports Bayesian spatial modelling using conditional autoregressive priors. By including house price data as a case study, Lee demonstrated the flexibility of CAR models in capturing localised spatial dependencies relevant to real estate valuation. <span class="citation" data-cites="wall2004close">Wall (<a href="#ref-wall2004close" role="doc-biblioref">2004</a>)</span> provided a comparative analysis of the spatial structures in CAR and SAR models, highlighting CAR’s strength in handling localised spatial interactions through an adjacency-based framework. While their work focused on educational and environmental applications, the insights are directly applicable to real estate modelling. Similarly, <span class="citation" data-cites="ver2018spatial">Ver Hoef et al. (<a href="#ref-ver2018spatial" role="doc-biblioref">2018</a>)</span> examined CAR models in ecological studies, emphasizing their robustness in managing spatial heterogeneity and clarifying their structural differences from SAR models. By addressing the limitations of SAR’s global spatial framework and excelling in the detection of localised patterns, CAR models emerge as a robust and adaptable methodology for accurately modelling spatial dynamics in property prices, advancing the precision of real estate valuation techniques.</p>
</section>
<section id="study-region" class="level1">
<h1>Study region</h1>
<p>In the spatial modelling, the study region <span class="math inline">\(\mathcal{S}\)</span> is typically divided into <span class="math inline">\(K\)</span> distinct non-overlapping geographic units, denoted as <span class="math inline">\(\mathcal{S}_k\)</span> for <span class="math inline">\(k = 1, 2, \dots, K\)</span>. Each geographic unit <span class="math inline">\(\mathcal{S}_k\)</span> is associated with a target variable <span class="math inline">\(y_k\)</span> and a set of explanatory factors represented as a vector <span class="math inline">\(\mathbf{x}_k\)</span>.</p>
<p>In this study, the artificial study region was constructed to facilitate model simulations and analysis. This synthetic region serves as a spatial representation. The dataset consists of a simple feature (<code>sf</code>) collection. It spans a bounding box from longitude 116.0355 to 116.5 and latitude -8.500079 to -8.000057, using the WGS 84 coordinate reference system (CRS). The geometry type is polygon, indicating that each feature is a polygonal area, with 216 polygons in total. Each polygon is defined by two attributes: <code>area</code>, representing the size in square units, and <code>geometry</code>, specifying the polygon’s boundaries with longitude and latitude coordinates. The artificial study region is illustrated in <a href="#fig-artfreg" class="quarto-xref">Figure&nbsp;1</a>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [2]:</pre></div><div id="cell-fig-artfreg" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/artfcountry_plot.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-artfreg" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-artfreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/artfcountry_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-1" data-gallery="quarto-lightbox-gallery-1"><img src="figures/artfcountry_plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-artfreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;1: Artificial study region used for simulation analysis, consisting of 216 non-overlapping polygonal areas. Each area represents a distinct spatial unit for modelling and analysis, providing a controlled environment to evaluate spatial models’ performance
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>Another specific ingredient in spatial modelling is the existence of <span class="math inline">\(W\)</span> matrix, also known as the spatial weights matrix. It encodes the spatial relationships between areas in a study region. The weight matrix visually shows how different regions are connected to each other, indicating their neighbourhood relationships (<span class="citation" data-cites="morris2019bayesian">Morris et al. (<a href="#ref-morris2019bayesian" role="doc-biblioref">2019</a>)</span>). To demonstrate this concept, let’s take a simple example of a map with 5 regions <span class="math inline">\((A, B, C, D, E)\)</span>, as visualised in <a href="#fig-neighsimple" class="quarto-xref">Figure&nbsp;2</a>.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [3]:</pre></div><div id="cell-fig-neighsimple" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/sartf_plot.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-neighsimple" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-neighsimple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/sartf_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-2" data-gallery="quarto-lightbox-gallery-2"><img src="figures/sartf_plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-neighsimple-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;2: Illustration of neighbourhood structure. The figure depicts a simplified spatial configuration where each numbered area represents a distinct spatial unit, demonstrating how neighbouring relationships can be defined for spatial modelling purposes.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>From the <a href="#fig-neighsimple" class="quarto-xref">Figure&nbsp;2</a> we can derive an adjacency matrix which represents the neighborhood structure of five spatial units labeled <span class="math inline">\(A\)</span> to <span class="math inline">\(E\)</span>. Each entry 1 indicates a direct adjacency (areas share a common border), while 0 denotes no direct connection. For example, Area <span class="math inline">\(A\)</span> is adjacent to all other areas (<span class="math inline">\(B\)</span>, <span class="math inline">\(C\)</span>, <span class="math inline">\(D\)</span>, and <span class="math inline">\(E\)</span>), whereas Area <span class="math inline">\(B\)</span> is only adjacent to <span class="math inline">\(A\)</span> and <span class="math inline">\(C\)</span>. This neighbourhood configuration captures a clear spatial interaction pattern among the areas, which forms the basis for constructing a spatial weight matrix, commonly denoted as the <span class="math inline">\(\mathbf{W}\)</span> matrix</p>
<p><span class="math display">\[
\mathbf{W} =
\begin{array}{cccccc}
   &amp; A &amp; B &amp; C &amp; D &amp; E \\
A &amp; 0 &amp; 1 &amp; 1 &amp; 1 &amp; 1\\
B &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 0\\
C &amp; 1 &amp; 1 &amp; 0 &amp; 1 &amp; 0\\
D &amp; 1 &amp; 0 &amp; 1 &amp; 0 &amp; 1\\
E &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0\\
\end{array}
\hspace{2.5cm}
\mathbf{D} =
\begin{array}{cccccc}
   &amp; A &amp; B &amp; C &amp; D &amp; E \\
A &amp; 4 &amp; 0 &amp; 0 &amp; 0 &amp; 0\\
B &amp; 0 &amp; 2 &amp; 0 &amp; 0 &amp; 0\\
C &amp; 0 &amp; 0 &amp; 3 &amp; 0 &amp; 0\\
D &amp; 0 &amp; 0 &amp; 0 &amp; 3 &amp; 0\\
E &amp; 0 &amp; 0 &amp; 0 &amp; 0 &amp; 2\\
\end{array}
\]</span></p>
<p>Later on, in the modelling stage, we will also need to construct a diagonal matrix <span class="math inline">\(\boldsymbol{D}\)</span>. It is an <span class="math inline">\(N \times N\)</span> matrix where each diagonal element <span class="math inline">\(d_{ii}\)</span> denotes the number of neighbours of region. while all non-diagonal elements are zero. This matrix is essential in spatial econometric models because it captures the local neighbourhood structure of each region. In the context of Geographically Weighted Regression (GWR), Spatial Autoregressive (SAR), and Conditional Autoregressive (CAR) models, <span class="math inline">\(\boldsymbol{D}\)</span> plays a pivotal role in defining spatial relationships and dependencies among different regions.</p>
<p>For instance, in SAR and CAR models, the diagonal matrix <span class="math inline">\(\boldsymbol{D}\)</span> aids in incorporating spatial lag and error components by appropriately weighting the influence of neighbouring regions (<span class="citation" data-cites="wall2004close">Wall (<a href="#ref-wall2004close" role="doc-biblioref">2004</a>)</span>, <span class="citation" data-cites="ver2018spatial">Ver Hoef et al. (<a href="#ref-ver2018spatial" role="doc-biblioref">2018</a>)</span>). In GWR, this matrix assists in locally calibrating the model by reflecting the density and connectivity of regions (<span class="citation" data-cites="brunsdon1996geographically">Brunsdon, Fotheringham, and Charlton (<a href="#ref-brunsdon1996geographically" role="doc-biblioref">1996</a>)</span>, <span class="citation" data-cites="stewart2018localized">Stewart Fotheringham and Park (<a href="#ref-stewart2018localized" role="doc-biblioref">2018</a>)</span>). In this case, <span class="math inline">\(\mathbf{D}\)</span> indicates that region <span class="math inline">\(A\)</span> has 4 neighbours, regions <span class="math inline">\(C\)</span> and <span class="math inline">\(D\)</span> each have 3 neighbours, and region <span class="math inline">\(B\)</span> and <span class="math inline">\(E\)</span> has 2 neighbours.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [4]:</pre></div><div id="cell-fig-neighartfreg" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/nb_artfcountry.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-neighartfreg" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-neighartfreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/nb_artfcountry.png" class="lightbox" data-glightbox="description: .lightbox-desc-3" data-gallery="quarto-lightbox-gallery-3"><img src="figures/nb_artfcountry.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:60.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-neighartfreg-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3: Neighbourhood structure of the artificial region. This figure illustrates the spatial connectivity between polygons in the artificial study region, where each line represents a defined neighbour relationship based on spatial adjacency
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>In relation to our artificial study region, <a href="#fig-neighartfreg" class="quarto-xref">Figure&nbsp;3</a> illustrates the connections between areas, represented by vertices or centroids for each area and nodes connecting them to each other. This visualisation highlights the spatial adjacency structure within the region.</p>
</section>
<section id="spatial-regression-model" class="level1">
<h1>Spatial regression model</h1>
<p>When discussing spatial regression, it’s crucial to comprehend the basic notion of linear regression. In classical linear regression, the relationship between the dependent variable <span class="math inline">\(y\)</span> and the <span class="math inline">\(x_1,x_2, \dots, x_p\)</span> independent variables is expressed as</p>
<p><span id="eq-basicreg"><span class="math display">\[
y = \beta_0 + \beta_1x_1 + \dots + \beta_p x_p + \varepsilon
\tag{1}\]</span></span></p>
<p>This formulation assumes a global relationship between the variables, where the coefficients <span class="math inline">\(\beta_1,\beta_2, \dots, \beta_p\)</span> are constant across the entire study area. In many spatial datasets, relationships between variables may exhibit spatial variation. For example, in the case of property pricing, a consistent rates of change assumption may not hold true universally. For example, the house price increase for an extra bedroom is often thought to be fixed across all locations. However, local customs or knowledge may actually dictate these rates, rather than a universal utility assigned to each commodity. For instance, in neighbourhoods with families, where extra space is highly valued, the perceived value of an additional bedroom may be greater compared to areas with singles or elderly couples, for whom extra space may not be as desirable.</p>
<section id="geographically-weighted-regression-gwr" class="level2">
<h2 class="anchored" data-anchor-id="geographically-weighted-regression-gwr">Geographically Weighted Regression (GWR)</h2>
<p><span class="citation" data-cites="brunsdon1996geographically">Brunsdon, Fotheringham, and Charlton (<a href="#ref-brunsdon1996geographically" role="doc-biblioref">1996</a>)</span> developed GWR which is one such technique that extends classical linear regression by allowing coefficients to vary spatially. It allows for the estimation of local relationships between a response variable and predictor variables. It is particularly useful for exploring spatial non-stationarity and identifying spatially varying relationships across different locations. The GWR model can be expressed as:</p>
<p><span id="eq-gwr"><span class="math display">\[
y_i(s) = \beta_{0}(s) + \sum_{k=1}^p \beta_k(s)x_{ik}(s) + \varepsilon(s), \\ i = 1,\dots, n
\tag{2}\]</span></span></p>
<p><a href="#eq-gwr" class="quarto-xref">Equation&nbsp;2</a> represents a spatial regression model where <span class="math inline">\(\mathbf{y}(s)\)</span> is the dependent variable at location <span class="math inline">\(s\)</span>. The term <span class="math inline">\(\beta_{0}(s)\)</span> is the spatially varying intercept, while <span class="math inline">\(\sum_{k=1}^p \beta_k(s)\mathbf{x_k}(s)\)</span> represents the spatially varying coefficients for the independent variables <span class="math inline">\(\mathbf{x_k}(s)\)</span>. <span class="math inline">\(\varepsilon(s)\)</span> denotes the error term, capturing unexplained variation at location <span class="math inline">\(s\)</span></p>
<p>Using a weighted least squares approach to calibrate regression models allows different weights to be assigned to different observations, influencing the estimated parameters. In ordinary least squares, the goal is to minimize the sum of squared differences between predicted and actual <span class="math inline">\(y\)</span> values. Weighted least squares, however, apply a weighting factor <span class="math inline">\(w\)</span> to each squared difference, making some prediction inaccuracies more significant. If <span class="math inline">\(w\)</span> is a diagonal matrix of weights, the estimated coefficients are given by <a href="#eq-betagwr" class="quarto-xref">Equation&nbsp;3</a>:</p>
<p><span id="eq-betagwr"><span class="math display">\[
\beta(s) = (\boldsymbol{x}^T \boldsymbol{W}(s) \boldsymbol{x})^{-1} \boldsymbol{x}^T \boldsymbol{W}(s) \boldsymbol{y}
\tag{3}\]</span></span></p>
<p>This method allows GWR to address spatial heterogeneity by emphasizing observations near the location of interest, thereby improving the accuracy and relevance of local model estimates.</p>
<p>The estimation of GWR parameters involves fitting a separate regression equation for each location in the study area. Various estimation techniques can be employed, including ordinary least squares (OLS), weighted least squares (WLS), and maximum likelihood estimation (MLE). These techniques aim to optimize the model parameters to minimize the differences between the observed and predicted values of the dependent variable.</p>
</section>
<section id="simultaneously-autoregressive-sar-models" class="level2">
<h2 class="anchored" data-anchor-id="simultaneously-autoregressive-sar-models">Simultaneously Autoregressive (SAR) Models</h2>
<p>While GWR focuses on capturing localised spatial heterogeneity by allowing coefficients to vary across space, SAR take a different approach by explicitly modelling spatial dependencies through a spatial lag. The SAR model is a spatial econometric model used to analyse spatial dependencies and relationships among observations in a geographic space (<span class="citation" data-cites="anselin1988spatial">Anselin and Griffith (<a href="#ref-anselin1988spatial" role="doc-biblioref">1988</a>)</span>). It is widely employed in various fields, such as regional economics, environmental studies, and urban planning. SAR is a type of spatial autoregressive model involving a simultaneous equation framework to capture spatial interactions.</p>
<p>The general form of SAR model can be expressed as follows</p>
<p><span id="eq-sar"><span class="math display">\[
y(s) = \rho \sum_{s'} w(s,s') y(s') + \sum_{k=1}^p \beta_k x_k(s) + \varepsilon(s)
\tag{4}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{Y}\)</span> is the vector of observed values for the dependent variable, <span class="math inline">\(W\)</span> is the spatial weights matrix, <span class="math inline">\(\rho\)</span> is the spatial autoregressive coefficient, <span class="math inline">\(X\)</span> is the matrix of observed values for exogenous variables, <span class="math inline">\(\beta\)</span> is the vector of coefficients, and <span class="math inline">\(\boldsymbol{\varepsilon} \sim N(0,\sigma^2)\)</span> is the vector of error terms. Estimation of the SAR model parameters is typically done using statistical techniques such as maximum likelihood estimation (MLE) or generalised method of moments (GMM). The joint distribution of <span class="math inline">\(\mathbf{Y}\)</span> can be written as</p>
<p><span id="eq-jointysar"><span class="math display">\[
\mathbf{Y} \sim \mathcal{N}\left( \left( I - \rho W \right)^{-1} X\beta, \, \sigma^2 \left( I - \rho W \right)^{-1} \left( I - \rho W^T \right)^{-1} \right)
\tag{5}\]</span></span></p>
<p>Extensions of the SAR model include the Spatial Lag Model, the Spatial Error Model, and the Spatial Durbin Model (<span class="citation" data-cites="elhorst2014spatial">Elhorst et al. (<a href="#ref-elhorst2014spatial" role="doc-biblioref">2014</a>)</span>), each incorporating distinct assumptions regarding the spatial configuration of the errors (<span class="citation" data-cites="elhorst2012model">Elhorst, Lacombe, and Piras (<a href="#ref-elhorst2012model" role="doc-biblioref">2012</a>)</span>; <span class="citation" data-cites="anselin2013spatial">Anselin (<a href="#ref-anselin2013spatial" role="doc-biblioref">2013</a>)</span>). These extensions provide flexibility to account for different types of spatial dependencies and can be chosen based on the specific spatial relationships and hypotheses under investigation.</p>
<p>The SAR model, with its various specifications, provides a flexible framework to account for spatial dependencies and explore the spatial dynamics of observed phenomena. Researchers often choose between these models based on the nature of the spatial relationships in their data and the specific hypotheses they aim to test. The SAR model is a valuable tool for understanding spatial interdependence and making informed policy and planning decisions in diverse spatial contexts</p>
</section>
<section id="conditional-autoregressive-car-models" class="level2">
<h2 class="anchored" data-anchor-id="conditional-autoregressive-car-models">Conditional Autoregressive (CAR) Models</h2>
<p>CAR models are a class of spatial statistical models used to analyze spatially structured data. The general formulation of a CAR model can be expressed as:</p>
<p><span id="eq-car"><span class="math display">\[
y(s) = \sum_{k=1}^p \beta_k x_k(s) + \varepsilon(s) + \phi(s)
\tag{6}\]</span></span></p>
<p>Here, <span class="math inline">\(\boldsymbol{\varepsilon} \sim N(0, \sigma_{\varepsilon}^2)\)</span> while <span class="math inline">\(\boldsymbol{\phi}\)</span> is a specific component in CAR model that has a role as spatial effect. It is also common to mention <span class="math inline">\(\boldsymbol{\phi}\)</span> as a CAR priors. It is a type of Gaussian Markov random field (<span class="citation" data-cites="rue2005gaussian">Rue and Held (<a href="#ref-rue2005gaussian" role="doc-biblioref">2005</a>)</span>), capture spatial autocorrelation by ensuring that values at nearby locations are more similar than those further apart (<span class="citation" data-cites="lee2013carbayes">Lee (<a href="#ref-lee2013carbayes" role="doc-biblioref">2013</a>)</span>). This can be expressed in a general term</p>
<p><span id="eq-phidist"><span class="math display">\[
\boldsymbol{\phi}\sim N(0,\sigma_{\phi}^2\boldsymbol{Q}^{-1})
\tag{7}\]</span></span></p>
<p>where <span class="math inline">\(\boldsymbol{Q}\)</span> is a precision matrix that may be singular (intrinsic model). <span class="math inline">\(\boldsymbol{Q}\)</span> controls the spatial autocorrelation structure of the random effects, and is based on a non-negative symmetric <span class="math inline">\(n \times n\)</span> neighbourhood or weight matrix <span class="math inline">\(\boldsymbol{W}\)</span>.</p>
<p>Together with the spatial weights matrix <span class="math inline">\(\boldsymbol{W}\)</span>, the prior information are crucial components of CAR models. The choice of <span class="math inline">\(\boldsymbol{W}\)</span> determines the spatial structure of the model, while the priors for the variance parameters and the spatial random effects influence the model’s ability to capture spatial dependencies. Commonly used priors for the variance parameters include inverse-gamma distributions, which provide flexibility and can be tuned to reflect prior beliefs about the scale of variability in the data. The prevailing approach typically involves a binary representation using geographical adjacency, where <span class="math inline">\(w_{ki} = 1\)</span> if areal units <span class="math inline">\((S_k,S_i)\)</span> have a mutual boundary (denoted <span class="math inline">\(k\sim i\)</span>, and is zero otherwise). This specification forces <span class="math inline">\((\phi_k,\phi_i)\)</span> relating to geographically adjacent areas (that is <span class="math inline">\(w_{ki} = 1\)</span>) to be correlated. On the other hand, random effects associated with areas that are not adjacent are independent of each other, provided we know the values of the other random effects.</p>
<p>A CAR prior was introduced by <span class="citation" data-cites="leroux2000estimation">Leroux, Lei, and Breslow (<a href="#ref-leroux2000estimation" role="doc-biblioref">2000</a>)</span> and <span class="citation" data-cites="stern1999inference">Stern and Cressie (<a href="#ref-stern1999inference" role="doc-biblioref">1999</a>)</span> to model diverse levels of spatial autocorrelation. In this type of prior, a single collection of random effects is utilised and its primary objective is to model spatial data, with a specific focus on dealing with spatial relationships and auto-correlation between data points. This model is especially proficient in the task of smoothing data and detecting spatial patterns within data set. The random effect <span class="math inline">\(\boldsymbol\phi_k\)</span> structured as follow:</p>
<p><span id="eq-phicar"><span class="math display">\[
\phi_k|\boldsymbol{\phi}_{-k}, \mathbf{W},\rho, \sigma_{\phi}^2  \sim  N\left(\frac{\rho\sum_{i=1}^Kw_{ki}\phi_i}{A},\frac{\sigma_{\phi}^2}{A}\right)
\tag{8}\]</span></span></p>
<p>where <span class="math inline">\(A = \rho\sum_{i=1}^Kw_{ki}+1-\rho\)</span>. Note that when <span class="math inline">\(\rho = 1\)</span>, the prior forms an intrinsic CAR prior <span class="citation" data-cites="besag1991bayesian">(<a href="#ref-besag1991bayesian" role="doc-biblioref">Besag, York, and Mollié 1991</a>)</span>, indicating full spatial dependency. Conversely, when <span class="math inline">\(\rho = 0\)</span>, <span class="math inline">\(A = 1\)</span> it means that there will be no <span class="math inline">\(W\)</span> matrix role in the model, and it will become a comman random effect. In other words, the model reduces to a generalised linear model.</p>
<p>When handling <span class="math inline">\(i\)</span> observations within each area <span class="math inline">\(k\)</span>, <a href="#eq-ycar" class="quarto-xref">Equation&nbsp;9</a> closely resembles <a href="#eq-gwr" class="quarto-xref">Equation&nbsp;2</a> in the GWR model, with the exception of the <span class="math inline">\(\phi\)</span> component. It is usually called multilevel CAR models</p>
<p><span id="eq-ycar"><span class="math display">\[
y_i(s) = \sum_{k=1}^p \beta_k x_{ki}(s) + \varepsilon_i(s) + \phi(s)
\tag{9}\]</span></span></p>
<p>The Bayesian approach to CAR models entails defining prior distributions for all model parameters, such as the regression coefficients <span class="math inline">\(\beta\)</span>, variance parameters <span class="math inline">\(\sigma_{\varepsilon}^2\)</span> and <span class="math inline">\(\sigma_{\phi}^2\)</span>, and spatial random effects <span class="math inline">\(\phi_k\)</span>. Subsequently, Bayesian inference techniques like Markov Chain Monte Carlo (MCMC) are employed to derive posterior distributions of these parameters. This method facilitates the integration of prior knowledge and offers a versatile framework for quantifying uncertainty.</p>
<p>In general, <a href="#tbl-summarymethod" class="quarto-xref">Table&nbsp;1</a> below summarises the key elements utilised in the GWR, SAR, and CAR models:</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [5]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [6]:</pre></div><div><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add estimation method for each model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">Elements =</span> <span class="fu">c</span>(</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Number of Observations ($N$)"</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Covariate Matrix ($X$)"</span>, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Spatial Weights Matrix ($W$)"</span>, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Spatial Coordinates (coords)"</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Covariate Coefficients ($</span><span class="sc">\\</span><span class="st">beta$)"</span>, </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Spatial Autocorrelation ($</span><span class="sc">\\</span><span class="st">rho$)"</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Spatial Structure component ($</span><span class="sc">\\</span><span class="st">phi$)"</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Spatial structure variance ($</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">phi}^2$)"</span>, </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Error Term variance ($</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">varepsilon}^2$)"</span>,</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>      <span class="st">"Estimation method"</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    ),</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    <span class="at">GWR =</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"MLE"</span>),</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">SAR =</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">times$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"MLE/GMM"</span>),</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">CAR =</span> <span class="fu">c</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>,  <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"$</span><span class="sc">\\</span><span class="st">checkmark$"</span>, <span class="st">"MCMC"</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Elements"</span>, <span class="st">"$GWR$"</span>, <span class="st">"$SAR$"</span>, <span class="st">"$CAR$"</span>),</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="co"># Needed to render LaTeX math symbols</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">longtable =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-summarymethod" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-summarymethod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;1: Comparison of Model Elements Across GWR, SAR, and CAR
</figcaption>
<div aria-describedby="tbl-summarymethod-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Elements</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">$GWR$</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">$SAR$</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">$CAR$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Number of Observations ($N$)</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="even">
<td style="text-align: left;">Covariate Matrix ($X$)</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spatial Weights Matrix ($W$)</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spatial Coordinates (coords)</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Covariate Coefficients ($\beta$)</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spatial Autocorrelation ($\rho$)</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Spatial Structure component ($\phi$)</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="even">
<td style="text-align: left;">Spatial structure variance ($\sigma_{\phi}^2$)</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\times$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Error Term variance ($\sigma_{\varepsilon}^2$)</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
<td style="text-align: left;">$\checkmark$</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estimation method</td>
<td style="text-align: left;">MLE</td>
<td style="text-align: left;">MLE/GMM</td>
<td style="text-align: left;">MCMC</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
</section>
</section>
<section id="comparative-analysis-of-glm-sar-and-car" class="level1">
<h1>Comparative Analysis of GLM, SAR, and CAR</h1>
<p>This section focuses on generating spatially autocorrelated property price data, exploring two distinct data generation frameworks: one using a CAR specification and another without spatial autocorrelation (non-CAR). The analysis is conducted within an artificially constructed study area using key property covariates: land size, building size, number of bedrooms, and number of bathrooms. The generated datasets are then employed to examine spatial dependencies in property prices and are analysed using a suite of models including GLM, SAR, and CAR.</p>
<section id="the-experiment-design" class="level2">
<h2 class="anchored" data-anchor-id="the-experiment-design">The experiment design</h2>
<p>The experiment begins by creating a dataset based on the defined study region. The idea is to generate covariates that hypothetically can explain price of a property. It basically consist of property structural characteristics such as land size, building size, number of bedrooms, and number of bathrooms. To represent real-world data, each polygon contains multiple observations.</p>
<p>To generate the covariates, the first step involves creating area-level data with a specific spatial pattern, referred to as the housing density for the study region. The spatial pattern implies that certain areas or polygons will have a higher housing density than others. In this case, the central horizontal region of the study area is set to has a higher housing density, mirroring the housing distribution found on the island of Lombok. Although this density will not be directly utilized in the model simulation, it serves as a critical foundation for determining the spatial distribution of observation points across each polygon. In areas with higher density, a greater number of observation points are generated, which aligns with the notion that densely populated regions typically have more residential developments, thereby increasing the number of properties available for sale. Across the 216 polygons, a total of 4,314 observation points were generated. The number of observations per polygon varies from 5 to 56 points, reflecting the density in each area. <a href="#fig-pointsonmap" class="quarto-xref">Figure&nbsp;4</a> illustrate how each polygon has multiple observations and they are distributed according to a specific pattern.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [7]:</pre></div><div id="cell-fig-pointsonmap" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/density_points_plot.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-pointsonmap" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pointsonmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/density_points_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-4" data-gallery="quarto-lightbox-gallery-4"><img src="figures/density_points_plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pointsonmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;4: Artificial study region with observation points. The points represent data locations within each polygon, simulating real-world spatial observations for the purpose of model analysis and validation.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>Following this, covariates were generated using <code>mvrnorm()</code> for each observation point, creating a dataset for further analysis. <a href="#tbl-covrstr" class="quarto-xref">Table&nbsp;2</a> provides a brief slice of the covariates’ structure.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [8]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [9]:</pre></div><div><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Study/R project/article_1/data/gen_dat_v3.rds"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">st_drop_geometry</span>(<span class="cn">NULL</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>geometry) <span class="sc">%&gt;%</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">density =</span> population_density,</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">"#bedrooms"</span> <span class="ot">=</span> bedrooms,</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>         <span class="st">"#bathrooms"</span> <span class="ot">=</span> bathrooms)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify the pattern you want for the IDs</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>desired_pattern <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Count occurrences of each ID in the desired pattern</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>pattern_count <span class="ot">&lt;-</span> <span class="fu">table</span>(desired_pattern)</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a subset based on `desired_pattern` without excessive rows</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>dat_pattern <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(ID <span class="sc">%in%</span> <span class="fu">names</span>(pattern_count)) <span class="sc">%&gt;%</span></span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(ID) <span class="sc">%&gt;%</span></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">&lt;=</span> pattern_count[<span class="fu">as.character</span>(ID)]) <span class="sc">%&gt;%</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>area, <span class="sc">-</span>density) <span class="sc">%&gt;%</span></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.numeric), <span class="sc">~</span> <span class="fu">round</span>(.x, <span class="dv">2</span>)))</span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table in the document</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  dat_pattern,</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-covrstr" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-covrstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;2: Slice of generated dataset as covariates for simulations
</figcaption>
<div aria-describedby="tbl-covrstr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: right;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">land_size</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">building_size</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">#bedrooms</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">#bathrooms</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">270.48</td>
<td style="text-align: right;">108.55</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">295.99</td>
<td style="text-align: right;">100.13</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">319.52</td>
<td style="text-align: right;">126.31</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">325.01</td>
<td style="text-align: right;">120.84</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: right;">294.15</td>
<td style="text-align: right;">144.05</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: right;">222.18</td>
<td style="text-align: right;">81.40</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: right;">4</td>
<td style="text-align: right;">414.23</td>
<td style="text-align: right;">150.15</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">278.75</td>
<td style="text-align: right;">101.41</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
<p>By employing artificially generated covariates and an artificially constructed study region, we developed three distinct property price datasets, each based on a different spatial model: CAR, a combination of CAR and SAR, and GWR. The true parameter values for this purpose are <span class="math inline">\(\boldsymbol{\beta} = \begin{bmatrix} 1 &amp; 0.9 &amp; 0.7 &amp; 0.5 &amp; 0.3 \end{bmatrix}\)</span>, <span class="math inline">\(\sigma_{\phi}^2 = 0.2\)</span>, <span class="math inline">\(\sigma_{\phi}^2 = 0.6\)</span> and <span class="math inline">\(\rho = 0.6\)</span>. Whereas beta values for GWR dataset is generated using a beta function, which is a function of coordinate points. The matrix <span class="math inline">\(\mathbf{W}\)</span> was derived from the neighbourhood structure of an artificial study region using the functions <code>poly2nb()</code> and <code>nb2mat()</code>. Data generation for <span class="math inline">\(SAR + CAR\)</span> employs a slightly different strategy. In addition to being generated per area simultaneously using the joint distribution of <span class="math inline">\(\mathbf{Y}\)</span> as in <a href="#eq-jointysar" class="quarto-xref">Equation&nbsp;5</a>, information about the spatial effect <span class="math inline">\(\boldsymbol{\phi}\)</span> is also added at the end of the process. Therefore, we refer to it as <span class="math inline">\(SAR + CAR\)</span> data.</p>
<p>Each data generation resulting two types of datasets: area-level and point-level. These datasets were then modelled using six linear regression approaches, comprising both classical and spatial regression models: GLM, SAR, and CAR for area-level data, and GWR, GLMM, and multilevel CAR for point-level data. Simulations were conducted <span class="math inline">\(sim = 1000\)</span> times. From each simulation, coefficients, parameters, and fitted values were extracted, allowing for the computation of bias and RMSE values for robustness and prediction power analysis.</p>
</section>
<section id="robustness-and-power-prediction-analysis" class="level2">
<h2 class="anchored" data-anchor-id="robustness-and-power-prediction-analysis">Robustness and power prediction analysis</h2>
<p>The bias values are summarised in <a href="#tbl-bias1" class="quarto-xref">Table&nbsp;6</a> and <a href="#tbl-bias2" class="quarto-xref">Table&nbsp;7</a>. It shows that the models exhibit varying levels of accuracy across the different parameters and datasets. <a href="#fig-biasplot" class="quarto-xref">Figure&nbsp;5</a> presents the bias estimates of regression coefficients for different modelling approaches, separated by data type: (a) area-level data and (b) point-level data. Each panel corresponds to a data-generating mechanism (CAR, GWR, or SAR+CAR), and bias values are shown with 95% confidence intervals.</p>
<div id="fig-biasplot" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-biasplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-biasplot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-biasplot1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-biasplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="figures/bias1_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-5" data-gallery="fig-biasplot"><img src="figures/bias1_plot.png" class="img-fluid figure-img" data-ref-parent="fig-biasplot"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-biasplot1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Bias values by method and dataset type for area-level data
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-biasplot" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-biasplot2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-biasplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="figures/bias2_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-6" data-gallery="fig-biasplot"><img src="figures/bias2_plot.png" class="img-fluid figure-img" data-ref-parent="fig-biasplot"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-biasplot2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Bias values by method and dataset type for point-level data
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-biasplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5: Bias estimates comparison of six different methods across datasets generated under CAR, GWR, and SAR+CAR frameworks. Each method’s performance is visualised for <span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\beta_3\)</span>, and <span class="math inline">\(\beta_4\)</span>, highlighting variations in bias and the effectiveness of each model in addressing spatial dependencies.
</figcaption>
</figure>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [10]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| label: fig-biasplot</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #| fig-cap: "Bias values by method and dataset type for area-level data and also point-level data. This figure compares the bias estimates of different methods (CAR, GLM, SAR, GLMM, GWR, and mlvCAR) across datasets generated under CAR, GWR, and SAR+CAR frameworks. Each method's performance is visualised for four coefficients ($\\beta_1$, $\\beta_2$, $\\beta_3$, $\\beta_4$), highlighting variations in bias and the effectiveness of each model in addressing spatial dependencies."</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #| out-width: "100%"</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #| fig-align: "center"</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># #| layout-ncol: 2</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics("figures/bias1_plot.png", auto_pdf = TRUE)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics("figures/bias2_plot.png", auto_pdf = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p>For area-level data (<a href="#fig-biasplot1" class="quarto-xref">Figure&nbsp;5 (a)</a>), CAR model consistently produces the lowest bias across all coefficients and data-generating scenarios. This confirms its ability to recover true parameter values under spatial dependency, even when data is aggregated. The SAR model displays higher variability and often substantial bias, especially in CAR-generated datasets, suggesting model misspecification when the true structure is localised (as in CAR). GLM, which ignores spatial effects, performs reasonably in some settings but often underperforms compared to CAR.</p>
<p>In the point-level setting (<a href="#fig-biasplot2" class="quarto-xref">Figure&nbsp;5 (b)</a>), the mlvCAR model shows superior performance, achieving minimal bias across all coefficients and data-generating mechanisms. This reflects its strength in modeling spatial dependencies while accounting for multilevel data structure (i.e., multiple observations within areas). GLMM performs moderately well but tends to show slightly higher bias than mlvCAR. In contrast, GWR, despite being designed for point-level spatial variation, yields higher bias, especially under SAR+CAR structures. This suggests GWR’s limitation when spatial heterogeneity is not smooth or when model assumptions are violated.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [11]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [12]:</pre></div><div><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dataset =</span> <span class="fu">c</span>(<span class="st">"$CAR$"</span>, <span class="st">"$SAR + CAR$"</span>, <span class="st">"$GWR$"</span>),</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">GLM     =</span> <span class="fu">c</span>(<span class="fl">4.09</span>, <span class="fl">11.88</span>, <span class="fl">2.43</span>),</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">SAR     =</span> <span class="fu">c</span>(<span class="fl">3.85</span>, <span class="fl">11.68</span>, <span class="fl">2.42</span>),</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAR     =</span> <span class="fu">c</span>(<span class="fl">1.81</span>, <span class="fl">3.88</span>, <span class="fl">2.28</span>),</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">GLMM    =</span> <span class="fu">c</span>(<span class="fl">14.04</span>, <span class="fl">47.67</span>, <span class="fl">18.31</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">GWR     =</span> <span class="fu">c</span>(<span class="fl">21.13</span>, <span class="fl">48.87</span>, <span class="fl">18.33</span>),</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">mlvCAR  =</span> <span class="fu">c</span>(<span class="fl">9.94</span>, <span class="fl">38.97</span>, <span class="fl">14.87</span>)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># GLM     = c(27.05, 76.62, 28.84),</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># SAR     = c(24.79, 75.72, 28.23),</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># CAR     = c(10.49, 27.71, 27.92),</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Render the table with math symbols in headers and custom header groups</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  df,</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Dataset"</span>, <span class="st">"$GLM$"</span>, <span class="st">"$SAR$"</span>, <span class="st">"$CAR$"</span>, <span class="st">"$GLMM$"</span>, <span class="st">"$GWR$"</span>, <span class="st">"$mlvCAR$"</span>), <span class="co"># Custom column names with math symbols</span></span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="co"># Needed to correctly render LaTeX math symbols</span></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">longtable =</span> <span class="cn">TRUE</span></span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Area-level data"</span> <span class="ot">=</span> <span class="dv">3</span>, <span class="st">"Point-level data"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span> <span class="co"># Add grouped headers</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"repeat_header"</span>), <span class="at">font_size =</span> <span class="dv">9</span>) <span class="co"># Repeat headers on new pages if longtable</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-rmse" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-rmse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;3: RMSE values across different datasets
</figcaption>
<div aria-describedby="tbl-rmse-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 14%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="text-align: left; empty-cells: hide; border-bottom: hidden;"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Area-level data
</div></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Point-level data
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Dataset</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$GLM$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$SAR$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$CAR$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$GLMM$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$GWR$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$mlvCAR$</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">$CAR$</td>
<td style="text-align: right;">4.09</td>
<td style="text-align: right;">3.85</td>
<td style="text-align: right;">1.81</td>
<td style="text-align: right;">14.04</td>
<td style="text-align: right;">21.13</td>
<td style="text-align: right;">9.94</td>
</tr>
<tr class="even">
<td style="text-align: left;">$SAR + CAR$</td>
<td style="text-align: right;">11.88</td>
<td style="text-align: right;">11.68</td>
<td style="text-align: right;">3.88</td>
<td style="text-align: right;">47.67</td>
<td style="text-align: right;">48.87</td>
<td style="text-align: right;">38.97</td>
</tr>
<tr class="odd">
<td style="text-align: left;">$GWR$</td>
<td style="text-align: right;">2.43</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">2.28</td>
<td style="text-align: right;">18.31</td>
<td style="text-align: right;">18.33</td>
<td style="text-align: right;">14.87</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
<p>Moreover, <a href="#tbl-rmse" class="quarto-xref">Table&nbsp;3</a> provide insights into model accuracy at different spatial levels. For area-level data, the models GLM, SAR, and CAR are compared, with the CAR model consistently achieving the lowest RMSE. This suggests that CAR is more effective at capturing spatial dependencies at the area level. For point-level data, the models GLMM, GWR, and mlvCAR are evaluated, with mlvCAR showing the lowest RMSE across all datasets. This indicates that mlvCAR is particularly well-suited for handling detailed spatial variations at the point level. Overall, these results highlight the strengths of CAR and mlvCAR in reducing error within their respective spatial contexts, underscoring their potential utility in spatial modeling applications.</p>
</section>
</section>
<section id="applications-in-lombok-house-prices-dataset" class="level1">
<h1>Applications in Lombok house prices dataset</h1>
<p>In this section, we apply the simulated models to property price data on Lombok Island, Indonesia. Lombok is located in the eastern part of Indonesia, specifically between latitudes -8.9° and -8.1°, and longitudes 115.9° and 116.6°.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [13]:</pre></div><div id="cell-fig-lombokmap" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/nb_lop2.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-lombokmap" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-lombokmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/nb_lop2.png" class="lightbox" data-glightbox="description: .lightbox-desc-7" data-gallery="quarto-lightbox-gallery-7"><img src="figures/nb_lop2.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:75.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lombokmap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;6: Lombok neighbour structure at the sub-district (Kecamatan) level. This figure illustrates the spatial neighbour structure of sub-districts on Lombok Island. The red lines represent the connections between neighbouring sub-districts based on adjacency relationships, overlaid on a base map.
</figcaption>
</figure>
</div>
</div>
</div></div>
<p>Lombok comprises five districts (kota/kabupaten), 53 sub-districts (kecamatan), and 608 villages (desa/kelurahan), representing three successive levels of administrative division. Mataram District, despite its small area compared to other districts in Lombok, is the most urbanized and economically active area on the island, characterized by dense residential clusters with relatively homogeneous housing specifications. In adjacent districts such as West Lombok and Central Lombok, housing developments have expanded, particularly to accommodate commuters working in Mataram. The coastal areas of West Lombok, including Batu Layar and Sekotong, exhibit villa-style housing commonly associated with tourism, resulting in generally higher property prices. A similar pattern is found in North Lombok, where mountainous terrain limits development, but tourism-driven demand has led to villa-style housing near popular destinations. East Lombok, by contrast, remains more isolated due to its distance from Mataram. Housing in this district tends to serve primarily the local population, with limited signs of external investment or tourism-driven development. Additionally, the southern part of Central Lombok (Pujut) has seen emerging residential and real estate activity following the construction of the international MotoGP circuit.</p>
<p>In this study, the sub-district level is used as the spatial unit of analysis, as illustrated in <a href="#fig-lombokmap" class="quarto-xref">Figure&nbsp;6</a>. The key variables of interest include property price, land size, built-up area, number of bedrooms, and number of bathrooms.</p>
<section id="data-collection" class="level2">
<h2 class="anchored" data-anchor-id="data-collection">Data Collection</h2>
<!-- The dataset employed in this study comprises property price data from Lombok, Indonesia. The scope of properties analysed includes residential houses and commercial real estate. In addition to data on property prices, the dataset also encompasses various property characteristics including land area, built-up area, and the count of bedrooms and bathrooms. -->
<p>Data were collected from multiple online sources. Property prices and their associated characteristics were harvested using web-scraping techniques from three leading Indonesian property trading platforms, https://www.lamudi.co.id/, https://www.99.co/, and https://www.rumah123.com/. The accuracy of the web-scraped data was ensured by cross-referencing it with official datasets, performing checks for missing or inconsistent entries, and validating key variables through sample comparisons with manually collected data. From this process, the initial dataset comprised 1,188 entries, with 9 variables, including village, prices, land-size, built-up area, number of bedrooms, number of bathrooms, floors, property type/category, and furnishing status.</p>
<p>Further, we conducted several preprocessing steps. First, we filtered the dataset by removing irrelevant variables, including floors, furnishing status, and category. It was then subsequently filtered to retain only properties with plausible characteristics: land area between 90 and 800 square meters, built-up size between 70 and 600 square meters, a maximum of 6 bedrooms, and a maximum 5 bathrooms. These thresholds were applied to ensure the data reflect realistic and context-appropriate housing characteristics in Lombok, based on common residential patterns and local housing norms. This step was essential to enhance the validity of the analysis by excluding outliers or potentially erroneous entries. Following this procedure, the dataset was refined to comprise a total of 576 observations. A summary of the key variables is presented in <a href="#tbl-datasumm" class="quarto-xref">Table&nbsp;4</a>. Notably, the distribution of property prices is skewed and does not exhibit a bell-shaped curve, which motivates the inclusion of a log-transformed price variable in the analysis.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [14]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [15]:</pre></div><div><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/propdata.RData"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">"data/hp_dat_v1.RData"</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>propdata <span class="ot">&lt;-</span> propdata <span class="sc">%&gt;%</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>village, <span class="sc">-</span>floors, <span class="sc">-</span>furnished, <span class="sc">-</span>category) <span class="sc">%&gt;%</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(hp_dat_v1) <span class="sc">%&gt;%</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(land <span class="sc">&gt;=</span> <span class="dv">90</span> <span class="sc">&amp;</span> land <span class="sc">&lt;=</span> <span class="dv">800</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(building <span class="sc">&gt;=</span> <span class="dv">70</span> <span class="sc">&amp;</span> building <span class="sc">&lt;=</span> <span class="dv">600</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(beds <span class="sc">&lt;=</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(baths <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;</span> baths <span class="sc">&lt;=</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">prices =</span> prices <span class="sc">*</span> <span class="dv">1000</span>,</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">logprices =</span> <span class="fu">log</span>(prices)</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> propdata <span class="sc">%&gt;%</span> </span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(prices, logprices, land, building, beds, baths)</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the data frame</span></span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Prices (million IDR)"</span>, <span class="st">"logPrices"</span>, <span class="st">"Land-size (sqm)"</span>, <span class="st">"Built-up area (sqm)"</span>,</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>               <span class="st">"No. of bedroom"</span>, <span class="st">"No. of bathroom"</span>),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">Mean   =</span> <span class="fu">round</span>(<span class="fu">colMeans</span>(dat, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">SD     =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, sd, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">Median =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, median, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q1     =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fl">0.25</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">Q3     =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, quantile, <span class="at">probs =</span> <span class="fl">0.75</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">Min    =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, min, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>),</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">Max    =</span> <span class="fu">round</span>(<span class="fu">apply</span>(dat, <span class="dv">2</span>, max, <span class="at">na.rm =</span> <span class="cn">TRUE</span>), <span class="dv">2</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Display the table with knitr::kable</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(data,</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"Variable"</span>, <span class="st">"Mean"</span>, <span class="st">"SD"</span>, <span class="st">"Median"</span>, <span class="st">"$Q_1$"</span>, <span class="st">"$Q_3$"</span>, <span class="st">"Min"</span>, <span class="st">"Max"</span>),</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">row.names =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">longtable =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-datasumm" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-datasumm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;4: Summary statistics of house prices dataset (<span class="math inline">\(N = 576\)</span>, <code>NA</code> = 4%), including variables such as prices and its logscale value, land area(sqm), building area(sqm), number of beds, and number of baths
</figcaption>
<div aria-describedby="tbl-datasumm-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Variable</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Mean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Median</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$Q_1$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">$Q_3$</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Min</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Max</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Prices (million IDR)</td>
<td style="text-align: right;">1979.20</td>
<td style="text-align: right;">2054.51</td>
<td style="text-align: right;">1400.00</td>
<td style="text-align: right;">800.00</td>
<td style="text-align: right;">2500.00</td>
<td style="text-align: right;">170.00</td>
<td style="text-align: right;">22500.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">logPrices</td>
<td style="text-align: right;">7.26</td>
<td style="text-align: right;">0.80</td>
<td style="text-align: right;">7.24</td>
<td style="text-align: right;">6.68</td>
<td style="text-align: right;">7.82</td>
<td style="text-align: right;">5.14</td>
<td style="text-align: right;">10.02</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Land-size (sqm)</td>
<td style="text-align: right;">299.08</td>
<td style="text-align: right;">179.33</td>
<td style="text-align: right;">254.50</td>
<td style="text-align: right;">147.00</td>
<td style="text-align: right;">405.75</td>
<td style="text-align: right;">90.00</td>
<td style="text-align: right;">800.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Built-up area (sqm)</td>
<td style="text-align: right;">184.46</td>
<td style="text-align: right;">109.14</td>
<td style="text-align: right;">150.00</td>
<td style="text-align: right;">100.00</td>
<td style="text-align: right;">210.00</td>
<td style="text-align: right;">70.00</td>
<td style="text-align: right;">600.00</td>
</tr>
<tr class="odd">
<td style="text-align: left;">No. of bedroom</td>
<td style="text-align: right;">3.23</td>
<td style="text-align: right;">1.19</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">6.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">No. of bathroom</td>
<td style="text-align: right;">2.54</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.00</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
<p>Next, we merged the cleaned dataset with spatial administrative data by matching sub-district and district names. This process resulted in a dataset containing 598 entries. Compared to the previous dataset, which consisted of 576 observations, this indicates that 22 sub-districts did not have any property data available—meaning that property sales in those areas were not recorded on the online property listing platform used as the data source.</p>
<p>To address missing values, we used the <code>mice</code> package (<span class="citation" data-cites="van2011mice">Van Buuren and Groothuis-Oudshoorn (<a href="#ref-van2011mice" role="doc-biblioref">2011</a>)</span>), which performs multiple imputation by chained equations (MICE). This approach iteratively fills in missing data by modeling each variable with missing values as a function of other variables in the dataset. By generating multiple imputed datasets, it accounts for the uncertainty inherent in missing data. In our case, we specified 10 iterations and generated 10 imputed datasets. A fixed random seed was used to ensure the results were reproducible. The imputed datasets were then pooled to obtain final estimates for subsequent analyses. The imputed values were then reintegrated into the main dataset, replacing the original missing entries. This process resulted in a final dataset that was complete and ready for subsequent analysis using the selected spatial models.</p>
<p>In addition to the point-level dataset, which contains individual property listings, the imputed dataset was also aggregated to the sub-district level by calculating the mean values of key variables. This aggregation produced an area-level dataset, allowing the analysis to be conducted at both the individual and administrative levels. These two levels of data granularity provide complementary perspectives for evaluating the performance of spatial models in capturing local property market dynamics.</p>
<p>Moreover, as GWR requires spatial coordinates for each observation, we addressed this by generating random points around the centroid of each sub-district using the <code>st_sample()</code> function. The number of points generated matched the number of observations in each area, and each was positioned within a 0.5 km radius of the centroid to maintain a realistic spatial distribution while preserving the local context. This strategy allowed us to simulate plausible spatial locations for property transactions in the absence of precise geolocation data. Importantly, we applied the same bandwidth in the GWR model fitting to ensure consistency. By preserving the area-level grouping structure, this approach supports a fair comparison with the previous method.</p>
</section>
<section id="model-implementation-analysis" class="level2">
<h2 class="anchored" data-anchor-id="model-implementation-analysis">Model Implementation &amp; Analysis</h2>
<p>The cleaned and completed Lombok dataset was then fitted to the model. Equation <a href="#eq-lopreg" class="quarto-xref">Equation&nbsp;10</a> presents the proposed model specification, which serves as the fixed formula applied consistently across all analyses</p>
<p><span id="eq-lopreg"><span class="math display">\[
\text{logprices} \sim \text{land}_{\text{std}} + \text{building}_{\text{std}} + \text{beds}_{\text{std}} + \text{baths}_{\text{std}}
\tag{10}\]</span></span></p>
<p>Standardization of the predictors ensures that the resulting coefficients are on a comparable scale, facilitating meaningful interpretation and comparison across different modeling approaches. We conducted model fitting on the area-level data, with detailed results provided in the Appendix (<a href="#tbl-modelcomp1" class="quarto-xref">Table&nbsp;8</a>). However, this method does not provide optimal parameter estimates because data aggregation can reduce variability and obscure spatial details essential for capturing local effects. To address this, we used point-level data to apply three different models: GLMM, GWR, and multilevel CAR.</p>
<p>The results presented in <a href="#tbl-modelcomp" class="quarto-xref">Table&nbsp;5</a> provide a comprehensive evaluation of each model’s performance in capturing both the structural and spatial characteristics of the property market in Lombok.</p>
<div class="cell-container"><div class="cell-decorator"><pre>In [16]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [17]:</pre></div><div><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dataset using tribble</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">""</span>,                             <span class="sc">~</span>GLMM,                    <span class="sc">~</span>GWR,                     <span class="sc">~</span>mlvCAR,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Intercept"</span>,                   <span class="st">"7.09 [6.93, 7.24]*"</span>,     <span class="st">"7.25 [7.25, 7.26]*"</span>,     <span class="st">"7.08 [6.99, 7.17]*"</span>,</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Land-size"</span>,                   <span class="st">"0.26 [0.21, 0.32]*"</span>,     <span class="st">"0.31 [0.30, 0.32]*"</span>,     <span class="st">"0.26 [0.21, 0.32]*"</span>,</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Built-up area"</span>,               <span class="st">"0.16 [0.10, 0.22]*"</span>,     <span class="st">"0.19 [0.19, 0.20]*"</span>,     <span class="st">"0.16 [0.10, 0.21]*"</span>,</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No. of bedroom"</span>,              <span class="st">"-0.03 [-0.09, 0.01]"</span>,    <span class="st">"-0.15 [-0.17, -0.15]*"</span>,  <span class="st">"-0.03 [-0.09, 0.02]"</span>,</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No. of bathroom"</span>,             <span class="st">"0.19 [0.13, 0.25]*"</span>,     <span class="st">"0.24 [0.23, 0.26]*"</span>,     <span class="st">"0.19 [0.13, 0.25]*"</span>,</span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">rho$"</span>,                     <span class="st">"-"</span>,                      <span class="st">"-"</span>,                      <span class="st">"0.48 [0.07, 0.90]*"</span>,</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">varepsilon}^2$"</span>,  <span class="st">"0.22 [0.19, 0.25]*"</span>,     <span class="st">"0.33 [0.29, 0.37]*"</span>,     <span class="st">"0.22 [0.20, 0.25]*"</span>,</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">phi}^2$"</span>,          <span class="st">"0.20 [0.11, 0.34]*"</span>,     <span class="st">"-"</span>,                      <span class="st">"0.31 [0.14, 0.58]*"</span>,</span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AIC"</span>,                         <span class="st">"803.38"</span>,                 <span class="st">"-645.104"</span>,               <span class="st">"786.95"</span>,</span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DIC"</span>,                         <span class="st">"-"</span>,                      <span class="st">"-"</span>,                      <span class="st">"850.39"</span>,</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"WAIC"</span>,                        <span class="st">"838.3"</span>,                  <span class="st">"-"</span>,                      <span class="st">"851.14"</span>,</span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LMPL"</span>,                        <span class="st">"-421.31"</span>,               <span class="st">"-"</span>,                      <span class="st">"-427.21"</span>,</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Log-likelihood"</span>,              <span class="st">"-400.69"</span>,                <span class="st">"-520.97"</span>,                <span class="st">"-385.47"</span></span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a><span class="co">#table_data</span></span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(table_data, <span class="at">booktabs =</span> T, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Coefficients"</span>, <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Spatial parameter"</span>, <span class="dv">6</span>,<span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Variances"</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Model fit criterion"</span>, <span class="dv">9</span>, <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-modelcomp" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-modelcomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5: Point-level Model Comparison
</figcaption>
<div aria-describedby="tbl-modelcomp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GLMM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GWR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">mlvCAR</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="5">
<td colspan="4" style="border-bottom: 1px solid"><strong>Coefficients</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Intercept</td>
<td style="text-align: left;">7.09 [6.93, 7.24]*</td>
<td style="text-align: left;">7.25 [7.25, 7.26]*</td>
<td style="text-align: left;">7.08 [6.99, 7.17]*</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Land-size</td>
<td style="text-align: left;">0.26 [0.21, 0.32]*</td>
<td style="text-align: left;">0.31 [0.30, 0.32]*</td>
<td style="text-align: left;">0.26 [0.21, 0.32]*</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Built-up area</td>
<td style="text-align: left;">0.16 [0.10, 0.22]*</td>
<td style="text-align: left;">0.19 [0.19, 0.20]*</td>
<td style="text-align: left;">0.16 [0.10, 0.21]*</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">No. of bedroom</td>
<td style="text-align: left;">-0.03 [-0.09, 0.01]</td>
<td style="text-align: left;">-0.15 [-0.17, -0.15]*</td>
<td style="text-align: left;">-0.03 [-0.09, 0.02]</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">No. of bathroom</td>
<td style="text-align: left;">0.19 [0.13, 0.25]*</td>
<td style="text-align: left;">0.24 [0.23, 0.26]*</td>
<td style="text-align: left;">0.19 [0.13, 0.25]*</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="4" style="border-bottom: 1px solid"><strong>Spatial parameter</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\rho$</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">0.48 [0.07, 0.90]*</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="4" style="border-bottom: 1px solid"><strong>Variances</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\sigma_{\varepsilon}^2$</td>
<td style="text-align: left;">0.22 [0.19, 0.25]*</td>
<td style="text-align: left;">0.33 [0.29, 0.37]*</td>
<td style="text-align: left;">0.22 [0.20, 0.25]*</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\sigma_{\phi}^2$</td>
<td style="text-align: left;">0.20 [0.11, 0.34]*</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">0.31 [0.14, 0.58]*</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="4" style="border-bottom: 1px solid"><strong>Model fit criterion</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">AIC</td>
<td style="text-align: left;">803.38</td>
<td style="text-align: left;">-645.104</td>
<td style="text-align: left;">786.95</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">DIC</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">850.39</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">WAIC</td>
<td style="text-align: left;">838.3</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">851.14</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">LMPL</td>
<td style="text-align: left;">-421.31</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-427.21</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Log-likelihood</td>
<td style="text-align: left;">-400.69</td>
<td style="text-align: left;">-520.97</td>
<td style="text-align: left;">-385.47</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
<p>Here, <a href="#tbl-modelcomp" class="quarto-xref">Table&nbsp;5</a> compares parameter estimates and fit criteria for three models: GLMM, GWR, and multilevel CAR. Significant coefficients are marked with an asterisk (*). Key determinants like land-size and built-up area have positive, significant effects across models, while the number of bedrooms shows only minor, varying effects, indicating model-specific differences in capturing this variable’s influence. Only the multilevel CAR model includes the spatial parameter <span class="math inline">\(\rho\)</span>, with a significant estimate of 0.48, showing the model’s ability to account for spatial dependence. Variance components <span class="math inline">\(\sigma_{\varepsilon}^2\)</span> (residual) and <span class="math inline">\(\sigma_{\phi}^2\)</span> are also detailed, with both terms are significant. Fit criteria (AIC, WAIC, and Log-likelihood) suggest mlvCAR and GWR may better capture local spatial variation, with mlvCAR balancing spatial structure and precision.</p>
<div id="fig-pricenphi" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-pricenphi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pricenphi" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-pricenphi1" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pricenphi1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="figures/phi_map.png" class="lightbox" data-glightbox="description: .lightbox-desc-8" data-gallery="fig-pricenphi"><img src="figures/phi_map.png" class="img-fluid figure-img" data-ref-parent="fig-pricenphi"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pricenphi1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <span class="math inline">\(\phi\)</span> values
</figcaption>
</figure>
</div>
</div>
<div class="quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-pricenphi" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-pricenphi2" class="quarto-figure quarto-figure-center quarto-float anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-pricenphi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="figures/logprice_map.png" class="lightbox" data-glightbox="description: .lightbox-desc-9" data-gallery="fig-pricenphi"><img src="figures/logprice_map.png" class="img-fluid figure-img" data-ref-parent="fig-pricenphi"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-pricenphi2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Aggregate price data (log scale)
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-pricenphi-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7: Heatmap of aggregated price data and phi values in each Lombok sub-district
</figcaption>
</figure>
</div>
<div class="cell-container"><div class="cell-decorator"><pre>In [18]:</pre></div><div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># #| label: fig-pricenphi</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># #| fig-cap: "Heatmap of aggregated price data and phi values in each Lombok sub-district"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="co"># #| eval: true</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># #| layout-ncol: 2</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics("figures/phi_map.png", auto_pdf = TRUE)</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr::include_graphics("figures/logprice_map.png", auto_pdf = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
<p><a href="#fig-pricenphi1" class="quarto-xref">Figure&nbsp;7 (a)</a> and <a href="#fig-pricenphi2" class="quarto-xref">Figure&nbsp;7 (b)</a> respectively present spatial heatmaps illustrating the distribution of estimated spatial random effects (<span class="math inline">\(\phi\)</span>) from the CAR model and the average log-transformed house prices per sub-district accross Lombok island. It can be seen that both plots in <a href="#fig-pricenphi" class="quarto-xref">Figure&nbsp;7</a> exhibit similar spatial patterns, with high and low values clustering in comparable regions. Note that they do not have to be identical, as <span class="math inline">\(\phi\)</span> represents the spatially structured residual component after accounting for covariates, whereas the log-transformed prices reflect the observed aggregated market values. Nonetheless, their resemblance suggests that some of the spatial variability in house prices is being effectively captured by the spatial random effects.</p>
<p>Because the model uses log-transformed prices, <span class="math inline">\(\phi\)</span> has multiplicative interpretation on the original price scale. For instance, if <span class="math inline">\(\phi = 0.57\)</span> for a given sub-district, then after accounting for covariates, properties in that area are estimated to be approximately <span class="math inline">\(\exp(0.57) \approx 1.76\)</span> or 76% more expensive than average. Similarly, a sub-district with <span class="math inline">\(\phi = -0.2\)</span>, this suggests that properties in that area are approximately 18% less expensive than average, since <span class="math inline">\(\exp(-0.2) \approx 0.82\)</span>. Note that the 95% credible interval of <span class="math inline">\(\phi\)</span> can be interpreted similarly by exponentiating the lower and upper bounds, yielding a multiplicative uncertainty range for the price deviation.</p>
</section>
</section>
<section id="results-and-discussion" class="level1">
<h1>Results and Discussion</h1>
<p>The findings from simulation consistently indicate that both the CAR and mlvCAR model outperform the other models in capturing spatial dependencies. This is evidenced by lower RMSE values and reduced bias across various dataset scenarios, highlighting the CAR model’s robustness. In datasets with strong spatial structures, such as those generated under <span class="math inline">\(CAR\)</span> and <span class="math inline">\(SAR + CAR\)</span> conditions, the CAR model achieves substantially lower RMSE values compared to GLM and SAR, suggesting its effectiveness in handling localised spatial variations.</p>
<p>In the context of house price modelling, it is common to encounter multiple sales observations within a single area, yet precise coordinates for each sale are often unavailable. Obtaining precise geographic coordinates in real-world datasets is often challenging due to limitations in data collection, privacy concerns, or the aggregation of data into broader administrative units. This limitation renders point-level approaches, such as GWR, less effective. With multiple observations available for each area, models like mlvCAR offer a more practical and accurate solution, effectively capturing spatial dependencies at an area level without requiring precise point-level locations.</p>
<p>The results underscore the importance of using models that explicitly account for spatial dependencies in fields like property valuation, where spatial heterogeneity plays a significant role. The superior performance of the CAR model, particularly in datasets with strong spatial structure, suggests that it may be a more reliable choice for applications where local spatial variations are critical. The findings align with previous studies (<span class="citation" data-cites="Wang2013A">Y. Wang and Kockelman (<a href="#ref-Wang2013A" role="doc-biblioref">2013</a>)</span>, <span class="citation" data-cites="Soroori2019Application">Soroori, Moghaddam, and Salehi (<a href="#ref-Soroori2019Application" role="doc-biblioref">2019</a>)</span>, <span class="citation" data-cites="Zeng2014Bayesian">Zeng and Huang (<a href="#ref-Zeng2014Bayesian" role="doc-biblioref">2014</a>)</span>, <span class="citation" data-cites="Guelat2018Effects">Guelat and Kéry (<a href="#ref-Guelat2018Effects" role="doc-biblioref">2018</a>)</span>) indicating that CAR models are better suited for managing spatial autocorrelation and heterogeneity, especially when spatial dependencies are strong.</p>
<p>Spatial maps of the estimated random effects <span class="math inline">\(\phi\)</span> from the CAR model offer further insight into the spatial structure of housing prices across Lombok Island. These effects represent residual spatial patterns after accounting for structural covariates like land size, building size, and number of rooms. Such interpretability supports the use of CAR models not only for improved prediction but also for spatial diagnostics. The visual comparison of <span class="math inline">\(\phi\)</span> values and aggregated log-transformed prices (as shown in <a href="#fig-pricenphi" class="quarto-xref">Figure&nbsp;7</a>) highlights spatial patterns that may warrant further investigation—such as clusters of residual over- or under-prediction in West and East Lombok respectively. These patterns underscore the added value of CAR-type models in revealing latent geographic effects.</p>
<p>These findings also echo the limitations of GWR when precise coordinates are lacking, affirming the relevance of area-level approaches. Moreover, while we use a binary adjacency matrix for consistency, we recognise that the choice of spatial weight <span class="math inline">\(\mathbf{W}\)</span> may influences model performance. Future studies should explore alternative specifications such as row-standardized or distance-decay matrices to assess their impact on robustness and interpretability.</p>
<p>Additionally, while the spatial dependence parameter <span class="math inline">\(\rho\)</span> is estimated as part of the model fitting, its variability across simulations suggests that further sensitivity analyses—especially under different fixed <span class="math inline">\(\rho\)</span> values—could shed light on model stability in different spatial contexts.</p>
<p>Additionally, the limitations of point-level models such as GWR in the absence of precise location data highlight a practical challenge in spatial modeling. When only area-level data is available, the use of models like mlvCAR becomes essential, as it allows for spatial analysis without the need for detailed coordinates, thus expanding the applicability of spatial models in real-world settings. These insights suggest potential for further exploration of the CAR and mlvCAR models in various domains, especially in urban planning, real estate, and other fields where spatial relationships impact outcomes. Future research could examine the use of CAR and mlvCAR models with different spatial resolutions or apply these models to other datasets with varying levels of spatial dependency to further validate their effectiveness.</p>
<p>In summary, this study highlights the importance of explicitly modeling spatial dependence in house price analysis. CAR and mlvCAR models emerge as practical and theoretically sound options, especially when high-resolution spatial data are unavailable. Future research may extend these models to finer spatial scales, incorporate additional spatial diagnostics, or apply them in other domains where spatial heterogeneity significantly influences outcomes.</p>
</section>
<section id="supplementary-information" class="level1 unnumbered">
<h1 class="unnumbered">Supplementary information</h1>
<p>Not applicable</p>
</section>
<section id="acknowledgments" class="level1 unnumbered">
<h1 class="unnumbered">Acknowledgments</h1>
<p>Not applicable</p>
</section>
<section id="declarations" class="level1 unnumbered">
<h1 class="unnumbered">Declarations</h1>
<ul>
<li>Funding</li>
<li>Competing interests</li>
</ul>
<p>No, I declare that the authors have no competing interests as defined by Springer, or other interests that might be perceived to influence the results and/or discussion reported in this paper.</p>
<ul>
<li>Ethics approval</li>
<li>Consent to participate</li>
<li>Consent for publication</li>
<li>Availability of data and materials</li>
<li>Code availability</li>
<li>Authors’ contributions</li>
</ul>
<div style="page-break-after: always;"></div>
</section>
<section id="appendix" class="level1 unnumbered">
<h1 class="unnumbered">Appendix</h1>
<section id="bias-values-for-area-level-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="bias-values-for-area-level-data">Bias values for Area-level Data</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [19]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [20]:</pre></div><div><div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>biasarea <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"data/biasarea1.rds"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">&lt;-</span> <span class="fu">round</span>(biasarea<span class="sc">$</span>avg_bias, <span class="dv">3</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>sd  <span class="ot">&lt;-</span> <span class="fu">round</span>(biasarea<span class="sc">$</span>sd_bias, <span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dataset =</span> <span class="fu">c</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">GLM =</span> <span class="fu">c</span>(</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">13</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">13</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">14</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">14</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">15</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">15</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">16</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">16</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">17</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">17</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">18</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">18</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">19</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">19</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">20</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">20</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">21</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">21</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">22</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">22</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">23</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">23</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">24</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">24</span>]), <span class="st">"$"</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">SAR =</span> <span class="fu">c</span>(</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">25</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">25</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">26</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">26</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">27</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">27</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">28</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">28</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">29</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">29</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">30</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">30</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">31</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">31</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">32</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">32</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">33</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">33</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">34</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">34</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">35</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">35</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">36</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">36</span>]), <span class="st">"$"</span>)</span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a>  <span class="at">CAR =</span> <span class="fu">c</span>(</span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">1</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">1</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">2</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">2</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">3</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">3</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">4</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">4</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">5</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">5</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">6</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">6</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">7</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">7</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">8</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">8</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">9</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">9</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">10</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">10</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">11</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">11</span>]), <span class="st">"$"</span>),</span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">12</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">12</span>]), <span class="st">"$"</span>)</span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a><span class="co"># Render the table with kableExtra</span></span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>  df, </span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>)</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mean ± SD"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{1}$"</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{2}$"</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{3}$"</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{4}$"</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-bias1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;6: Mean ± SD values for bias across different area-level datasets and parameters. This table presents the mean and standard deviation (SD) of bias values across area-level datasets (CAR, SAR + CAR, GWR) and spatial models (GLM, SAR, CAR), with <span class="math inline">\(nsim = 1000\)</span>. This is also act as numerical representation of fig.&nbsp;5 (top panel)
</figcaption>
<div aria-describedby="tbl-bias1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Mean ± SD
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Dataset</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">GLM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">SAR</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">CAR</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{1}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$7.80e-02 \pm 0.1900$</td>
<td style="text-align: center;">$9.00e-03 \pm 0.1900$</td>
<td style="text-align: center;">$-8.70e-02 \pm 0.1800$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$3.30e-01 \pm 0.3800$</td>
<td style="text-align: center;">$2.77e-01 \pm 0.3700$</td>
<td style="text-align: center;">$2.10e-01 \pm 0.3500$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$-6.00e-02 \pm 0.1100$</td>
<td style="text-align: center;">$-6.50e-02 \pm 0.1100$</td>
<td style="text-align: center;">$-6.50e-02 \pm 0.1100$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{2}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$2.19e-01 \pm 0.1500$</td>
<td style="text-align: center;">$2.37e-01 \pm 0.1400$</td>
<td style="text-align: center;">$2.46e-01 \pm 0.1400$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$-2.47e-01 \pm 0.3900$</td>
<td style="text-align: center;">$-2.29e-01 \pm 0.3600$</td>
<td style="text-align: center;">$-2.12e-01 \pm 0.3700$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$3.05e-01 \pm 0.0900$</td>
<td style="text-align: center;">$3.02e-01 \pm 0.0900$</td>
<td style="text-align: center;">$3.04e-01 \pm 0.0900$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{3}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$-1.24e-01 \pm 0.2000$</td>
<td style="text-align: center;">$0.00e+00 \pm 0.1900$</td>
<td style="text-align: center;">$-3.80e-02 \pm 0.1800$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$-5.80e-02 \pm 0.3700$</td>
<td style="text-align: center;">$6.30e-02 \pm 0.3500$</td>
<td style="text-align: center;">$-5.00e-03 \pm 0.3500$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$-6.20e-02 \pm 0.1100$</td>
<td style="text-align: center;">$-3.50e-02 \pm 0.1100$</td>
<td style="text-align: center;">$-5.90e-02 \pm 0.1100$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{4}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$1.83e-01 \pm 0.1600$</td>
<td style="text-align: center;">$1.27e-01 \pm 0.1500$</td>
<td style="text-align: center;">$1.64e-01 \pm 0.1500$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$1.22e-01 \pm 0.3000$</td>
<td style="text-align: center;">$7.60e-02 \pm 0.2900$</td>
<td style="text-align: center;">$1.10e-01 \pm 0.2800$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$1.82e-01 \pm 0.0900$</td>
<td style="text-align: center;">$1.73e-01 \pm 0.0900$</td>
<td style="text-align: center;">$1.83e-01 \pm 0.0900$</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
<div class="cell-container"><div class="cell-decorator"><pre>In [21]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [22]:</pre></div><div><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>biaspoint <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"~/Study/R project/article_1/data/biaspoint.rds"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>avg <span class="ot">&lt;-</span> <span class="fu">round</span>(biaspoint<span class="sc">$</span>avg_bias, <span class="dv">5</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>sd  <span class="ot">&lt;-</span> <span class="fu">round</span>(biaspoint<span class="sc">$</span>sd_bias, <span class="dv">4</span>)</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the data frame</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dataset =</span> <span class="fu">c</span>(</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span>,</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"CAR"</span>, <span class="st">"SAR + CAR"</span>, <span class="st">"GWR"</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">GLMM =</span> <span class="fu">c</span>(</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">1</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">1</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">2</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">2</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">3</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">3</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">4</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">4</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">5</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">5</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">6</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">6</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">7</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">7</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">8</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">8</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">9</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">9</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">10</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">10</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">11</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">11</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">12</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">12</span>]), <span class="st">"$"</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">GWR =</span> <span class="fu">c</span>(</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">13</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">13</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">14</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">14</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">15</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">15</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">16</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">16</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">17</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">17</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">18</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">18</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">19</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">19</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">20</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">20</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">21</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">21</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">22</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">22</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">23</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">23</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">24</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">24</span>]), <span class="st">"$"</span>)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">mlvCAR =</span> <span class="fu">c</span>(</span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">25</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">25</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">26</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">26</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">27</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">27</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">28</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">28</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">29</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">29</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">30</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">30</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">31</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">31</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">32</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">32</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">33</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">33</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">34</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">34</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">35</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">35</span>]), <span class="st">"$"</span>),</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">"$"</span>, <span class="fu">sprintf</span>(<span class="st">"%.2e"</span>, avg[<span class="dv">36</span>]), <span class="st">" </span><span class="sc">\\</span><span class="st">pm "</span>, <span class="fu">sprintf</span>(<span class="st">"%.4f"</span>, sd[<span class="dv">36</span>]), <span class="st">"$"</span>)</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="co"># Render the table with kableExtra</span></span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>  df, </span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>  <span class="at">booktabs =</span> <span class="cn">TRUE</span>, </span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>  <span class="at">escape =</span> <span class="cn">FALSE</span>,</span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>  <span class="at">align =</span> <span class="fu">c</span>(<span class="st">"l"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>, <span class="st">"c"</span>)</span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span></span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_header_above</span>(<span class="fu">c</span>(<span class="st">" "</span> <span class="ot">=</span> <span class="dv">1</span>, <span class="st">"Mean ± SD"</span> <span class="ot">=</span> <span class="dv">3</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{1}$"</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{2}$"</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{3}$"</span>, <span class="dv">7</span>, <span class="dv">9</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"$</span><span class="sc">\\</span><span class="st">beta_{4}$"</span>, <span class="dv">10</span>, <span class="dv">12</span>, <span class="at">escape =</span> <span class="cn">FALSE</span>, <span class="at">bold =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-bias2" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-bias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7: Mean ± SD values for bias across different point-level datasets and parameters. This table presents the mean and standard deviation (SD) of bias values across point-level datasets (CAR, SAR + CAR, GWR) and spatial models (GLM, SAR, CAR), with <span class="math inline">\(nsim = 1000\)</span>. This is also act as numerical representation of fig.&nbsp;5 (bottom panel)
</figcaption>
<div aria-describedby="tbl-bias2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th" style="empty-cells: hide; border-bottom: hidden"></th>
<th colspan="3" data-quarto-table-cell-role="th" style="text-align: center; border-bottom: hidden; padding-bottom: 0; padding-left: 3px; padding-right: 3px;"><div style="border-bottom: 1px solid #ddd; padding-bottom: 5px; ">
Mean ± SD
</div></th>
</tr>
<tr class="odd">
<th style="text-align: left;" data-quarto-table-cell-role="th">Dataset</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">GLMM</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">GWR</th>
<th style="text-align: center;" data-quarto-table-cell-role="th">mlvCAR</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{1}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$2.80e-04 \pm 0.0115$</td>
<td style="text-align: center;">$8.77e-03 \pm 0.0160$</td>
<td style="text-align: center;">$-2.00e-05 \pm 0.0114$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$4.06e-03 \pm 0.0525$</td>
<td style="text-align: center;">$9.00e-03 \pm 0.0538$</td>
<td style="text-align: center;">$9.80e-04 \pm 0.0524$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$-5.00e-04 \pm 0.0109$</td>
<td style="text-align: center;">$-5.20e-04 \pm 0.0108$</td>
<td style="text-align: center;">$-5.40e-04 \pm 0.0108$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{2}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$-3.10e-04 \pm 0.0125$</td>
<td style="text-align: center;">$-5.50e-03 \pm 0.0172$</td>
<td style="text-align: center;">$-1.70e-04 \pm 0.0124$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$-2.81e-03 \pm 0.0588$</td>
<td style="text-align: center;">$-5.72e-03 \pm 0.0602$</td>
<td style="text-align: center;">$-1.02e-03 \pm 0.0585$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$9.54e-03 \pm 0.0113$</td>
<td style="text-align: center;">$9.55e-03 \pm 0.0113$</td>
<td style="text-align: center;">$9.56e-03 \pm 0.0113$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{3}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$3.80e-04 \pm 0.0096$</td>
<td style="text-align: center;">$-2.86e-03 \pm 0.0142$</td>
<td style="text-align: center;">$4.50e-04 \pm 0.0095$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$9.00e-04 \pm 0.0391$</td>
<td style="text-align: center;">$-8.00e-04 \pm 0.0405$</td>
<td style="text-align: center;">$1.67e-03 \pm 0.0389$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$-4.90e-04 \pm 0.0092$</td>
<td style="text-align: center;">$-5.00e-04 \pm 0.0091$</td>
<td style="text-align: center;">$-5.20e-04 \pm 0.0091$</td>
</tr>
<tr class="odd" data-grouplength="3">
<td colspan="4" style="border-bottom: 1px solid"><strong>$\beta_{4}$</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">CAR</td>
<td style="text-align: center;">$-4.30e-04 \pm 0.0089$</td>
<td style="text-align: center;">$1.18e-03 \pm 0.0122$</td>
<td style="text-align: center;">$-5.10e-04 \pm 0.0089$</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">SAR + CAR</td>
<td style="text-align: center;">$3.10e-04 \pm 0.0393$</td>
<td style="text-align: center;">$1.03e-03 \pm 0.0394$</td>
<td style="text-align: center;">$-8.00e-05 \pm 0.0391$</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">GWR</td>
<td style="text-align: center;">$1.09e-03 \pm 0.0089$</td>
<td style="text-align: center;">$1.05e-03 \pm 0.0088$</td>
<td style="text-align: center;">$1.07e-03 \pm 0.0087$</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
</section>
<section id="model-comparison-for-area-level-data" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="model-comparison-for-area-level-data">Model Comparison for area-level data</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [23]:</pre></div><div class="cell">

<div class="cell-container"><div class="cell-decorator"><pre>In [24]:</pre></div><div><div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the dataset using tribble</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>table_data <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span><span class="st">""</span>,                             <span class="sc">~</span>GLM,                    <span class="sc">~</span>SAR,                     <span class="sc">~</span>CAR,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Intercept"</span>,                   <span class="st">"7.19 [7.02, 7.35]*"</span>,     <span class="st">"6.92 [6.48, 7.37]*"</span>,     <span class="st">"7.19 [7.03, 7.35]*"</span>,</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Land-size"</span>,                   <span class="st">"0.45 [0.24, 0.66]*"</span>,     <span class="st">"0.45 [0.25, 0.64]*"</span>,     <span class="st">"0.45 [0.23, 0.65]*"</span>,</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Built-up area"</span>,               <span class="st">"0.01 [-0.20, 0.23]"</span>,     <span class="st">"0.01 [-0.18, 0.22]"</span>,     <span class="st">"0.02 [-0.20, 0.23]"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No. of bedroom"</span>,              <span class="st">"-0.20 [-0.43, 0.02]"</span>,    <span class="st">"-0.23 [-0.45, -0.01]*"</span>,  <span class="st">"-0.21 [-0.44, 0.02]"</span>,</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  <span class="st">"No. of bathroom"</span>,             <span class="st">"0.54 [0.33, 0.76]*"</span>,     <span class="st">"0.56 [0.36, 0.77]*"</span>,     <span class="st">"0.55 [0.34, 0.76]*"</span>,</span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">rho$"</span>,                     <span class="st">"-"</span>,                      <span class="st">"0.009[-0.005, 0.023]"</span>,    <span class="st">"0.39 [0.01, 0.91]*"</span>,</span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">epsilon}^2$"</span>,     <span class="st">"0.31 [0.21, 0.45]*"</span>,     <span class="st">"0.27 [0.19, 0.41]*"</span>,     <span class="st">"0.28 [0.01, 0.44]*"</span>,</span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"$</span><span class="sc">\\</span><span class="st">sigma_{</span><span class="sc">\\</span><span class="st">phi}^2$"</span>,         <span class="st">"0.20 [0.11, 0.34]*"</span>,     <span class="st">"-"</span>,                      <span class="st">"0.04 [0.01, 0.91]*"</span>,</span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"AIC"</span>,                         <span class="st">"-"</span>,                       <span class="st">"-"</span>,                          <span class="st">"-"</span>,</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"DIC"</span>,                         <span class="st">"94.73"</span>,                  <span class="st">"94.73"</span>,                   <span class="st">"82.52"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"WAIC"</span>,                        <span class="st">"95.64"</span>,                  <span class="st">"-"</span>,                      <span class="st">"87.43"</span>,</span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"LMPL"</span>,                        <span class="st">"-48.04"</span>,               <span class="st">"-"</span>,                         <span class="st">"-46.71"</span>,</span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"Log-likelihood"</span>,              <span class="st">"-41.49"</span>,                <span class="st">"-41.36"</span>,                  <span class="st">"-37.29"</span></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>  table_data,</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">booktabs =</span> T, <span class="at">escape =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">9</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Coefficients"</span>, <span class="dv">1</span>, <span class="dv">5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Spatial parameter"</span>, <span class="dv">6</span>,<span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Variances"</span>, <span class="dv">7</span>, <span class="dv">8</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pack_rows</span>(<span class="st">"Model fit criterion"</span>, <span class="dv">9</span>, <span class="dv">13</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div><div id="tbl-modelcomp1" class="cell quarto-float anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-modelcomp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8: This table compares the performance of GLM, SAR, and CAR models on area-level data. It reports parameter estimates (with 95% confidence intervals), spatial parameters (<span class="math inline">\(\rho\)</span>), variances (<span class="math inline">\(\nu^2\)</span>, <span class="math inline">\(\tau^2\)</span>), and model fit criteria (AIC, DIC, WAIC, LMPL, log-likelihood). The results highlight each model’s capability to capture spatial dependencies and variability
</figcaption>
<div aria-describedby="tbl-modelcomp1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="table do-not-create-environment cell caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: left;" data-quarto-table-cell-role="th">GLM</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">SAR</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">CAR</th>
</tr>
</thead>
<tbody>
<tr class="odd" data-grouplength="5">
<td colspan="4" style="border-bottom: 1px solid"><strong>Coefficients</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Intercept</td>
<td style="text-align: left;">7.19 [7.02, 7.35]*</td>
<td style="text-align: left;">6.92 [6.48, 7.37]*</td>
<td style="text-align: left;">7.19 [7.03, 7.35]*</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Land-size</td>
<td style="text-align: left;">0.45 [0.24, 0.66]*</td>
<td style="text-align: left;">0.45 [0.25, 0.64]*</td>
<td style="text-align: left;">0.45 [0.23, 0.65]*</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Built-up area</td>
<td style="text-align: left;">0.01 [-0.20, 0.23]</td>
<td style="text-align: left;">0.01 [-0.18, 0.22]</td>
<td style="text-align: left;">0.02 [-0.20, 0.23]</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">No. of bedroom</td>
<td style="text-align: left;">-0.20 [-0.43, 0.02]</td>
<td style="text-align: left;">-0.23 [-0.45, -0.01]*</td>
<td style="text-align: left;">-0.21 [-0.44, 0.02]</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">No. of bathroom</td>
<td style="text-align: left;">0.54 [0.33, 0.76]*</td>
<td style="text-align: left;">0.56 [0.36, 0.77]*</td>
<td style="text-align: left;">0.55 [0.34, 0.76]*</td>
</tr>
<tr class="odd" data-grouplength="1">
<td colspan="4" style="border-bottom: 1px solid"><strong>Spatial parameter</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\rho$</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">0.009[-0.005, 0.023]</td>
<td style="text-align: left;">0.39 [0.01, 0.91]*</td>
</tr>
<tr class="odd" data-grouplength="2">
<td colspan="4" style="border-bottom: 1px solid"><strong>Variances</strong></td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\sigma_{\epsilon}^2$</td>
<td style="text-align: left;">0.31 [0.21, 0.45]*</td>
<td style="text-align: left;">0.27 [0.19, 0.41]*</td>
<td style="text-align: left;">0.28 [0.01, 0.44]*</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">$\sigma_{\phi}^2$</td>
<td style="text-align: left;">0.20 [0.11, 0.34]*</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">0.04 [0.01, 0.91]*</td>
</tr>
<tr class="even" data-grouplength="5">
<td colspan="4" style="border-bottom: 1px solid"><strong>Model fit criterion</strong></td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">AIC</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">DIC</td>
<td style="text-align: left;">94.73</td>
<td style="text-align: left;">94.73</td>
<td style="text-align: left;">82.52</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">WAIC</td>
<td style="text-align: left;">95.64</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">87.43</td>
</tr>
<tr class="even">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">LMPL</td>
<td style="text-align: left;">-48.04</td>
<td style="text-align: left;">-</td>
<td style="text-align: left;">-46.71</td>
</tr>
<tr class="odd">
<td style="text-align: left; padding-left: 2em;" data-indentlevel="1">Log-likelihood</td>
<td style="text-align: left;">-41.49</td>
<td style="text-align: left;">-41.36</td>
<td style="text-align: left;">-37.29</td>
</tr>
</tbody>
</table>


</div>
</div>
</figure>
</div></div></div>
</div></div>
</section>
<section id="example-of-beta-values-in-gwr-model" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="example-of-beta-values-in-gwr-model">Example of beta-values in GWR model</h2>
<div class="cell-container"><div class="cell-decorator"><pre>In [25]:</pre></div><div id="cell-fig-betaplot" class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"figures/betavalues_plot.png"</span>, <span class="at">auto_pdf =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-betaplot" class="quarto-figure quarto-figure-center quarto-float anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-betaplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca" class="">
<a href="figures/betavalues_plot.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10"><img src="figures/betavalues_plot.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-betaplot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8: Spatial variation of <span class="math inline">\(\beta\)</span> values generated using a custom beta function. The color gradient represents the magnitude of <span class="math inline">\(\beta\)</span> values across the artificial study region, highlighting localised patterns and heterogeneity. The visualisation demonstrates the spatially varying coefficient structure modeled in the study
</figcaption>
</figure>
</div>
</div>
</div></div>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">Figure&nbsp;1: Artificial study region used for simulation analysis, consisting of 216 non-overlapping polygonal areas. Each area represents a distinct spatial unit for modelling and analysis, providing a controlled environment to evaluate spatial models’ performance</span>
<span class="glightbox-desc lightbox-desc-2">Figure&nbsp;2: Illustration of neighbourhood structure. The figure depicts a simplified spatial configuration where each numbered area represents a distinct spatial unit, demonstrating how neighbouring relationships can be defined for spatial modelling purposes.</span>
<span class="glightbox-desc lightbox-desc-3">Figure&nbsp;3: Neighbourhood structure of the artificial region. This figure illustrates the spatial connectivity between polygons in the artificial study region, where each line represents a defined neighbour relationship based on spatial adjacency</span>
<span class="glightbox-desc lightbox-desc-4">Figure&nbsp;4: Artificial study region with observation points. The points represent data locations within each polygon, simulating real-world spatial observations for the purpose of model analysis and validation.</span>
<span class="glightbox-desc lightbox-desc-5">Figure&nbsp;5&nbsp;(a): Bias values by method and dataset type for area-level data</span>
<span class="glightbox-desc lightbox-desc-6">Figure&nbsp;5&nbsp;(b): Bias values by method and dataset type for point-level data</span>
<span class="glightbox-desc lightbox-desc-7">Figure&nbsp;6: Lombok neighbour structure at the sub-district (Kecamatan) level. This figure illustrates the spatial neighbour structure of sub-districts on Lombok Island. The red lines represent the connections between neighbouring sub-districts based on adjacency relationships, overlaid on a base map.</span>
<span class="glightbox-desc lightbox-desc-8">Figure&nbsp;7&nbsp;(a): <span class="math inline">\(\phi\)</span> values</span>
<span class="glightbox-desc lightbox-desc-9">Figure&nbsp;7&nbsp;(b): Aggregate price data (log scale)</span>
<span class="glightbox-desc lightbox-desc-10">Figure&nbsp;8: Spatial variation of <span class="math inline">\(\beta\)</span> values generated using a custom beta function. The color gradient represents the magnitude of <span class="math inline">\(\beta\)</span> values across the artificial study region, highlighting localised patterns and heterogeneity. The visualisation demonstrates the spatially varying coefficient structure modeled in the study</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-anselin2013spatial" class="csl-entry" role="listitem">
Anselin, Luc. 2013. <em>Spatial Econometrics: Methods and Models</em>. Vol. 4. Springer Science &amp; Business Media.
</div>
<div id="ref-anselin1988spatial" class="csl-entry" role="listitem">
Anselin, Luc, and Daniel A Griffith. 1988. <span>“Do Spatial Effecfs Really Matter in Regression Analysis?”</span> <em>Papers in Regional Science</em> 65 (1): 11–34.
</div>
<div id="ref-banerjee2014hierarchical" class="csl-entry" role="listitem">
Banerjee, Sudipto, Bradley P Carlin, and Alan E Gelfand. 2014. <em>Hierarchical Modeling and Analysis for Spatial Data</em>. CRC press.
</div>
<div id="ref-begueria2009comparison" class="csl-entry" role="listitem">
Beguería, Santiago, and Yolanda Pueyo. 2009. <span>“A Comparison of Simultaneous Autoregressive and Generalized Least Squares Models for Dealing with Spatial Autocorrelation.”</span> <em>Global Ecology and Biogeography</em> 18 (3): 273–79.
</div>
<div id="ref-besag1991bayesian" class="csl-entry" role="listitem">
Besag, Julian, Jeremy York, and Annie Mollié. 1991. <span>“Bayesian Image Restoration, with Two Applications in Spatial Statistics.”</span> <em>Annals of the Institute of Statistical Mathematics</em> 43 (March): 1–20. <a href="https://doi.org/10.1007/BF00116466">https://doi.org/10.1007/BF00116466</a>.
</div>
<div id="ref-bottero2017buildings" class="csl-entry" role="listitem">
Bottero, Marta, Marina Bravi, Giulio Mondini, and Antonio Talarico. 2017. <span>“Buildings Energy Performance and Real Estate Market Value: An Application of the Spatial Auto Regressive (SAR) Model.”</span> <em>Appraisal: From Theory to Practice: Results of SIEV 2015</em>, 221–30.
</div>
<div id="ref-brunsdon1996geographically" class="csl-entry" role="listitem">
Brunsdon, Chris, A Stewart Fotheringham, and Martin E Charlton. 1996. <span>“Geographically Weighted Regression: A Method for Exploring Spatial Nonstationarity.”</span> <em>Geographical Analysis</em> 28 (4): 281–98.
</div>
<div id="ref-cellmer2020spatial" class="csl-entry" role="listitem">
Cellmer, Radosław, Aneta Cichulska, and Mirosław Bełej. 2020. <span>“Spatial Analysis of Housing Prices and Market Activity with the Geographically Weighted Regression.”</span> <em>ISPRS International Journal of Geo-Information</em> 9 (6): 380. <a href="https://doi.org/10.3390/ijgi9060380">https://doi.org/10.3390/ijgi9060380</a>.
</div>
<div id="ref-cellmer2019application" class="csl-entry" role="listitem">
Cellmer, Radosław, Katarzyna Kobylińska, and Mirosław Bełej. 2019. <span>“Application of Hierarchical Spatial Autoregressive Models to Develop Land Value Maps in Urbanized Areas.”</span> <em>ISPRS International Journal of Geo-Information</em> 8 (4): 195.
</div>
<div id="ref-de2012bayesian" class="csl-entry" role="listitem">
De Oliveira, Victor. 2012. <span>“Bayesian Analysis of Conditional Autoregressive Models.”</span> <em>Annals of the Institute of Statistical Mathematics</em> 64: 107–33.
</div>
<div id="ref-droj2024comprehensive" class="csl-entry" role="listitem">
Droj, Gabriela, Anita Kwartnik-Pruc, and Laurențiu Droj. 2024. <span>“A Comprehensive Overview Regarding the Impact of GIS on Property Valuation.”</span> <em>ISPRS International Journal of Geo-Information</em> 13 (6): 175.
</div>
<div id="ref-elhorst2014spatial" class="csl-entry" role="listitem">
Elhorst, J Paul et al. 2014. <em>Spatial Econometrics: From Cross-Sectional Data to Spatial Panels</em>. Vol. 479. Springer.
</div>
<div id="ref-elhorst2012model" class="csl-entry" role="listitem">
Elhorst, J Paul, Donald J Lacombe, and Gianfranco Piras. 2012. <span>“On Model Specification and Parameter Space Definitions in Higher Order Spatial Econometric Models.”</span> <em>Regional Science and Urban Economics</em> 42 (1-2): 211–20.
</div>
<div id="ref-fix2021simultaneous" class="csl-entry" role="listitem">
Fix, Miranda J, Daniel S Cooley, and Emeric Thibaud. 2021. <span>“Simultaneous Autoregressive Models for Spatial Extremes.”</span> <em>Environmetrics</em> 32 (2): e2656.
</div>
<div id="ref-golgher2016interpret" class="csl-entry" role="listitem">
Golgher, André Braz, and Paul R Voss. 2016. <span>“How to Interpret the Coefficients of Spatial Models: Spillovers, Direct and Indirect Effects.”</span> <em>Spatial Demography</em> 4: 175–205.
</div>
<div id="ref-Guelat2018Effects" class="csl-entry" role="listitem">
Guelat, J., and M. Kéry. 2018. <span>“Effects of Spatial Autocorrelation and Imperfect Detection on Species Distribution Models.”</span> <em>Methods in Ecology and Evolution</em> 9: 1614–25. <a href="https://doi.org/10.1111/2041-210X.12983">https://doi.org/10.1111/2041-210X.12983</a>.
</div>
<div id="ref-lee2013carbayes" class="csl-entry" role="listitem">
Lee, Duncan. 2013. <span>“CARBayes: An r Package for Bayesian Spatial Modeling with Conditional Autoregressive Priors.”</span> <em>Journal of Statistical Software</em> 55 (13): 1–24. <a href="https://doi.org/10.18637/jss.v055.i13">https://doi.org/10.18637/jss.v055.i13</a>.
</div>
<div id="ref-leroux2000estimation" class="csl-entry" role="listitem">
Leroux, Brian G, Xingye Lei, and Norman Breslow. 2000. <span>“Estimation of Disease Rates in Small Areas: A New Mixed Model for Spatial Dependence.”</span> In <em>Statistical Models in Epidemiology, the Environment, and Clinical Trials</em>, 179–91.
</div>
<div id="ref-LeSage2014" class="csl-entry" role="listitem">
LeSage, James P., and R. Kelley Pace. 2014. <span>“Interpreting Spatial Econometric Models.”</span> In <em>Handbook of Regional Science</em>, edited by Manfred M. Fischer and Peter Nijkamp, 1535–52. Berlin, Heidelberg: Springer Berlin Heidelberg. <a href="https://doi.org/10.1007/978-3-642-23430-9_91">https://doi.org/10.1007/978-3-642-23430-9_91</a>.
</div>
<div id="ref-lu2011geographically" class="csl-entry" role="listitem">
Lu, Binbin, Martin Charlton, and A Stewart Fotheringham. 2011. <span>“Geographically Weighted Regression Using a Non-Euclidean Distance Metric with a Study on London House Price Data.”</span> <em>Procedia Environmental Sciences</em> 7: 92–97.
</div>
<div id="ref-mccord2014understanding" class="csl-entry" role="listitem">
McCord, Michael, Peadar T Davis, Martin Haran, David McIlhatton, and John McCord. 2014. <span>“Understanding Rental Prices in the UK: A Comparative Application of Spatial Modelling Approaches.”</span> <em>International Journal of Housing Markets and Analysis</em> 7 (1): 98–128.
</div>
<div id="ref-morris2019bayesian" class="csl-entry" role="listitem">
Morris, Mitzi, Katherine Wheeler-Martin, Dan Simpson, Stephen J Mooney, Andrew Gelman, and Charles DiMaggio. 2019. <span>“Bayesian Hierarchical Spatial Models: Implementing the Besag York Molli<span>é</span> Model in Stan.”</span> <em>Spatial and Spatio-Temporal Epidemiology</em> 31 (November): 100301. <a href="https://doi.org/10.1016/j.sste.2019.100301">https://doi.org/10.1016/j.sste.2019.100301</a>.
</div>
<div id="ref-pagourtzi2003real" class="csl-entry" role="listitem">
Pagourtzi, Elli, Vassilis Assimakopoulos, Thomas Hatzichristos, and Nick French. 2003. <span>“Real Estate Appraisal: A Review of Valuation Methods.”</span> <em>Journal of Property Investment &amp; Finance</em> 21 (4): 383–401.
</div>
<div id="ref-rue2005gaussian" class="csl-entry" role="listitem">
Rue, Havard, and Leonhard Held. 2005. <em>Gaussian Markov Random Fields: Theory and Applications</em>. Chapman; Hall/CRC.
</div>
<div id="ref-sarlas2015localized" class="csl-entry" role="listitem">
Sarlas, Georgios, and Kay W Axhausen. 2015. <span>“Localized Speed Prediction with the Use of Spatial Simultaneous Autoregressive Models.”</span> In <em>TRB 94th Annual Meeting Compendium of Papers</em>. National Academy of Sciences.
</div>
<div id="ref-sisman2022modelling" class="csl-entry" role="listitem">
Sisman, Suleyman, and Arif Cagdas Aydinoglu. 2022. <span>“A Modelling Approach with Geographically Weighted Regression Methods for Determining Geographic Variation and Influencing Factors in Housing Price: A Case in Istanbul.”</span> <em>Land Use Policy</em> 119 (August): 106183. <a href="https://doi.org/10.1016/j.landusepol.2022.106183">https://doi.org/10.1016/j.landusepol.2022.106183</a>.
</div>
<div id="ref-soltani2021housing" class="csl-entry" role="listitem">
Soltani, Ali, Christopher James Pettit, Mohammad Heydari, and Fatemeh Aghaei. 2021. <span>“Housing Price Variations Using Spatio-Temporal Data Mining Techniques.”</span> <em>Journal of Housing and the Built Environment</em> 36 (3): 1–29. <a href="https://doi.org/10.1007/s10901-020-09811-y">https://doi.org/10.1007/s10901-020-09811-y</a>.
</div>
<div id="ref-Soroori2019Application" class="csl-entry" role="listitem">
Soroori, Emad, Abolfazl Mohammadzadeh Moghaddam, and M. Salehi. 2019. <span>“Application of Local Conditional Autoregressive Models for Development of Zonal Crash Prediction Models and Identification of Crash Risk Boundaries.”</span> <em>Transportmetrica A: Transport Science</em> 15: 1102–23. <a href="https://doi.org/10.1080/23249935.2018.1564801">https://doi.org/10.1080/23249935.2018.1564801</a>.
</div>
<div id="ref-stern1999inference" class="csl-entry" role="listitem">
Stern, Hal, and Noel A Cressie. 1999. <span>“Inference for Extremes in Disease Mapping.”</span> <em>John Wiley and Sons</em> 11: 63–84.
</div>
<div id="ref-stewart2018localized" class="csl-entry" role="listitem">
Stewart Fotheringham, A, and Bumsub Park. 2018. <span>“Localized Spatiotemporal Effects in the Determinants of Property Prices: A Case Study of Seoul.”</span> <em>Applied Spatial Analysis and Policy</em> 11 (August): 581–98. <a href="https://doi.org/10.1007/s12061-017-9232-8">https://doi.org/10.1007/s12061-017-9232-8</a>.
</div>
<div id="ref-trojanek2018spatial" class="csl-entry" role="listitem">
Trojanek, Radoslaw, and Michal Gluszak. 2018. <span>“Spatial and Time Effect of Subway on Property Prices.”</span> <em>Journal of Housing and the Built Environment</em> 33 (October): 359–84. <a href="https://doi.org/10.1007/s10901-017-9569-y">https://doi.org/10.1007/s10901-017-9569-y</a>.
</div>
<div id="ref-van2011mice" class="csl-entry" role="listitem">
Van Buuren, Stef, and Karin Groothuis-Oudshoorn. 2011. <span>“Mice: Multivariate Imputation by Chained Equations in r.”</span> <em>Journal of Statistical Software</em> 45: 1–67.
</div>
<div id="ref-ver2018spatial" class="csl-entry" role="listitem">
Ver Hoef, Jay M, Erin E Peterson, Mevin B Hooten, Ephraim M Hanks, and Marie-Josèe Fortin. 2018. <span>“Spatial Autoregressive Models for Statistical Inference from Ecological Data.”</span> <em>Ecological Monographs</em> 88 (1): 36–59.
</div>
<div id="ref-wall2004close" class="csl-entry" role="listitem">
Wall, Melanie M. 2004. <span>“A Close Look at the Spatial Structure Implied by the CAR and SAR Models.”</span> <em>Journal of Statistical Planning and Inference</em> 121 (2): 311–24.
</div>
<div id="ref-wang2020geographically" class="csl-entry" role="listitem">
Wang, Chih-Hao, and Na Chen. 2020. <span>“A Geographically Weighted Regression Approach to Investigating Local Built-Environment Effects on Home Prices in the Housing Downturn, Recovery, and Subsequent Increases.”</span> <em>Journal of Housing and the Built Environment</em> 35: 1283–1302.
</div>
<div id="ref-Wang2013A" class="csl-entry" role="listitem">
Wang, Yiyi, and K. Kockelman. 2013. <span>“A Poisson-Lognormal Conditional-Autoregressive Model for Multivariate Spatial Analysis of Pedestrian Crash Counts Across Neighborhoods.”</span> <em>Accident; Analysis and Prevention</em> 60: 71–84. <a href="https://doi.org/10.1016/j.aap.2013.07.030">https://doi.org/10.1016/j.aap.2013.07.030</a>.
</div>
<div id="ref-yang2019does" class="csl-entry" role="listitem">
Yang, Linchuan, Jiangping Zhou, Oliver F Shyr, et al. 2019. <span>“Does Bus Accessibility Affect Property Prices?”</span> <em>Cities</em> 84 (January): 56–65. <a href="https://doi.org/10.1016/j.cities.2018.07.005">https://doi.org/10.1016/j.cities.2018.07.005</a>.
</div>
<div id="ref-yu2007modeling" class="csl-entry" role="listitem">
Yu, Danlin. 2007. <span>“Modeling Owner-Occupied Single-Family House Values in the City of Milwaukee: A Geographically Weighted Regression Approach.”</span> <em>GIScience &amp; Remote Sensing</em> 44 (3): 267–82.
</div>
<div id="ref-Zeng2014Bayesian" class="csl-entry" role="listitem">
Zeng, Q., and Helai Huang. 2014. <span>“Bayesian Spatial Joint Modeling of Traffic Crashes on an Urban Road Network.”</span> <em>Accident; Analysis and Prevention</em> 67: 105–12. <a href="https://doi.org/10.1016/j.aap.2014.02.018">https://doi.org/10.1016/j.aap.2014.02.018</a>.
</div>
</div>
</section>
     </main>
<!-- /main column -->  <script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>  </div> <!-- /content -->  <script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","openEffect":"zoom","descPosition":"bottom","selector":".lightbox","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script> 
  
</body></html>