<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.20">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Response to Journal’s Reviewer Comments</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="response_files/libs/clipboard/clipboard.min.js"></script>
<script src="response_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="response_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="response_files/libs/quarto-html/popper.min.js"></script>
<script src="response_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="response_files/libs/quarto-html/anchor.min.js"></script>
<link href="response_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="response_files/libs/quarto-html/quarto-syntax-highlighting-6bb072e51ab976e338d8fd19b221fbe5.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="response_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="response_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="response_files/libs/bootstrap/bootstrap-be9206a58a27969b3ea3001da8f26fef.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="response_to_reviewers.pdf"><i class="bi bi-file-pdf"></i>PDF</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Response to Journal’s Reviewer Comments</h1>
<p class="subtitle lead">Conditionally Autoregressive Models for House Price Data: Insights From a Comparative Simulation Study</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>Reviewer 1</strong></p>
<p><strong>This manuscript compares different methods (Conditionally Autoregressive, Geographically Weighted Regression, and Simultaneous Autoregressive) for modeling property prices. The problem definition looks reasonable, but the manuscript presents only the application part; nothing is contributed toward the theory. Therefore, I will suggest transferring this manuscript to an application-related journal. To my understanding, this manuscript does not fall in the scope of this journal. Further, the manuscript is not standard format of the journal.</strong></p>
<p>We acknowledge that our work is primarily application-driven, focusing on the use of Conditionally Autoregressive (CAR), Geographically Weighted Regression (GWR), and Simultaneous Autoregressive (SAR) models in the context of property price modeling. However, we respectfully submit that the manuscript makes a meaningful methodological contribution, particularly in bridging the gap between spatial theory and applied practice—an area of growing relevance, especially in spatial analysis for developing regions.</p>
<p>While we do not introduce new theoretical constructs, our work extends the methodological discourse in the following ways:</p>
<ul>
<li><p><strong>Shifting the Dominant Modeling Paradigm</strong>: Previous studies on house price modeling have predominantly employed Geographically Weighted Regression (GWR), which requires precise geolocation data for model fitting. However, such data are often incomplete, unavailable, or unreliable in many regions. Our study explores the potential of the Conditionally Autoregressive (CAR) model—more commonly applied in health and ecological studies—as a viable alternative for house price modeling. This cross-domain adaptation is underexplored and opens new methodological pathways for spatial econometrics.</p></li>
<li><p><strong>Unified Comparative Framework</strong>: We develop and apply a systematic framework to compare CAR, SAR, and GWR models using both simulated data and real-world property data. This comparative approach, particularly within the under-researched housing market context of a developing region, fills a critical gap in the literature.</p></li>
<li><p><strong>Practical Implementation Insights</strong>: The manuscript offers practical guidance for applied researchers on implementing, diagnosing, and interpreting each spatial model. These details are especially valuable for practitioners operating in data-scarce environments or policy-driven contexts.</p></li>
<li><p><strong>Informing Model Selection</strong>: By revealing the comparative strengths and limitations of each model in capturing spatial heterogeneity, our findings contribute to informed model selection in applied spatial econometrics—balancing methodological soundness with practical feasibility.</p></li>
<li><p><strong>Policy and Planning Relevance</strong>: The results of our study have implications for spatial planning and housing market analysis, offering a framework for integrating spatial models into decision-making processes where traditional approaches may be constrained by data availability.</p></li>
</ul>
<p>Given these points, we believe the manuscript fits within the journal’s broader mission to advance rigorous spatial analysis methods and encourage cross-disciplinary methodological applications.</p>
<p><strong>Reviewer 2</strong></p>
<ol type="1">
<li><p><strong>The choice of</strong> <span class="math inline">\(W\)</span> (whether binary adjacency or row-standardized) is critical. Have the authors explored alternative spatial weight matrices, and how do they impact model performance?</p>
<p>Thank you for this insightful comment regarding the specification of the spatial weight matrix, <span class="math inline">\(W\)</span>. The choice of <span class="math inline">\(W\)</span>—whether binary adjacency, row-standardized, or distance-based—can indeed influence the performance and interpretation of spatial models. In the present study, our primary objective was to evaluate and compare the performance of CAR, SAR, and GWR models using both simulated data and real-world data (Lombok house prices). To maintain consistency across models and to isolate the structural differences in model behavior, we have, at this stage, limited our analysis to a binary adjacency matrix for <span class="math inline">\(W\)</span> as a starting point. We agree that exploring alternative specifications of <span class="math inline">\(W\)</span> (e.g., row-standardized or distance-decay matrices) is a valuable direction for further research. We plan to extend our analysis in future work to assess how varying spatial weight structures affect the robustness and predictive accuracy of these spatial models.</p></li>
<li><p><strong>While the CAR model shows lower bias and RMSE in the artificial study, does this advantage persist in real-world scenarios, particularly where data sparsity or boundary effects exist?</strong></p>
<p>Thank you for your thoughtful question. We acknowledge that in small-area data, bias can indeed become a concern due to limited information at the unit level. However, in the case of the multilevel CAR (mlvCAR) model, each area contains multiple observations, allowing us to model area-specific effects—functionally resembling a random effects structure. This hierarchical structure helps mitigate the impact of sparsity within individual areas.</p>
<p>Regarding sample size, literature suggests that as long as the number of groups (spatial areas) is large enough, the model can still perform well even with a limited number of observations per group. See, for example, <span class="citation" data-cites="maas2005sufficient">Maas and Hox (<a href="#ref-maas2005sufficient" role="doc-biblioref">2005</a>)</span> and <span class="citation" data-cites="rabe2008multilevel">Rabe-Hesketh and Skrondal (<a href="#ref-rabe2008multilevel" role="doc-biblioref">2008</a>)</span>. Given our data structure aligns with this recommendation, we believe the mlvCAR model offers a robust approach, especially in real-world scenarios where heterogeneity and partial pooling across areas are important. We thus recommend the use of mlvCAR to address both the potential bias and boundary effects effectively.</p></li>
<li><p><strong>The estimated value of</strong> <span class="math inline">\(\rho\)</span> (spatial dependence strength) varies widely (e.g., 0.48 for the multilevel CAR model). Have the authors examined how sensitive the model results are to changes in <span class="math inline">\(\rho\)</span>?</p>
<p>Certainly, the <span class="math inline">\(\rho\)</span> parameter plays a crucial role in understanding the extent to which spatial autocorrelation is captured by the model. While we did not conduct a dedicated sensitivity analysis by fixing <span class="math inline">\(\rho\)</span> at multiple values, our simulation framework implicitly accounts for variability in <span class="math inline">\(\rho\)</span> through repeated data generation and model fitting, where <span class="math inline">\(\rho\)</span> is treated as an estimable parameter. The observed variability—such as the estimate of 0.48 in the multilevel CAR model—reflects the differences in underlying spatial structure across datasets rather than instability or inconsistency in the model itself.</p>
<p>In a Bayesian framework, the prior distribution assigned to <span class="math inline">\(\rho\)</span> also has an important influence, particularly in data-sparse contexts or when spatial signals are weak. In our implementation, we used a uniform or weakly informative prior (depending on the model setting), allowing the data to drive the estimation of <span class="math inline">\(\rho\)</span> while still preventing extreme or implausible values. In practical applications, however, researchers may wish to incorporate more informative priors based on prior knowledge of spatial processes or domain-specific expectations, which can enhance stability and interpretability in certain contexts.</p>
<p>That said, we fully agree that a more systematic sensitivity analysis—such as fixing <span class="math inline">\(\rho\)</span> at various plausible levels or experimenting with different prior distributions—could offer deeper insights into model robustness and the influence of spatial structure. We consider this an important direction for future research, particularly in settings with heterogeneous spatial patterns or limited sample sizes, where sensitivity to <span class="math inline">\(\rho\)</span> may significantly impact conclusions and policy relevance.</p></li>
<li><p><strong>The study discusses the spatial effects</strong> <span class="math inline">\(\phi\)</span> as a key advantage of the CAR model, but how can these effects be meaningfully interpreted for house price determinants? Would spatial effect maps or additional diagnostic tools enhance this understanding?</p>
<p>Thank you for raising this point. The <span class="math inline">\(\phi\)</span> parameter capture the spatial heterogeneity in the data that is not explained by the model. In other words, rather than directly reflecting specific covariates, <span class="math inline">\(\phi\)</span> accounts for spatially structured residual variation—such as omitted neighborhood characteristics, local amenities, or spatial spillovers—that are not captured by observed variables. In essence, it represents the “local” price deviations from the overall mean, adjusted for covariates.</p>
<p>For a brief illustration, since the model uses log-transformed prices, <span class="math inline">\(\phi\)</span> has multiplicative interpretation on the original price scale. So if <span class="math inline">\(\phi = 0.57\)</span> for a given sub-district, then after accounting for covariates, properties in that area are estimated to be approximately <span class="math inline">\(\exp(0.57) \approx 1.76\)</span> or 76% more expensive than average. Similarly, a sub-district with <span class="math inline">\(\phi = -0.2\)</span>, this suggests that properties in that area are approximately 18% less expensive than average, since <span class="math inline">\(\exp(-0.2) \approx 0.82\)</span>. Note that the 95% credible interval of <span class="math inline">\(\phi\)</span> can be interpreted similarly by exponentiating the lower and upper bounds, yielding a multiplicative uncertainty range for the price deviation.</p>
<p>To address this comment, we have amended the manuscript to include the interpretation of <span class="math inline">\(\phi\)</span>. We also provide a map that visualizes the estimated spatial effects (<span class="math inline">\(\phi\)</span>), thereby highlighting the spatial patterns identified by the model.</p></li>
<li><p><strong>Among the various spatial regression models, Geographically Weighted Regression (GWR) is particularly prominent in property price research (page 2). Before reaching this conclusion, did you compare GWR to other spatial regression models?</strong></p>
<p>In our manuscript, we highlight Geographically Weighted Regression (GWR) as a prominent method in the literature, particularly due to its frequent application in house price studies. This observation is based on a review of previous works rather than a performance-based comparison, for instance <span class="citation" data-cites="wang2020geographically">Wang and Chen (<a href="#ref-wang2020geographically" role="doc-biblioref">2020</a>)</span>, <span class="citation" data-cites="lu2011geographically">Lu, Charlton, and Fotheringham (<a href="#ref-lu2011geographically" role="doc-biblioref">2011</a>)</span>, <span class="citation" data-cites="stewart2018localized">Stewart Fotheringham and Park (<a href="#ref-stewart2018localized" role="doc-biblioref">2018</a>)</span>, and <span class="citation" data-cites="cellmer2020spatial">Cellmer, Cichulska, and Bełej (<a href="#ref-cellmer2020spatial" role="doc-biblioref">2020</a>)</span>. While GWR is indeed widely used for its ability to model spatial heterogeneity at the local level, our study goes further by systematically comparing GWR with CAR and SAR models through simulation and real data applications. This comparative analysis aims to evaluate their relative strengths and limitations more objectively.</p></li>
<li><p><strong>The scope of properties analysed includes residential houses and commercial real estate (page 16). How do the authors reconcile this with the abstract, which mentions only house price data?</strong></p>
<p>Regretably the description in the manuscript is not clear. Our response is as follows. The original dataset obtained through web-scraping did include a broad range of property types—such as residential houses, villas, boarding houses, and vacant land. However, for the purposes of this study, we restricted our analysis to residential houses only, and thereby omitting all other types include commercial real estate. We have revised the manuscript accordingly to ensure that this is clearly stated in both the abstract and the data collection section.</p></li>
<li><p><strong>After data cleaning, the final dataset included 598 entries representing multiple observations per sub-district (page 16). Why does the distribution of these data not appear on the map (Figure 6)?</strong></p>
<p>To be clear, the Lombok house price dataset used in this study does not contain precise geographic X-Y coordinates for each observation. While each observation is linked to a sub-district, the absence of point-level location data limits our ability to visualize them spatially within those areas. One solution here is a choropleth map of house prices at the sub-district level, which will reflect the spatial variation in prices across Lombok using aggregated data. This has been added in the manuscript.</p></li>
<li><p><strong>The authors have applied point-level data using three different models (GLMM, GWR, and multilevel CAR) (page 17). How was this approach implemented, given that there is no explanation of how each observation was georeferenced?</strong></p>
<p>Thank you for this important observation. To clarify, GLMM and multilevel CAR models do not require explicit geographic coordinates for each individual observation. Instead, they rely on an area-level identifiers that links each observation to a corresponding spatial unit (e.g., sub-district). This makes it possible for these models to estimate the group-level variability.</p>
<p>In contrast, GWR does indeed require spatial coordinates for each observation. To meet this requirement, we generated random points around the centroid of each sub-district where the number of points corresponds to the number of observations in that area. This centroid-based method is also mentioned in <span class="citation" data-cites="fotheringham2002geographically">Fotheringham, Brunsdon, and Charlton (<a href="#ref-fotheringham2002geographically" role="doc-biblioref">2002</a>)</span>. Each point was placed within a 0.5 km radius from the centroid, ensuring a reasonable spatial spread while maintaining the area-specific context. This approach enabled us to simulate realistic spatial positions for property transactions in the absence of precise geolocation data. Note that, the same bandwith was used in the fitting of the GWR model. By enforcing the area-level grouping, this ensures a fair comparison to the previous method.</p></li>
<li><p><strong>Why is Table 5 not referred to in the text?</strong></p>
<p>Thank you for raising this point. In the revised version of the manuscript, we have made sure to explicitly refer to Table 5 in the main text to improve clarity and consistency.</p></li>
<li><p><strong>The authors have argued that point-level models like GWR are limited when precise location data are unavailable (page 18). However, for the Lombok House Price Data, the authors have used point-level models. How do you reconcile this contradiction?</strong></p>
<p>Thank you for this important comment. As we noted in our response to Comment 8, the Lombok house price data do not come with precise geographic coordinates. In order to apply the GWR model (which requires point-level location data) we generated synthetic coordinates by simulating random points around the centroid of each sub-district. It’s important to note that while using centroids is a common practice, there are limitations. For instance, in cases where the population or activity within a spatial area is not uniformly distributed, the geometric centroid may not accurately represent the spatial characteristics of the area. Limitations such as these reinforces our argument that point-level models such as GWR can be challenging to apply meaningfully when precise location data are not available.</p></li>
<li><p><strong>In the Lombok house price analysis, no sensitivity analysis was conducted to test how different definitions of adjacency (W matrix) influence the results. Would the findings remain consistent if a different spatial weights structure was used?</strong></p>
<p>As mentioned in our response to Comment 1, in this study we used a binary adjacency matrix to define spatial relationships, primarily to maintain consistency across the CAR and SAR models and to focus on comparing their general performance. We acknowledge that the choice of spatial weights matrix (<span class="math inline">\(W\)</span>) may influence model outcomes. While we have not conducted a sensitivity analysis in this current version, we agree that testing alternative specifications—such as row-standardized or distance-based matrices—would be valuable. We consider this an important direction for future work to assess the robustness of our findings under different definitions of spatial connectivity.</p></li>
<li><p><strong>The study primarily evaluates CAR models within the Lombok context, but how well does it generalize to larger, high-density urban areas (e.g., Jakarta)? Would additional testing in a more complex metropolitan setting strengthen the validity of the conclusions?</strong></p>
<p>Thank you for this important point. Indeed, numerous studies have already explored property price modeling in large, high-density urban areas such as Jakarta, where spatial data availability and heterogeneity are typically greater <span class="citation" data-cites="gamal2024urban berawi2019land han2004spatial">(see, e.g., <a href="#ref-gamal2024urban" role="doc-biblioref">Gamal, Khoirunisa, and Muhtadi 2024</a>; <a href="#ref-berawi2019land" role="doc-biblioref">Berawi et al. 2019</a>; <a href="#ref-han2004spatial" role="doc-biblioref">Han 2004</a>)</span>. In contrast, there is relatively limited research focused on low-density, semi-rural, and small-economy contexts such as Lombok <span class="citation" data-cites="jamil2025spatiotemporal">(<a href="#ref-jamil2025spatiotemporal" role="doc-biblioref">Jamil 2025</a>)</span>. Our study aims to address this gap by evaluating the applicability and performance of spatial models, particularly the CAR model, in a setting that has different data characteristics and spatial structures compared to major metropolitan areas.</p>
<p>We also acknowledge that in richer datasets—common in large ubranised regions where more granular, high-frequency, and multidimensional data are available—machine learning approaches may offer competitive or even superior predictive performance. However, our focus here is to assess interpretable spatial models in contexts where data limitations remain a challenge.</p></li>
</ol>
<section id="references" class="level1 unnumbered">


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-berawi2019land" class="csl-entry" role="listitem">
Berawi, Mohammed Ali, Nyoman Suwartha, Fathiya Salsabila Fathiya Salsabila, Gunawan Gunawan, Perdana Miraj Perdana Miraj, and Roy Woodhead. 2019. <span>“Land <span>Value Capture Modeling</span> in <span>Commercial</span> and <span>Office Areas</span> Using a <span>Big Data Approach</span>.”</span> <em>International Journal of Technology</em> 10 (6): 1150. <a href="https://doi.org/10.14716/ijtech.v10i6.3640">https://doi.org/10.14716/ijtech.v10i6.3640</a>.
</div>
<div id="ref-cellmer2020spatial" class="csl-entry" role="listitem">
Cellmer, Radosław, Aneta Cichulska, and Mirosław Bełej. 2020. <span>“Spatial Analysis of Housing Prices and Market Activity with the Geographically Weighted Regression.”</span> <em>ISPRS International Journal of Geo-Information</em> 9 (6): 380. <a href="https://doi.org/10.3390/ijgi9060380">https://doi.org/10.3390/ijgi9060380</a>.
</div>
<div id="ref-fotheringham2002geographically" class="csl-entry" role="listitem">
Fotheringham, Alexander Stewart, Chris Brunsdon, and Martin Charlton. 2002. <em>Geographically Weighted Regression: The Analysis of Spatially Varying Relationships</em>. Chichester: Wiley.
</div>
<div id="ref-gamal2024urban" class="csl-entry" role="listitem">
Gamal, Ahmad, Risty Khoirunisa, and Iman Muhtadi. 2024. <span>“Urban Clusters and Land Price Variation in <span>Jakarta</span>, <span>Indonesia</span>.”</span> <em>Journal of Property Research</em> 41 (1): 71–93. <a href="https://doi.org/10.1080/09599916.2023.2269956">https://doi.org/10.1080/09599916.2023.2269956</a>.
</div>
<div id="ref-han2004spatial" class="csl-entry" role="listitem">
Han, Sun Sheng. 2004. <span>“Spatial <span>Structure</span> of <span>Residential Property-Value Distribution</span> in <span>Beijing</span> and <span>Jakarta</span>.”</span> <em>Environment and Planning A: Economy and Space</em> 36 (7): 1259–83. <a href="https://doi.org/10.1068/a36147">https://doi.org/10.1068/a36147</a>.
</div>
<div id="ref-jamil2025spatiotemporal" class="csl-entry" role="listitem">
Jamil, Haziq. 2025. <span>“A Spatio-Temporal Analysis of House Prices in <span>Brunei Darussalam</span>.”</span> <em>Quality and Quantity</em> In Press. <a href="https://doi.org/10.13140/RG.2.2.32533.74720">https://doi.org/10.13140/RG.2.2.32533.74720</a>.
</div>
<div id="ref-lu2011geographically" class="csl-entry" role="listitem">
Lu, Binbin, Martin Charlton, and A Stewart Fotheringham. 2011. <span>“Geographically Weighted Regression Using a Non-Euclidean Distance Metric with a Study on London House Price Data.”</span> <em>Procedia Environmental Sciences</em> 7: 92–97.
</div>
<div id="ref-maas2005sufficient" class="csl-entry" role="listitem">
Maas, Cora J. M., and Joop J. Hox. 2005. <span>“Sufficient <span>Sample Sizes</span> for <span>Multilevel Modeling</span>.”</span> <em>Methodology</em> 1 (3): 86–92. <a href="https://doi.org/10.1027/1614-2241.1.3.86">https://doi.org/10.1027/1614-2241.1.3.86</a>.
</div>
<div id="ref-rabe2008multilevel" class="csl-entry" role="listitem">
Rabe-Hesketh, Sophia, and Anders Skrondal. 2008. <em>Multilevel and Longitudinal Modeling Using <span>Stata</span></em>. STATA press.
</div>
<div id="ref-stewart2018localized" class="csl-entry" role="listitem">
Stewart Fotheringham, A, and Bumsub Park. 2018. <span>“Localized Spatiotemporal Effects in the Determinants of Property Prices: A Case Study of Seoul.”</span> <em>Applied Spatial Analysis and Policy</em> 11 (August): 581–98. <a href="https://doi.org/10.1007/s12061-017-9232-8">https://doi.org/10.1007/s12061-017-9232-8</a>.
</div>
<div id="ref-wang2020geographically" class="csl-entry" role="listitem">
Wang, Chih-Hao, and Na Chen. 2020. <span>“A Geographically Weighted Regression Approach to Investigating Local Built-Environment Effects on Home Prices in the Housing Downturn, Recovery, and Subsequent Increases.”</span> <em>Journal of Housing and the Built Environment</em> 35: 1283–1302.
</div>
</div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>